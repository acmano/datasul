3c3c8bef549468dc25b32e38e3f4443d
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ItemInformacoesGeraisRepository = void 0;
// @ts-nocheck
// src/api/lor0138/item/dadosCadastrais/informacoesGerais/repository/informacoesGerais.repository.ts
function stryNS_9fa48() {
    var g = typeof globalThis === 'object' && globalThis && globalThis.Math === Math && globalThis || new Function("return this")();
    var ns = g.__stryker__ || (g.__stryker__ = {});
    if (ns.activeMutant === undefined && g.process && g.process.env && g.process.env.__STRYKER_ACTIVE_MUTANT__) {
        ns.activeMutant = g.process.env.__STRYKER_ACTIVE_MUTANT__;
    }
    function retrieveNS() {
        return ns;
    }
    stryNS_9fa48 = retrieveNS;
    return retrieveNS();
}
stryNS_9fa48();
function stryCov_9fa48() {
    var ns = stryNS_9fa48();
    var cov = ns.mutantCoverage || (ns.mutantCoverage = {
        static: {},
        perTest: {}
    });
    function cover() {
        var c = cov.static;
        if (ns.currentTestId) {
            c = cov.perTest[ns.currentTestId] = cov.perTest[ns.currentTestId] || {};
        }
        var a = arguments;
        for (var i = 0; i < a.length; i++) {
            c[a[i]] = (c[a[i]] || 0) + 1;
        }
    }
    stryCov_9fa48 = cover;
    cover.apply(null, arguments);
}
function stryMutAct_9fa48(id) {
    var ns = stryNS_9fa48();
    function isActive(id) {
        if (ns.activeMutant === id) {
            if (ns.hitCount !== void 0 && ++ns.hitCount > ns.hitLimit) {
                throw new Error('Stryker: Hit count limit reached (' + ns.hitCount + ')');
            }
            return true;
        }
        return false;
    }
    stryMutAct_9fa48 = isActive;
    return isActive(id);
}
const DatabaseManager_1 = require("@infrastructure/database/DatabaseManager");
const QueryCacheService_1 = require("@shared/utils/cache/QueryCacheService");
/**
 * Repository para consultas de Informações Gerais do Item
 */
class ItemInformacoesGeraisRepository {
    /**
     * Busca dados mestres do item (COM CACHE - TTL: 10 minutos)
     */
    static async getItemMaster(itemCodigo) {
        if (stryMutAct_9fa48("143")) {
            { }
        }
        else {
            stryCov_9fa48("143");
            try {
                if (stryMutAct_9fa48("144")) {
                    { }
                }
                else {
                    stryCov_9fa48("144");
                    const query = stryMutAct_9fa48("145") ? `` : (stryCov_9fa48("145"), `
        DECLARE @itemCodigo varchar(16) = @paramItemCodigo;
        DECLARE @sql nvarchar(max);
        
        SET @sql = N'
          SELECT 
            item."it-codigo" as itemCodigo,
            item."desc-item" as itemDescricao,
            item."un" as itemUnidade
          FROM OPENQUERY(PRD_EMS2EMP, ''
            SELECT 
              item."it-codigo",
              item."desc-item", 
              item."un"
            FROM pub.item
            WHERE item."it-codigo" = ''''' + @itemCodigo + '''''
          '') as item
        ';
        
        EXEC sp_executesql @sql;
      `);
                    const params = stryMutAct_9fa48("146") ? [] : (stryCov_9fa48("146"), [stryMutAct_9fa48("147") ? {} : (stryCov_9fa48("147"), {
                            name: stryMutAct_9fa48("148") ? "" : (stryCov_9fa48("148"), 'paramItemCodigo'),
                            type: stryMutAct_9fa48("149") ? "" : (stryCov_9fa48("149"), 'varchar'),
                            value: itemCodigo
                        })]);
                    // ✅ Query com cache L1/L2 (TTL: 10 minutos)
                    const result = await QueryCacheService_1.QueryCacheService.withItemCache(query, params, stryMutAct_9fa48("150") ? () => undefined : (stryCov_9fa48("150"), async () => DatabaseManager_1.DatabaseManager.queryEmpWithParams(query, params)));
                    return (stryMutAct_9fa48("153") ? result || result.length > 0 : stryMutAct_9fa48("152") ? false : stryMutAct_9fa48("151") ? true : (stryCov_9fa48("151", "152", "153"), result && (stryMutAct_9fa48("156") ? result.length <= 0 : stryMutAct_9fa48("155") ? result.length >= 0 : stryMutAct_9fa48("154") ? true : (stryCov_9fa48("154", "155", "156"), result.length > 0)))) ? result[0] : null;
                }
            }
            catch (error) {
                if (stryMutAct_9fa48("157")) {
                    { }
                }
                else {
                    stryCov_9fa48("157");
                    console.error(stryMutAct_9fa48("158") ? "" : (stryCov_9fa48("158"), 'Erro ao buscar item master:'), error);
                    throw error;
                }
            }
        }
    }
    /**
     * Busca estabelecimentos do item (COM CACHE - TTL: 15 minutos)
     */
    static async getItemEstabelecimentos(itemCodigo) {
        if (stryMutAct_9fa48("159")) {
            { }
        }
        else {
            stryCov_9fa48("159");
            try {
                if (stryMutAct_9fa48("160")) {
                    { }
                }
                else {
                    stryCov_9fa48("160");
                    const query = stryMutAct_9fa48("161") ? `` : (stryCov_9fa48("161"), `
        DECLARE @itemCodigo varchar(16) = @paramItemCodigo;
        DECLARE @sql nvarchar(max);
        
        SET @sql = N'
          SELECT 
            itemEstab."it-codigo" as itemCodigo,
            itemEstab."cod-estabel" as estabCodigo,
            estab."nome" as estabNome,
            itemEstab."cod-obsoleto" as codObsoleto
          FROM OPENQUERY(PRD_EMS2EMP, ''
            SELECT 
              "item-uni-estab"."it-codigo",
              "item-uni-estab"."cod-estabel",
              "item-uni-estab"."cod-obsoleto"
            FROM pub."item-uni-estab"
            WHERE "item-uni-estab"."it-codigo" = ''''' + @itemCodigo + '''''
          '') as itemEstab
          LEFT JOIN OPENQUERY(PRD_EMS2MULT, ''
            SELECT 
              estabelec."ep-codigo" as cod_estabel,
              estabelec."nome"
            FROM pub.estabelec
          '') as estab ON itemEstab."cod-estabel" = estab.cod_estabel
        ';
        
        EXEC sp_executesql @sql;
      `);
                    const params = stryMutAct_9fa48("162") ? [] : (stryCov_9fa48("162"), [stryMutAct_9fa48("163") ? {} : (stryCov_9fa48("163"), {
                            name: stryMutAct_9fa48("164") ? "" : (stryCov_9fa48("164"), 'paramItemCodigo'),
                            type: stryMutAct_9fa48("165") ? "" : (stryCov_9fa48("165"), 'varchar'),
                            value: itemCodigo
                        })]);
                    // ✅ Query com cache L1/L2 (TTL: 15 minutos)
                    const result = await QueryCacheService_1.QueryCacheService.withEstabelecimentoCache(query, params, stryMutAct_9fa48("166") ? () => undefined : (stryCov_9fa48("166"), async () => DatabaseManager_1.DatabaseManager.queryEmpWithParams(query, params)));
                    return stryMutAct_9fa48("169") ? result && [] : stryMutAct_9fa48("168") ? false : stryMutAct_9fa48("167") ? true : (stryCov_9fa48("167", "168", "169"), result || (stryMutAct_9fa48("170") ? ["Stryker was here"] : (stryCov_9fa48("170"), [])));
                }
            }
            catch (error) {
                if (stryMutAct_9fa48("171")) {
                    { }
                }
                else {
                    stryCov_9fa48("171");
                    console.error(stryMutAct_9fa48("172") ? "" : (stryCov_9fa48("172"), 'Erro ao buscar estabelecimentos:'), error);
                    throw error;
                }
            }
        }
    }
    /**
     * Invalida cache do item (chamar após UPDATE/DELETE)
     */
    static async invalidateCache(itemCodigo) {
        if (stryMutAct_9fa48("173")) {
            { }
        }
        else {
            stryCov_9fa48("173");
            await QueryCacheService_1.QueryCacheService.invalidateMultiple(stryMutAct_9fa48("174") ? [] : (stryCov_9fa48("174"), [stryMutAct_9fa48("175") ? "" : (stryCov_9fa48("175"), 'item:*'), stryMutAct_9fa48("176") ? "" : (stryCov_9fa48("176"), 'estabelecimento:*')]));
            console.log(stryMutAct_9fa48("177") ? "" : (stryCov_9fa48("177"), 'Cache invalidado para item:'), itemCodigo);
        }
    }
}
exports.ItemInformacoesGeraisRepository = ItemInformacoesGeraisRepository;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWFuby9wcm9qZXRvcy9kYXRhc3VsL2xvcjAxMzgvLnN0cnlrZXItdG1wL3NhbmRib3gtRUZGMmJSL3NyYy9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy9yZXBvc2l0b3J5L2luZm9ybWFjb2VzR2VyYWlzLnJlcG9zaXRvcnkudHMiLCJtYXBwaW5ncyI6Ijs7O0FBQUEsY0FBYztBQUNkLG9HQUFvRztBQUNwRyxTQUFTLFlBQVk7SUFDbkIsSUFBSSxDQUFDLEdBQUcsT0FBTyxVQUFVLEtBQUssUUFBUSxJQUFJLFVBQVUsSUFBSSxVQUFVLENBQUMsSUFBSSxLQUFLLElBQUksSUFBSSxVQUFVLElBQUksSUFBSSxRQUFRLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQztJQUNoSSxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsV0FBVyxJQUFJLENBQUMsQ0FBQyxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUMvQyxJQUFJLEVBQUUsQ0FBQyxZQUFZLEtBQUssU0FBUyxJQUFJLENBQUMsQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMseUJBQXlCLEVBQUUsQ0FBQztRQUMzRyxFQUFFLENBQUMsWUFBWSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixDQUFDO0lBQzVELENBQUM7SUFDRCxTQUFTLFVBQVU7UUFDakIsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDO0lBQ0QsWUFBWSxHQUFHLFVBQVUsQ0FBQztJQUMxQixPQUFPLFVBQVUsRUFBRSxDQUFDO0FBQ3RCLENBQUM7QUFDRCxZQUFZLEVBQUUsQ0FBQztBQUNmLFNBQVMsYUFBYTtJQUNwQixJQUFJLEVBQUUsR0FBRyxZQUFZLEVBQUUsQ0FBQztJQUN4QixJQUFJLEdBQUcsR0FBRyxFQUFFLENBQUMsY0FBYyxJQUFJLENBQUMsRUFBRSxDQUFDLGNBQWMsR0FBRztRQUNsRCxNQUFNLEVBQUUsRUFBRTtRQUNWLE9BQU8sRUFBRSxFQUFFO0tBQ1osQ0FBQyxDQUFDO0lBQ0gsU0FBUyxLQUFLO1FBQ1osSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQztRQUNuQixJQUFJLEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQztZQUNyQixDQUFDLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQzFFLENBQUM7UUFDRCxJQUFJLENBQUMsR0FBRyxTQUFTLENBQUM7UUFDbEIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUNsQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQy9CLENBQUM7SUFDSCxDQUFDO0lBQ0QsYUFBYSxHQUFHLEtBQUssQ0FBQztJQUN0QixLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztBQUMvQixDQUFDO0FBQ0QsU0FBUyxnQkFBZ0IsQ0FBQyxFQUFFO0lBQzFCLElBQUksRUFBRSxHQUFHLFlBQVksRUFBRSxDQUFDO0lBQ3hCLFNBQVMsUUFBUSxDQUFDLEVBQUU7UUFDbEIsSUFBSSxFQUFFLENBQUMsWUFBWSxLQUFLLEVBQUUsRUFBRSxDQUFDO1lBQzNCLElBQUksRUFBRSxDQUFDLFFBQVEsS0FBSyxLQUFLLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDO2dCQUMxRCxNQUFNLElBQUksS0FBSyxDQUFDLG9DQUFvQyxHQUFHLEVBQUUsQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLENBQUM7WUFDNUUsQ0FBQztZQUNELE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUNELGdCQUFnQixHQUFHLFFBQVEsQ0FBQztJQUM1QixPQUFPLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUN0QixDQUFDO0FBQ0QsOEVBQTJFO0FBRTNFLDZFQUEwRTtBQUUxRTs7R0FFRztBQUNILE1BQWEsK0JBQStCO0lBQzFDOztPQUVHO0lBQ0gsTUFBTSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsVUFBa0I7UUFDM0MsSUFBSSxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQzVCLENBQUMsQ0FBQSxDQUFDO1FBQ0osQ0FBQzthQUFNLENBQUM7WUFDTixhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDckIsSUFBSSxDQUFDO2dCQUNILElBQUksZ0JBQWdCLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztvQkFDNUIsQ0FBQyxDQUFBLENBQUM7Z0JBQ0osQ0FBQztxQkFBTSxDQUFDO29CQUNOLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztvQkFDckIsTUFBTSxLQUFLLEdBQUcsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O09Bb0J2RSxDQUFDLENBQUM7b0JBQ0MsTUFBTSxNQUFNLEdBQXFCLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLEVBQUU7NEJBQzVJLElBQUksRUFBRSxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRSxpQkFBaUIsQ0FBQzs0QkFDOUUsSUFBSSxFQUFFLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxFQUFFLFNBQVMsQ0FBQzs0QkFDdEUsS0FBSyxFQUFFLFVBQVU7eUJBQ2xCLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBRUwsNENBQTRDO29CQUM1QyxNQUFNLE1BQU0sR0FBRyxNQUFNLHFDQUFpQixDQUFDLGFBQWEsQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxFQUFFLEtBQUssSUFBSSxFQUFFLENBQUMsaUNBQWUsQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUN2TSxPQUFPLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sSUFBSSxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsRUFBRSxNQUFNLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsRUFBRSxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztnQkFDbFksQ0FBQztZQUNILENBQUM7WUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO2dCQUNmLElBQUksZ0JBQWdCLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztvQkFDNUIsQ0FBQyxDQUFBLENBQUM7Z0JBQ0osQ0FBQztxQkFBTSxDQUFDO29CQUNOLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztvQkFDckIsT0FBTyxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRSw2QkFBNkIsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO29CQUMzRyxNQUFNLEtBQUssQ0FBQztnQkFDZCxDQUFDO1lBQ0gsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSCxNQUFNLENBQUMsS0FBSyxDQUFDLHVCQUF1QixDQUFDLFVBQWtCO1FBQ3JELElBQUksZ0JBQWdCLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUM1QixDQUFDLENBQUEsQ0FBQztRQUNKLENBQUM7YUFBTSxDQUFDO1lBQ04sYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3JCLElBQUksQ0FBQztnQkFDSCxJQUFJLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7b0JBQzVCLENBQUMsQ0FBQSxDQUFDO2dCQUNKLENBQUM7cUJBQU0sQ0FBQztvQkFDTixhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7b0JBQ3JCLE1BQU0sS0FBSyxHQUFHLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxFQUFFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7T0EyQnZFLENBQUMsQ0FBQztvQkFDQyxNQUFNLE1BQU0sR0FBcUIsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRTs0QkFDNUksSUFBSSxFQUFFLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxFQUFFLGlCQUFpQixDQUFDOzRCQUM5RSxJQUFJLEVBQUUsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLEVBQUUsU0FBUyxDQUFDOzRCQUN0RSxLQUFLLEVBQUUsVUFBVTt5QkFDbEIsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFFTCw0Q0FBNEM7b0JBQzVDLE1BQU0sTUFBTSxHQUFHLE1BQU0scUNBQWlCLENBQUMsd0JBQXdCLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRSxLQUFLLElBQUksRUFBRSxDQUFDLGlDQUFlLENBQUMsa0JBQWtCLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDbE4sT0FBTyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsRUFBRSxNQUFNLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ25QLENBQUM7WUFDSCxDQUFDO1lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztnQkFDZixJQUFJLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7b0JBQzVCLENBQUMsQ0FBQSxDQUFDO2dCQUNKLENBQUM7cUJBQU0sQ0FBQztvQkFDTixhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7b0JBQ3JCLE9BQU8sQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLEVBQUUsa0NBQWtDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQztvQkFDaEgsTUFBTSxLQUFLLENBQUM7Z0JBQ2QsQ0FBQztZQUNILENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0gsTUFBTSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsVUFBa0I7UUFDN0MsSUFBSSxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQzVCLENBQUMsQ0FBQSxDQUFDO1FBQ0osQ0FBQzthQUFNLENBQUM7WUFDTixhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDckIsTUFBTSxxQ0FBaUIsQ0FBQyxrQkFBa0IsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxFQUFFLFFBQVEsQ0FBQyxFQUFFLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxFQUFFLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDalAsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRSw2QkFBNkIsQ0FBQyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBQ2hILENBQUM7SUFDSCxDQUFDO0NBQ0Y7QUFwSUQsMEVBb0lDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL21hbm8vcHJvamV0b3MvZGF0YXN1bC9sb3IwMTM4Ly5zdHJ5a2VyLXRtcC9zYW5kYm94LUVGRjJiUi9zcmMvYXBpL2xvcjAxMzgvaXRlbS9kYWRvc0NhZGFzdHJhaXMvaW5mb3JtYWNvZXNHZXJhaXMvcmVwb3NpdG9yeS9pbmZvcm1hY29lc0dlcmFpcy5yZXBvc2l0b3J5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEB0cy1ub2NoZWNrXG4vLyBzcmMvYXBpL2xvcjAxMzgvaXRlbS9kYWRvc0NhZGFzdHJhaXMvaW5mb3JtYWNvZXNHZXJhaXMvcmVwb3NpdG9yeS9pbmZvcm1hY29lc0dlcmFpcy5yZXBvc2l0b3J5LnRzXG5mdW5jdGlvbiBzdHJ5TlNfOWZhNDgoKSB7XG4gIHZhciBnID0gdHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnICYmIGdsb2JhbFRoaXMgJiYgZ2xvYmFsVGhpcy5NYXRoID09PSBNYXRoICYmIGdsb2JhbFRoaXMgfHwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKTtcbiAgdmFyIG5zID0gZy5fX3N0cnlrZXJfXyB8fCAoZy5fX3N0cnlrZXJfXyA9IHt9KTtcbiAgaWYgKG5zLmFjdGl2ZU11dGFudCA9PT0gdW5kZWZpbmVkICYmIGcucHJvY2VzcyAmJiBnLnByb2Nlc3MuZW52ICYmIGcucHJvY2Vzcy5lbnYuX19TVFJZS0VSX0FDVElWRV9NVVRBTlRfXykge1xuICAgIG5zLmFjdGl2ZU11dGFudCA9IGcucHJvY2Vzcy5lbnYuX19TVFJZS0VSX0FDVElWRV9NVVRBTlRfXztcbiAgfVxuICBmdW5jdGlvbiByZXRyaWV2ZU5TKCkge1xuICAgIHJldHVybiBucztcbiAgfVxuICBzdHJ5TlNfOWZhNDggPSByZXRyaWV2ZU5TO1xuICByZXR1cm4gcmV0cmlldmVOUygpO1xufVxuc3RyeU5TXzlmYTQ4KCk7XG5mdW5jdGlvbiBzdHJ5Q292XzlmYTQ4KCkge1xuICB2YXIgbnMgPSBzdHJ5TlNfOWZhNDgoKTtcbiAgdmFyIGNvdiA9IG5zLm11dGFudENvdmVyYWdlIHx8IChucy5tdXRhbnRDb3ZlcmFnZSA9IHtcbiAgICBzdGF0aWM6IHt9LFxuICAgIHBlclRlc3Q6IHt9XG4gIH0pO1xuICBmdW5jdGlvbiBjb3ZlcigpIHtcbiAgICB2YXIgYyA9IGNvdi5zdGF0aWM7XG4gICAgaWYgKG5zLmN1cnJlbnRUZXN0SWQpIHtcbiAgICAgIGMgPSBjb3YucGVyVGVzdFtucy5jdXJyZW50VGVzdElkXSA9IGNvdi5wZXJUZXN0W25zLmN1cnJlbnRUZXN0SWRdIHx8IHt9O1xuICAgIH1cbiAgICB2YXIgYSA9IGFyZ3VtZW50cztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNbYVtpXV0gPSAoY1thW2ldXSB8fCAwKSArIDE7XG4gICAgfVxuICB9XG4gIHN0cnlDb3ZfOWZhNDggPSBjb3ZlcjtcbiAgY292ZXIuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIHN0cnlNdXRBY3RfOWZhNDgoaWQpIHtcbiAgdmFyIG5zID0gc3RyeU5TXzlmYTQ4KCk7XG4gIGZ1bmN0aW9uIGlzQWN0aXZlKGlkKSB7XG4gICAgaWYgKG5zLmFjdGl2ZU11dGFudCA9PT0gaWQpIHtcbiAgICAgIGlmIChucy5oaXRDb3VudCAhPT0gdm9pZCAwICYmICsrbnMuaGl0Q291bnQgPiBucy5oaXRMaW1pdCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N0cnlrZXI6IEhpdCBjb3VudCBsaW1pdCByZWFjaGVkICgnICsgbnMuaGl0Q291bnQgKyAnKScpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBzdHJ5TXV0QWN0XzlmYTQ4ID0gaXNBY3RpdmU7XG4gIHJldHVybiBpc0FjdGl2ZShpZCk7XG59XG5pbXBvcnQgeyBEYXRhYmFzZU1hbmFnZXIgfSBmcm9tICdAaW5mcmFzdHJ1Y3R1cmUvZGF0YWJhc2UvRGF0YWJhc2VNYW5hZ2VyJztcbmltcG9ydCB7IFF1ZXJ5UGFyYW1ldGVyIH0gZnJvbSAnQGluZnJhc3RydWN0dXJlL2RhdGFiYXNlL3R5cGVzJztcbmltcG9ydCB7IFF1ZXJ5Q2FjaGVTZXJ2aWNlIH0gZnJvbSAnQHNoYXJlZC91dGlscy9jYWNoZS9RdWVyeUNhY2hlU2VydmljZSc7XG5cbi8qKlxyXG4gKiBSZXBvc2l0b3J5IHBhcmEgY29uc3VsdGFzIGRlIEluZm9ybWHDp8O1ZXMgR2VyYWlzIGRvIEl0ZW1cclxuICovXG5leHBvcnQgY2xhc3MgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeSB7XG4gIC8qKlxyXG4gICAqIEJ1c2NhIGRhZG9zIG1lc3RyZXMgZG8gaXRlbSAoQ09NIENBQ0hFIC0gVFRMOiAxMCBtaW51dG9zKVxyXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZ2V0SXRlbU1hc3RlcihpdGVtQ29kaWdvOiBzdHJpbmcpOiBQcm9taXNlPGFueSB8IG51bGw+IHtcbiAgICBpZiAoc3RyeU11dEFjdF85ZmE0OChcIjE0M1wiKSkge1xuICAgICAge31cbiAgICB9IGVsc2Uge1xuICAgICAgc3RyeUNvdl85ZmE0OChcIjE0M1wiKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMTQ0XCIpKSB7XG4gICAgICAgICAge31cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdHJ5Q292XzlmYTQ4KFwiMTQ0XCIpO1xuICAgICAgICAgIGNvbnN0IHF1ZXJ5ID0gc3RyeU11dEFjdF85ZmE0OChcIjE0NVwiKSA/IGBgIDogKHN0cnlDb3ZfOWZhNDgoXCIxNDVcIiksIGBcbiAgICAgICAgREVDTEFSRSBAaXRlbUNvZGlnbyB2YXJjaGFyKDE2KSA9IEBwYXJhbUl0ZW1Db2RpZ287XG4gICAgICAgIERFQ0xBUkUgQHNxbCBudmFyY2hhcihtYXgpO1xuICAgICAgICBcbiAgICAgICAgU0VUIEBzcWwgPSBOJ1xuICAgICAgICAgIFNFTEVDVCBcbiAgICAgICAgICAgIGl0ZW0uXCJpdC1jb2RpZ29cIiBhcyBpdGVtQ29kaWdvLFxuICAgICAgICAgICAgaXRlbS5cImRlc2MtaXRlbVwiIGFzIGl0ZW1EZXNjcmljYW8sXG4gICAgICAgICAgICBpdGVtLlwidW5cIiBhcyBpdGVtVW5pZGFkZVxuICAgICAgICAgIEZST00gT1BFTlFVRVJZKFBSRF9FTVMyRU1QLCAnJ1xuICAgICAgICAgICAgU0VMRUNUIFxuICAgICAgICAgICAgICBpdGVtLlwiaXQtY29kaWdvXCIsXG4gICAgICAgICAgICAgIGl0ZW0uXCJkZXNjLWl0ZW1cIiwgXG4gICAgICAgICAgICAgIGl0ZW0uXCJ1blwiXG4gICAgICAgICAgICBGUk9NIHB1Yi5pdGVtXG4gICAgICAgICAgICBXSEVSRSBpdGVtLlwiaXQtY29kaWdvXCIgPSAnJycnJyArIEBpdGVtQ29kaWdvICsgJycnJydcbiAgICAgICAgICAnJykgYXMgaXRlbVxuICAgICAgICAnO1xuICAgICAgICBcbiAgICAgICAgRVhFQyBzcF9leGVjdXRlc3FsIEBzcWw7XG4gICAgICBgKTtcbiAgICAgICAgICBjb25zdCBwYXJhbXM6IFF1ZXJ5UGFyYW1ldGVyW10gPSBzdHJ5TXV0QWN0XzlmYTQ4KFwiMTQ2XCIpID8gW10gOiAoc3RyeUNvdl85ZmE0OChcIjE0NlwiKSwgW3N0cnlNdXRBY3RfOWZhNDgoXCIxNDdcIikgPyB7fSA6IChzdHJ5Q292XzlmYTQ4KFwiMTQ3XCIpLCB7XG4gICAgICAgICAgICBuYW1lOiBzdHJ5TXV0QWN0XzlmYTQ4KFwiMTQ4XCIpID8gXCJcIiA6IChzdHJ5Q292XzlmYTQ4KFwiMTQ4XCIpLCAncGFyYW1JdGVtQ29kaWdvJyksXG4gICAgICAgICAgICB0eXBlOiBzdHJ5TXV0QWN0XzlmYTQ4KFwiMTQ5XCIpID8gXCJcIiA6IChzdHJ5Q292XzlmYTQ4KFwiMTQ5XCIpLCAndmFyY2hhcicpLFxuICAgICAgICAgICAgdmFsdWU6IGl0ZW1Db2RpZ29cbiAgICAgICAgICB9KV0pO1xuXG4gICAgICAgICAgLy8g4pyFIFF1ZXJ5IGNvbSBjYWNoZSBMMS9MMiAoVFRMOiAxMCBtaW51dG9zKVxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUocXVlcnksIHBhcmFtcywgc3RyeU11dEFjdF85ZmE0OChcIjE1MFwiKSA/ICgpID0+IHVuZGVmaW5lZCA6IChzdHJ5Q292XzlmYTQ4KFwiMTUwXCIpLCBhc3luYyAoKSA9PiBEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zKHF1ZXJ5LCBwYXJhbXMpKSk7XG4gICAgICAgICAgcmV0dXJuIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMTUzXCIpID8gcmVzdWx0IHx8IHJlc3VsdC5sZW5ndGggPiAwIDogc3RyeU11dEFjdF85ZmE0OChcIjE1MlwiKSA/IGZhbHNlIDogc3RyeU11dEFjdF85ZmE0OChcIjE1MVwiKSA/IHRydWUgOiAoc3RyeUNvdl85ZmE0OChcIjE1MVwiLCBcIjE1MlwiLCBcIjE1M1wiKSwgcmVzdWx0ICYmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMTU2XCIpID8gcmVzdWx0Lmxlbmd0aCA8PSAwIDogc3RyeU11dEFjdF85ZmE0OChcIjE1NVwiKSA/IHJlc3VsdC5sZW5ndGggPj0gMCA6IHN0cnlNdXRBY3RfOWZhNDgoXCIxNTRcIikgPyB0cnVlIDogKHN0cnlDb3ZfOWZhNDgoXCIxNTRcIiwgXCIxNTVcIiwgXCIxNTZcIiksIHJlc3VsdC5sZW5ndGggPiAwKSkpKSA/IHJlc3VsdFswXSA6IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGlmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMTU3XCIpKSB7XG4gICAgICAgICAge31cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdHJ5Q292XzlmYTQ4KFwiMTU3XCIpO1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3Ioc3RyeU11dEFjdF85ZmE0OChcIjE1OFwiKSA/IFwiXCIgOiAoc3RyeUNvdl85ZmE0OChcIjE1OFwiKSwgJ0Vycm8gYW8gYnVzY2FyIGl0ZW0gbWFzdGVyOicpLCBlcnJvcik7XG4gICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcclxuICAgKiBCdXNjYSBlc3RhYmVsZWNpbWVudG9zIGRvIGl0ZW0gKENPTSBDQUNIRSAtIFRUTDogMTUgbWludXRvcylcclxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGdldEl0ZW1Fc3RhYmVsZWNpbWVudG9zKGl0ZW1Db2RpZ286IHN0cmluZyk6IFByb21pc2U8YW55W10+IHtcbiAgICBpZiAoc3RyeU11dEFjdF85ZmE0OChcIjE1OVwiKSkge1xuICAgICAge31cbiAgICB9IGVsc2Uge1xuICAgICAgc3RyeUNvdl85ZmE0OChcIjE1OVwiKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMTYwXCIpKSB7XG4gICAgICAgICAge31cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdHJ5Q292XzlmYTQ4KFwiMTYwXCIpO1xuICAgICAgICAgIGNvbnN0IHF1ZXJ5ID0gc3RyeU11dEFjdF85ZmE0OChcIjE2MVwiKSA/IGBgIDogKHN0cnlDb3ZfOWZhNDgoXCIxNjFcIiksIGBcbiAgICAgICAgREVDTEFSRSBAaXRlbUNvZGlnbyB2YXJjaGFyKDE2KSA9IEBwYXJhbUl0ZW1Db2RpZ287XG4gICAgICAgIERFQ0xBUkUgQHNxbCBudmFyY2hhcihtYXgpO1xuICAgICAgICBcbiAgICAgICAgU0VUIEBzcWwgPSBOJ1xuICAgICAgICAgIFNFTEVDVCBcbiAgICAgICAgICAgIGl0ZW1Fc3RhYi5cIml0LWNvZGlnb1wiIGFzIGl0ZW1Db2RpZ28sXG4gICAgICAgICAgICBpdGVtRXN0YWIuXCJjb2QtZXN0YWJlbFwiIGFzIGVzdGFiQ29kaWdvLFxuICAgICAgICAgICAgZXN0YWIuXCJub21lXCIgYXMgZXN0YWJOb21lLFxuICAgICAgICAgICAgaXRlbUVzdGFiLlwiY29kLW9ic29sZXRvXCIgYXMgY29kT2Jzb2xldG9cbiAgICAgICAgICBGUk9NIE9QRU5RVUVSWShQUkRfRU1TMkVNUCwgJydcbiAgICAgICAgICAgIFNFTEVDVCBcbiAgICAgICAgICAgICAgXCJpdGVtLXVuaS1lc3RhYlwiLlwiaXQtY29kaWdvXCIsXG4gICAgICAgICAgICAgIFwiaXRlbS11bmktZXN0YWJcIi5cImNvZC1lc3RhYmVsXCIsXG4gICAgICAgICAgICAgIFwiaXRlbS11bmktZXN0YWJcIi5cImNvZC1vYnNvbGV0b1wiXG4gICAgICAgICAgICBGUk9NIHB1Yi5cIml0ZW0tdW5pLWVzdGFiXCJcbiAgICAgICAgICAgIFdIRVJFIFwiaXRlbS11bmktZXN0YWJcIi5cIml0LWNvZGlnb1wiID0gJycnJycgKyBAaXRlbUNvZGlnbyArICcnJycnXG4gICAgICAgICAgJycpIGFzIGl0ZW1Fc3RhYlxuICAgICAgICAgIExFRlQgSk9JTiBPUEVOUVVFUlkoUFJEX0VNUzJNVUxULCAnJ1xuICAgICAgICAgICAgU0VMRUNUIFxuICAgICAgICAgICAgICBlc3RhYmVsZWMuXCJlcC1jb2RpZ29cIiBhcyBjb2RfZXN0YWJlbCxcbiAgICAgICAgICAgICAgZXN0YWJlbGVjLlwibm9tZVwiXG4gICAgICAgICAgICBGUk9NIHB1Yi5lc3RhYmVsZWNcbiAgICAgICAgICAnJykgYXMgZXN0YWIgT04gaXRlbUVzdGFiLlwiY29kLWVzdGFiZWxcIiA9IGVzdGFiLmNvZF9lc3RhYmVsXG4gICAgICAgICc7XG4gICAgICAgIFxuICAgICAgICBFWEVDIHNwX2V4ZWN1dGVzcWwgQHNxbDtcbiAgICAgIGApO1xuICAgICAgICAgIGNvbnN0IHBhcmFtczogUXVlcnlQYXJhbWV0ZXJbXSA9IHN0cnlNdXRBY3RfOWZhNDgoXCIxNjJcIikgPyBbXSA6IChzdHJ5Q292XzlmYTQ4KFwiMTYyXCIpLCBbc3RyeU11dEFjdF85ZmE0OChcIjE2M1wiKSA/IHt9IDogKHN0cnlDb3ZfOWZhNDgoXCIxNjNcIiksIHtcbiAgICAgICAgICAgIG5hbWU6IHN0cnlNdXRBY3RfOWZhNDgoXCIxNjRcIikgPyBcIlwiIDogKHN0cnlDb3ZfOWZhNDgoXCIxNjRcIiksICdwYXJhbUl0ZW1Db2RpZ28nKSxcbiAgICAgICAgICAgIHR5cGU6IHN0cnlNdXRBY3RfOWZhNDgoXCIxNjVcIikgPyBcIlwiIDogKHN0cnlDb3ZfOWZhNDgoXCIxNjVcIiksICd2YXJjaGFyJyksXG4gICAgICAgICAgICB2YWx1ZTogaXRlbUNvZGlnb1xuICAgICAgICAgIH0pXSk7XG5cbiAgICAgICAgICAvLyDinIUgUXVlcnkgY29tIGNhY2hlIEwxL0wyIChUVEw6IDE1IG1pbnV0b3MpXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEVzdGFiZWxlY2ltZW50b0NhY2hlKHF1ZXJ5LCBwYXJhbXMsIHN0cnlNdXRBY3RfOWZhNDgoXCIxNjZcIikgPyAoKSA9PiB1bmRlZmluZWQgOiAoc3RyeUNvdl85ZmE0OChcIjE2NlwiKSwgYXN5bmMgKCkgPT4gRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyhxdWVyeSwgcGFyYW1zKSkpO1xuICAgICAgICAgIHJldHVybiBzdHJ5TXV0QWN0XzlmYTQ4KFwiMTY5XCIpID8gcmVzdWx0ICYmIFtdIDogc3RyeU11dEFjdF85ZmE0OChcIjE2OFwiKSA/IGZhbHNlIDogc3RyeU11dEFjdF85ZmE0OChcIjE2N1wiKSA/IHRydWUgOiAoc3RyeUNvdl85ZmE0OChcIjE2N1wiLCBcIjE2OFwiLCBcIjE2OVwiKSwgcmVzdWx0IHx8IChzdHJ5TXV0QWN0XzlmYTQ4KFwiMTcwXCIpID8gW1wiU3RyeWtlciB3YXMgaGVyZVwiXSA6IChzdHJ5Q292XzlmYTQ4KFwiMTcwXCIpLCBbXSkpKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgaWYgKHN0cnlNdXRBY3RfOWZhNDgoXCIxNzFcIikpIHtcbiAgICAgICAgICB7fVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHN0cnlDb3ZfOWZhNDgoXCIxNzFcIik7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihzdHJ5TXV0QWN0XzlmYTQ4KFwiMTcyXCIpID8gXCJcIiA6IChzdHJ5Q292XzlmYTQ4KFwiMTcyXCIpLCAnRXJybyBhbyBidXNjYXIgZXN0YWJlbGVjaW1lbnRvczonKSwgZXJyb3IpO1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXHJcbiAgICogSW52YWxpZGEgY2FjaGUgZG8gaXRlbSAoY2hhbWFyIGFww7NzIFVQREFURS9ERUxFVEUpXHJcbiAgICovXG4gIHN0YXRpYyBhc3luYyBpbnZhbGlkYXRlQ2FjaGUoaXRlbUNvZGlnbzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHN0cnlNdXRBY3RfOWZhNDgoXCIxNzNcIikpIHtcbiAgICAgIHt9XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0cnlDb3ZfOWZhNDgoXCIxNzNcIik7XG4gICAgICBhd2FpdCBRdWVyeUNhY2hlU2VydmljZS5pbnZhbGlkYXRlTXVsdGlwbGUoc3RyeU11dEFjdF85ZmE0OChcIjE3NFwiKSA/IFtdIDogKHN0cnlDb3ZfOWZhNDgoXCIxNzRcIiksIFtzdHJ5TXV0QWN0XzlmYTQ4KFwiMTc1XCIpID8gXCJcIiA6IChzdHJ5Q292XzlmYTQ4KFwiMTc1XCIpLCAnaXRlbToqJyksIHN0cnlNdXRBY3RfOWZhNDgoXCIxNzZcIikgPyBcIlwiIDogKHN0cnlDb3ZfOWZhNDgoXCIxNzZcIiksICdlc3RhYmVsZWNpbWVudG86KicpXSkpO1xuICAgICAgY29uc29sZS5sb2coc3RyeU11dEFjdF85ZmE0OChcIjE3N1wiKSA/IFwiXCIgOiAoc3RyeUNvdl85ZmE0OChcIjE3N1wiKSwgJ0NhY2hlIGludmFsaWRhZG8gcGFyYSBpdGVtOicpLCBpdGVtQ29kaWdvKTtcbiAgICB9XG4gIH1cbn0iXSwidmVyc2lvbiI6M30=