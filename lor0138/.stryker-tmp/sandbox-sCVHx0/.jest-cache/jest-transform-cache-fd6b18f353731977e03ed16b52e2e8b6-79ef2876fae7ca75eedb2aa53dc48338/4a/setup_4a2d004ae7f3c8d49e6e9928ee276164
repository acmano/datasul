4124aa75e4b808119ca3e5db033c5dc9
"use strict";
// @ts-nocheck
// tests/setup.ts
// Setup global para todos os testes
Object.defineProperty(exports, "__esModule", { value: true });
// ========================================
// 2. MOCK DO LOGGER (evita poluir console)
// ========================================
jest.mock('@shared/utils/logger', () => ({
    log: {
        info: jest.fn(),
        error: jest.fn(),
        warn: jest.fn(),
        debug: jest.fn(),
        http: jest.fn(),
    },
}));
// ========================================
// 2.1 MOCK DO UUID (resolve problema ESM)
// ========================================
jest.mock('uuid', () => ({
    v4: jest.fn(() => 'test-uuid-1234-5678-9012'),
}));
// ========================================
// 1. VARIÁVEIS DE AMBIENTE PARA TESTES
// ========================================
process.env.NODE_ENV = 'test';
process.env.PORT = '3001'; // Porta diferente para não conflitar
// Database (Mock será usado automaticamente)
process.env.DB_CONNECTION_TYPE = 'sqlserver';
process.env.DB_SERVER = 'test-server';
process.env.DB_PORT = '1433';
process.env.DB_USER = 'test-user';
process.env.DB_PASSWORD = 'test-password';
process.env.DB_DATABASE_EMP = '';
process.env.DB_DATABASE_MULT = '';
process.env.DB_CONNECTION_TIMEOUT = '5000';
process.env.DB_REQUEST_TIMEOUT = '5000';
process.env.DB_ENCRYPT = 'false';
process.env.DB_TRUST_SERVER_CERTIFICATE = 'true';
// Cache (desabilitado para testes por padrão)
process.env.CACHE_ENABLED = 'false';
process.env.CACHE_STRATEGY = 'memory';
// CORS
process.env.CORS_ALLOWED_ORIGINS = 'http://localhost:3001';
// Timeouts
process.env.HTTP_REQUEST_TIMEOUT = '5000';
process.env.HTTP_HEALTH_TIMEOUT = '2000';
// Shutdown
process.env.SHUTDOWN_TIMEOUT = '1000';
// ========================================
// 3. MOCKS GLOBAIS DE CONSOLE (opcional)
// ========================================
// Silencia console.log/error durante testes (descomente se quiser)
// global.console.log = jest.fn();
// global.console.error = jest.fn();
// global.console.warn = jest.fn();
// ========================================
// 4. TIMEOUT GLOBAL (aumenta se testes forem lentos)
// ========================================
jest.setTimeout(10000); // 10 segundos
// ========================================
// 5. EXTEND EXPECT (matchers customizados)
// ========================================
expect.extend({
    // Matcher customizado para validar erro customizado
    toBeCustomError(received, expectedClass) {
        const pass = received instanceof expectedClass;
        if (pass) {
            return {
                message: () => `Expected error NOT to be instance of ${expectedClass.name}`,
                pass: true,
            };
        }
        else {
            return {
                message: () => `Expected error to be instance of ${expectedClass.name}, but got ${received?.constructor?.name}`,
                pass: false,
            };
        }
    },
    // Matcher para validar estrutura de API response
    toBeApiResponse(received) {
        const hasSuccess = 'success' in received;
        const hasData = 'data' in received || 'error' in received;
        const pass = hasSuccess && hasData;
        if (pass) {
            return {
                message: () => 'Expected NOT to be a valid API response',
                pass: true,
            };
        }
        else {
            return {
                message: () => `Expected to be a valid API response with 'success' and 'data'/'error' fields`,
                pass: false,
            };
        }
    },
});
// ========================================
// 7. CLEANUP APÓS CADA TESTE
// ========================================
afterEach(() => {
    jest.clearAllMocks(); // Limpa histórico de calls de mocks
});
// ========================================
// 8. CLEANUP APÓS TODOS OS TESTES
// ========================================
afterAll(async () => {
    // Aguarda promises pendentes
    await new Promise((resolve) => setTimeout(resolve, 500));
    // Fecha conexões abertas (se houver)
    // await DatabaseManager.close();
    // await CacheManager.close();
});
// ========================================
// 9. ERRO DE PROMISES NÃO TRATADAS
// ========================================
process.on('unhandledRejection', (reason, promise) => {
    console.error('Unhandled Rejection during test:', reason);
    throw reason;
});
console.log('🧪 Ambiente de testes configurado');
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWFuby9wcm9qZXRvcy9kYXRhc3VsL2xvcjAxMzgvLnN0cnlrZXItdG1wL3NhbmRib3gtc0NWSHgwL3Rlc3RzL3NldHVwLnRzIiwibWFwcGluZ3MiOiI7QUFBQSxjQUFjO0FBQ2QsaUJBQWlCO0FBQ2pCLG9DQUFvQzs7QUFtQ3BDLDJDQUEyQztBQUMzQywyQ0FBMkM7QUFDM0MsMkNBQTJDO0FBQzNDLElBQUksQ0FBQyxJQUFJLENBQUMsc0JBQXNCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN2QyxHQUFHLEVBQUU7UUFDSCxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2hCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDaEIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDaEI7Q0FDRixDQUFDLENBQUMsQ0FBQztBQUVKLDJDQUEyQztBQUMzQywwQ0FBMEM7QUFDMUMsMkNBQTJDO0FBQzNDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDdkIsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsMEJBQTBCLENBQUM7Q0FDOUMsQ0FBQyxDQUFDLENBQUM7QUFuREosMkNBQTJDO0FBQzNDLHVDQUF1QztBQUN2QywyQ0FBMkM7QUFDM0MsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDO0FBQzlCLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxHQUFHLE1BQU0sQ0FBQyxDQUFDLHFDQUFxQztBQUVoRSw2Q0FBNkM7QUFDN0MsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsR0FBRyxXQUFXLENBQUM7QUFDN0MsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEdBQUcsYUFBYSxDQUFDO0FBQ3RDLE9BQU8sQ0FBQyxH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QTZCO0FBQzdCLDJDQUEyQztBQUMzQyxTQUFTLENBQUMsR0FBRyxFQUFFO0lBQ2IsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsb0NBQW9DO0FBQzVELENBQUMsQ0FBQyxDQUFDO0FBRUgsMkNBQTJDO0FBQzNDLGtDQUFrQztBQUNsQywyQ0FBMkM7QUFDM0MsUUFBUSxDQUFDLEtBQUssSUFBSSxFQUFFO0lBQ2xCLDZCQUE2QjtJQUM3QixNQUFNLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxVQUFVLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFFekQscUNBQXFDO0lBQ3JDLGlDQUFpQztJQUNqQyw4QkFBOEI7QUFDaEMsQ0FBQyxDQUFDLENBQUM7QUFFSCwyQ0FBMkM7QUFDM0MsbUNBQW1DO0FBQ25DLDJDQUEyQztBQUMzQyxPQUFPLENBQUMsRUFBRSxDQUFDLG9CQUFvQixFQUFFLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxFQUFFO0lBQ25ELE9BQU8sQ0FBQyxLQUFLLENBQUMsa0NBQWtDLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDMUQsTUFBTSxNQUFNLENBQUM7QUFDZixDQUFDLENBQUMsQ0FBQztBQUVILE9BQU8sQ0FBQyxHQUFHLENBQUMsbUNBQW1DLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9tYW5vL3Byb2pldG9zL2RhdGFzdWwvbG9yMDEzOC8uc3RyeWtlci10bXAvc2FuZGJveC1zQ1ZIeDAvdGVzdHMvc2V0dXAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQHRzLW5vY2hlY2tcbi8vIHRlc3RzL3NldHVwLnRzXG4vLyBTZXR1cCBnbG9iYWwgcGFyYSB0b2RvcyBvcyB0ZXN0ZXNcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gMS4gVkFSScOBVkVJUyBERSBBTUJJRU5URSBQQVJBIFRFU1RFU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxucHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAndGVzdCc7XG5wcm9jZXNzLmVudi5QT1JUID0gJzMwMDEnOyAvLyBQb3J0YSBkaWZlcmVudGUgcGFyYSBuw6NvIGNvbmZsaXRhclxuXG4vLyBEYXRhYmFzZSAoTW9jayBzZXLDoSB1c2FkbyBhdXRvbWF0aWNhbWVudGUpXG5wcm9jZXNzLmVudi5EQl9DT05ORUNUSU9OX1RZUEUgPSAnc3Fsc2VydmVyJztcbnByb2Nlc3MuZW52LkRCX1NFUlZFUiA9ICd0ZXN0LXNlcnZlcic7XG5wcm9jZXNzLmVudi5EQl9QT1JUID0gJzE0MzMnO1xucHJvY2Vzcy5lbnYuREJfVVNFUiA9ICd0ZXN0LXVzZXInO1xucHJvY2Vzcy5lbnYuREJfUEFTU1dPUkQgPSAndGVzdC1wYXNzd29yZCc7XG5wcm9jZXNzLmVudi5EQl9EQVRBQkFTRV9FTVAgPSAnJztcbnByb2Nlc3MuZW52LkRCX0RBVEFCQVNFX01VTFQgPSAnJztcbnByb2Nlc3MuZW52LkRCX0NPTk5FQ1RJT05fVElNRU9VVCA9ICc1MDAwJztcbnByb2Nlc3MuZW52LkRCX1JFUVVFU1RfVElNRU9VVCA9ICc1MDAwJztcbnByb2Nlc3MuZW52LkRCX0VOQ1JZUFQgPSAnZmFsc2UnO1xucHJvY2Vzcy5lbnYuREJfVFJVU1RfU0VSVkVSX0NFUlRJRklDQVRFID0gJ3RydWUnO1xuXG4vLyBDYWNoZSAoZGVzYWJpbGl0YWRvIHBhcmEgdGVzdGVzIHBvciBwYWRyw6NvKVxucHJvY2Vzcy5lbnYuQ0FDSEVfRU5BQkxFRCA9ICdmYWxzZSc7XG5wcm9jZXNzLmVudi5DQUNIRV9TVFJBVEVHWSA9ICdtZW1vcnknO1xuXG4vLyBDT1JTXG5wcm9jZXNzLmVudi5DT1JTX0FMTE9XRURfT1JJR0lOUyA9ICdodHRwOi8vbG9jYWxob3N0OjMwMDEnO1xuXG4vLyBUaW1lb3V0c1xucHJvY2Vzcy5lbnYuSFRUUF9SRVFVRVNUX1RJTUVPVVQgPSAnNTAwMCc7XG5wcm9jZXNzLmVudi5IVFRQX0hFQUxUSF9USU1FT1VUID0gJzIwMDAnO1xuXG4vLyBTaHV0ZG93blxucHJvY2Vzcy5lbnYuU0hVVERPV05fVElNRU9VVCA9ICcxMDAwJztcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gMi4gTU9DSyBETyBMT0dHRVIgKGV2aXRhIHBvbHVpciBjb25zb2xlKVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuamVzdC5tb2NrKCdAc2hhcmVkL3V0aWxzL2xvZ2dlcicsICgpID0+ICh7XG4gIGxvZzoge1xuICAgIGluZm86IGplc3QuZm4oKSxcbiAgICBlcnJvcjogamVzdC5mbigpLFxuICAgIHdhcm46IGplc3QuZm4oKSxcbiAgICBkZWJ1ZzogamVzdC5mbigpLFxuICAgIGh0dHA6IGplc3QuZm4oKSxcbiAgfSxcbn0pKTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gMi4xIE1PQ0sgRE8gVVVJRCAocmVzb2x2ZSBwcm9ibGVtYSBFU00pXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5qZXN0Lm1vY2soJ3V1aWQnLCAoKSA9PiAoe1xuICB2NDogamVzdC5mbigoKSA9PiAndGVzdC11dWlkLTEyMzQtNTY3OC05MDEyJyksXG59KSk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIDMuIE1PQ0tTIEdMT0JBSVMgREUgQ09OU09MRSAob3BjaW9uYWwpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTaWxlbmNpYSBjb25zb2xlLmxvZy9lcnJvciBkdXJhbnRlIHRlc3RlcyAoZGVzY29tZW50ZSBzZSBxdWlzZXIpXG4vLyBnbG9iYWwuY29uc29sZS5sb2cgPSBqZXN0LmZuKCk7XG4vLyBnbG9iYWwuY29uc29sZS5lcnJvciA9IGplc3QuZm4oKTtcbi8vIGdsb2JhbC5jb25zb2xlLndhcm4gPSBqZXN0LmZuKCk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIDQuIFRJTUVPVVQgR0xPQkFMIChhdW1lbnRhIHNlIHRlc3RlcyBmb3JlbSBsZW50b3MpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5qZXN0LnNldFRpbWVvdXQoMTAwMDApOyAvLyAxMCBzZWd1bmRvc1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyA1LiBFWFRFTkQgRVhQRUNUIChtYXRjaGVycyBjdXN0b21pemFkb3MpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBlY3QuZXh0ZW5kKHtcbiAgLy8gTWF0Y2hlciBjdXN0b21pemFkbyBwYXJhIHZhbGlkYXIgZXJybyBjdXN0b21pemFkb1xuICB0b0JlQ3VzdG9tRXJyb3IocmVjZWl2ZWQ6IGFueSwgZXhwZWN0ZWRDbGFzczogYW55KSB7XG4gICAgY29uc3QgcGFzcyA9IHJlY2VpdmVkIGluc3RhbmNlb2YgZXhwZWN0ZWRDbGFzcztcbiAgICBcbiAgICBpZiAocGFzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZTogKCkgPT4gYEV4cGVjdGVkIGVycm9yIE5PVCB0byBiZSBpbnN0YW5jZSBvZiAke2V4cGVjdGVkQ2xhc3MubmFtZX1gLFxuICAgICAgICBwYXNzOiB0cnVlLFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZTogKCkgPT4gYEV4cGVjdGVkIGVycm9yIHRvIGJlIGluc3RhbmNlIG9mICR7ZXhwZWN0ZWRDbGFzcy5uYW1lfSwgYnV0IGdvdCAke3JlY2VpdmVkPy5jb25zdHJ1Y3Rvcj8ubmFtZX1gLFxuICAgICAgICBwYXNzOiBmYWxzZSxcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIC8vIE1hdGNoZXIgcGFyYSB2YWxpZGFyIGVzdHJ1dHVyYSBkZSBBUEkgcmVzcG9uc2VcbiAgdG9CZUFwaVJlc3BvbnNlKHJlY2VpdmVkOiBhbnkpIHtcbiAgICBjb25zdCBoYXNTdWNjZXNzID0gJ3N1Y2Nlc3MnIGluIHJlY2VpdmVkO1xuICAgIGNvbnN0IGhhc0RhdGEgPSAnZGF0YScgaW4gcmVjZWl2ZWQgfHwgJ2Vycm9yJyBpbiByZWNlaXZlZDtcbiAgICBjb25zdCBwYXNzID0gaGFzU3VjY2VzcyAmJiBoYXNEYXRhO1xuXG4gICAgaWYgKHBhc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6ICgpID0+ICdFeHBlY3RlZCBOT1QgdG8gYmUgYSB2YWxpZCBBUEkgcmVzcG9uc2UnLFxuICAgICAgICBwYXNzOiB0cnVlLFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZTogKCkgPT4gYEV4cGVjdGVkIHRvIGJlIGEgdmFsaWQgQVBJIHJlc3BvbnNlIHdpdGggJ3N1Y2Nlc3MnIGFuZCAnZGF0YScvJ2Vycm9yJyBmaWVsZHNgLFxuICAgICAgICBwYXNzOiBmYWxzZSxcbiAgICAgIH07XG4gICAgfVxuICB9LFxufSk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIDYuIERFQ0xBUkHDh8ODTyBERSBUSVBPUyBQQVJBIE1BVENIRVJTIENVU1RPTUlaQURPU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZGVjbGFyZSBnbG9iYWwge1xuICBuYW1lc3BhY2UgamVzdCB7XG4gICAgaW50ZXJmYWNlIE1hdGNoZXJzPFI+IHtcbiAgICAgIHRvQmVDdXN0b21FcnJvcihleHBlY3RlZENsYXNzOiBhbnkpOiBSO1xuICAgICAgdG9CZUFwaVJlc3BvbnNlKCk6IFI7XG4gICAgfVxuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIDcuIENMRUFOVVAgQVDDk1MgQ0FEQSBURVNURVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuYWZ0ZXJFYWNoKCgpID0+IHtcbiAgamVzdC5jbGVhckFsbE1vY2tzKCk7IC8vIExpbXBhIGhpc3TDs3JpY28gZGUgY2FsbHMgZGUgbW9ja3Ncbn0pO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyA4LiBDTEVBTlVQIEFQw5NTIFRPRE9TIE9TIFRFU1RFU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuYWZ0ZXJBbGwoYXN5bmMgKCkgPT4ge1xuICAvLyBBZ3VhcmRhIHByb21pc2VzIHBlbmRlbnRlc1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcbiAgXG4gIC8vIEZlY2hhIGNvbmV4w7VlcyBhYmVydGFzIChzZSBob3V2ZXIpXG4gIC8vIGF3YWl0IERhdGFiYXNlTWFuYWdlci5jbG9zZSgpO1xuICAvLyBhd2FpdCBDYWNoZU1hbmFnZXIuY2xvc2UoKTtcbn0pO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyA5LiBFUlJPIERFIFBST01JU0VTIE7Dg08gVFJBVEFEQVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbnByb2Nlc3Mub24oJ3VuaGFuZGxlZFJlamVjdGlvbicsIChyZWFzb24sIHByb21pc2UpID0+IHtcbiAgY29uc29sZS5lcnJvcignVW5oYW5kbGVkIFJlamVjdGlvbiBkdXJpbmcgdGVzdDonLCByZWFzb24pO1xuICB0aHJvdyByZWFzb247XG59KTtcblxuY29uc29sZS5sb2coJ/Cfp6ogQW1iaWVudGUgZGUgdGVzdGVzIGNvbmZpZ3VyYWRvJyk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIDEwLiBFWFBPUlQgUEFSQSBUT1JOQVIgRVNURSBBUlFVSVZPIFVNIE3Dk0RVTE9cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE5lY2Vzc8OhcmlvIHBhcmEgbyAnZGVjbGFyZSBnbG9iYWwnIGZ1bmNpb25hclxuZXhwb3J0IHt9OyJdLCJ2ZXJzaW9uIjozfQ==