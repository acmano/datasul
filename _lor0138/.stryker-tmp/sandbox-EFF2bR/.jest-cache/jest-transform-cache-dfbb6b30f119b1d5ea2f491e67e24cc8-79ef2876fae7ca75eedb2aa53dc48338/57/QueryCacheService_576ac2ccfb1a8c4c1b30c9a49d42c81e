8ab549a491954a415e8ccff764d84576
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.QueryCacheService = void 0;
// @ts-nocheck
// src/shared/utils/cache/QueryCacheService.ts
function stryNS_9fa48() {
    var g = typeof globalThis === 'object' && globalThis && globalThis.Math === Math && globalThis || new Function("return this")();
    var ns = g.__stryker__ || (g.__stryker__ = {});
    if (ns.activeMutant === undefined && g.process && g.process.env && g.process.env.__STRYKER_ACTIVE_MUTANT__) {
        ns.activeMutant = g.process.env.__STRYKER_ACTIVE_MUTANT__;
    }
    function retrieveNS() {
        return ns;
    }
    stryNS_9fa48 = retrieveNS;
    return retrieveNS();
}
stryNS_9fa48();
function stryCov_9fa48() {
    var ns = stryNS_9fa48();
    var cov = ns.mutantCoverage || (ns.mutantCoverage = {
        static: {},
        perTest: {}
    });
    function cover() {
        var c = cov.static;
        if (ns.currentTestId) {
            c = cov.perTest[ns.currentTestId] = cov.perTest[ns.currentTestId] || {};
        }
        var a = arguments;
        for (var i = 0; i < a.length; i++) {
            c[a[i]] = (c[a[i]] || 0) + 1;
        }
    }
    stryCov_9fa48 = cover;
    cover.apply(null, arguments);
}
function stryMutAct_9fa48(id) {
    var ns = stryNS_9fa48();
    function isActive(id) {
        if (ns.activeMutant === id) {
            if (ns.hitCount !== void 0 && ++ns.hitCount > ns.hitLimit) {
                throw new Error('Stryker: Hit count limit reached (' + ns.hitCount + ')');
            }
            return true;
        }
        return false;
    }
    stryMutAct_9fa48 = isActive;
    return isActive(id);
}
const crypto_1 = __importDefault(require("crypto"));
const cacheManager_1 = require("../cacheManager");
const logger_1 = require("../logger");
/**
 * Serviço de cache para queries de banco de dados
 * Gera keys automáticas baseadas em hash(SQL + params)
 */
class QueryCacheService {
    /**
     * Executa query com cache
     *
     * @example
     * ```typescript
     * const result = await QueryCacheService.withCache(
     *   'SELECT * FROM item WHERE codigo = @p1',
     *   [{ name: 'p1', value: '7530110' }],
     *   async () => DatabaseManager.queryEmpWithParams(sql, params),
     *   { ttl: 600, prefix: 'item' }
     * );
     * ```
     */
    static async withCache(sql, params = stryMutAct_9fa48("3601") ? ["Stryker was here"] : (stryCov_9fa48("3601"), []), queryFn, options = {}) {
        if (stryMutAct_9fa48("3602")) {
            { }
        }
        else {
            stryCov_9fa48("3602");
            const { ttl = this.DEFAULT_TTL, prefix = this.DEFAULT_PREFIX, skipCache = stryMutAct_9fa48("3603") ? true : (stryCov_9fa48("3603"), false) } = options;
            // Se skip explícito, executa direto
            if (stryMutAct_9fa48("3605") ? false : stryMutAct_9fa48("3604") ? true : (stryCov_9fa48("3604", "3605"), skipCache)) {
                if (stryMutAct_9fa48("3606")) {
                    { }
                }
                else {
                    stryCov_9fa48("3606");
                    logger_1.log.debug(stryMutAct_9fa48("3607") ? "" : (stryCov_9fa48("3607"), 'Query cache: SKIP'), stryMutAct_9fa48("3608") ? {} : (stryCov_9fa48("3608"), {
                        prefix
                    }));
                    return queryFn();
                }
            }
            // Gerar chave de cache
            const cacheKey = this.generateCacheKey(sql, params, prefix);
            // Tentar buscar do cache
            const cached = await cacheManager_1.CacheManager.get(cacheKey);
            if (stryMutAct_9fa48("3611") ? cached === undefined : stryMutAct_9fa48("3610") ? false : stryMutAct_9fa48("3609") ? true : (stryCov_9fa48("3609", "3610", "3611"), cached !== undefined)) {
                if (stryMutAct_9fa48("3612")) {
                    { }
                }
                else {
                    stryCov_9fa48("3612");
                    logger_1.log.debug(stryMutAct_9fa48("3613") ? "" : (stryCov_9fa48("3613"), 'Query cache: HIT'), stryMutAct_9fa48("3614") ? {} : (stryCov_9fa48("3614"), {
                        key: cacheKey,
                        prefix
                    }));
                    return cached;
                }
            }
            // MISS: executar query
            logger_1.log.debug(stryMutAct_9fa48("3615") ? "" : (stryCov_9fa48("3615"), 'Query cache: MISS'), stryMutAct_9fa48("3616") ? {} : (stryCov_9fa48("3616"), {
                key: cacheKey,
                prefix
            }));
            const result = await queryFn();
            // Armazenar no cache
            await cacheManager_1.CacheManager.set(cacheKey, result, ttl);
            return result;
        }
    }
    /**
     * Gera chave de cache determinística
     * Hash MD5 de: prefix:sql:params_json
     *
     * ✅ CORRIGIDO: Serializa params corretamente (array ou objeto)
     */
    static generateCacheKey(sql, params, prefix) {
        if (stryMutAct_9fa48("3617")) {
            { }
        }
        else {
            stryCov_9fa48("3617");
            // Normalizar SQL (remover espaços extras)
            const normalizedSql = stryMutAct_9fa48("3618") ? sql.replace(/\s+/g, ' ') : (stryCov_9fa48("3618"), sql.replace(stryMutAct_9fa48("3620") ? /\S+/g : stryMutAct_9fa48("3619") ? /\s/g : (stryCov_9fa48("3619", "3620"), /\s+/g), stryMutAct_9fa48("3621") ? "" : (stryCov_9fa48("3621"), ' ')).trim());
            // ✅ CORREÇÃO: Serializar params de forma determinística
            // Se for array, mapeia para extrair valores relevantes
            let paramsStr;
            if (stryMutAct_9fa48("3623") ? false : stryMutAct_9fa48("3622") ? true : (stryCov_9fa48("3622", "3623"), Array.isArray(params))) {
                if (stryMutAct_9fa48("3624")) {
                    { }
                }
                else {
                    stryCov_9fa48("3624");
                    // Para array de QueryParameter: [{name, type, value}, ...]
                    const sortedParams = stryMutAct_9fa48("3625") ? params.map(p => {
                        if (typeof p === 'object' && p !== null) {
                            // Extrai apenas name e value, ordena as chaves
                            return {
                                name: p.name,
                                value: p.value
                            };
                        }
                        return p;
                    }) : (stryCov_9fa48("3625"), params.map(p => {
                        if (stryMutAct_9fa48("3626")) {
                            { }
                        }
                        else {
                            stryCov_9fa48("3626");
                            if (stryMutAct_9fa48("3629") ? typeof p === 'object' || p !== null : stryMutAct_9fa48("3628") ? false : stryMutAct_9fa48("3627") ? true : (stryCov_9fa48("3627", "3628", "3629"), (stryMutAct_9fa48("3631") ? typeof p !== 'object' : stryMutAct_9fa48("3630") ? true : (stryCov_9fa48("3630", "3631"), typeof p === (stryMutAct_9fa48("3632") ? "" : (stryCov_9fa48("3632"), 'object')))) && (stryMutAct_9fa48("3634") ? p === null : stryMutAct_9fa48("3633") ? true : (stryCov_9fa48("3633", "3634"), p !== null)))) {
                                if (stryMutAct_9fa48("3635")) {
                                    { }
                                }
                                else {
                                    stryCov_9fa48("3635");
                                    // Extrai apenas name e value, ordena as chaves
                                    return stryMutAct_9fa48("3636") ? {} : (stryCov_9fa48("3636"), {
                                        name: p.name,
                                        value: p.value
                                    });
                                }
                            }
                            return p;
                        }
                    }).sort((a, b) => {
                        if (stryMutAct_9fa48("3637")) {
                            { }
                        }
                        else {
                            stryCov_9fa48("3637");
                            // Ordena por name se existir
                            const nameA = stryMutAct_9fa48("3640") ? a?.name && '' : stryMutAct_9fa48("3639") ? false : stryMutAct_9fa48("3638") ? true : (stryCov_9fa48("3638", "3639", "3640"), (stryMutAct_9fa48("3641") ? a.name : (stryCov_9fa48("3641"), a?.name)) || (stryMutAct_9fa48("3642") ? "Stryker was here!" : (stryCov_9fa48("3642"), '')));
                            const nameB = stryMutAct_9fa48("3645") ? b?.name && '' : stryMutAct_9fa48("3644") ? false : stryMutAct_9fa48("3643") ? true : (stryCov_9fa48("3643", "3644", "3645"), (stryMutAct_9fa48("3646") ? b.name : (stryCov_9fa48("3646"), b?.name)) || (stryMutAct_9fa48("3647") ? "Stryker was here!" : (stryCov_9fa48("3647"), '')));
                            return nameA.localeCompare(nameB);
                        }
                    }));
                    paramsStr = JSON.stringify(sortedParams);
                }
            }
            else {
                if (stryMutAct_9fa48("3648")) {
                    { }
                }
                else {
                    stryCov_9fa48("3648");
                    // Para objeto simples
                    paramsStr = JSON.stringify(params, stryMutAct_9fa48("3649") ? Object.keys(params) : (stryCov_9fa48("3649"), Object.keys(params).sort()));
                }
            }
            // Gerar hash
            const hash = stryMutAct_9fa48("3650") ? crypto_1.default.createHash('md5').update(`${normalizedSql}:${paramsStr}`).digest('hex') : (stryCov_9fa48("3650"), crypto_1.default.createHash(stryMutAct_9fa48("3651") ? "" : (stryCov_9fa48("3651"), 'md5')).update(stryMutAct_9fa48("3652") ? `` : (stryCov_9fa48("3652"), `${normalizedSql}:${paramsStr}`)).digest(stryMutAct_9fa48("3653") ? "" : (stryCov_9fa48("3653"), 'hex')).substring(0, 16)); // 16 chars é suficiente
            return stryMutAct_9fa48("3654") ? `` : (stryCov_9fa48("3654"), `${prefix}:${hash}`);
        }
    }
    /**
     * Invalida cache por pattern
     *
     * @example
     * ```typescript
     * // Invalidar todos os caches de item
     * await QueryCacheService.invalidate('item:*');
     *
     * // Invalidar cache específico
     * await QueryCacheService.invalidate('item:abc123def456');
     * ```
     */
    static async invalidate(pattern) {
        if (stryMutAct_9fa48("3655")) {
            { }
        }
        else {
            stryCov_9fa48("3655");
            logger_1.log.info(stryMutAct_9fa48("3656") ? "" : (stryCov_9fa48("3656"), 'Query cache: INVALIDATE'), stryMutAct_9fa48("3657") ? {} : (stryCov_9fa48("3657"), {
                pattern
            }));
            return cacheManager_1.CacheManager.delete(pattern);
        }
    }
    /**
     * Invalida múltiplos patterns
     */
    static async invalidateMultiple(patterns) {
        if (stryMutAct_9fa48("3658")) {
            { }
        }
        else {
            stryCov_9fa48("3658");
            let total = 0;
            for (const pattern of patterns) {
                if (stryMutAct_9fa48("3659")) {
                    { }
                }
                else {
                    stryCov_9fa48("3659");
                    stryMutAct_9fa48("3660") ? total -= await this.invalidate(pattern) : (stryCov_9fa48("3660"), total += await this.invalidate(pattern));
                }
            }
            return total;
        }
    }
    /**
     * Wrapper para queries de itens
     */
    static async withItemCache(sql, params, queryFn, ttl) {
        if (stryMutAct_9fa48("3661")) {
            { }
        }
        else {
            stryCov_9fa48("3661");
            return this.withCache(sql, params, queryFn, stryMutAct_9fa48("3662") ? {} : (stryCov_9fa48("3662"), {
                ttl: stryMutAct_9fa48("3665") ? ttl && 600 : stryMutAct_9fa48("3664") ? false : stryMutAct_9fa48("3663") ? true : (stryCov_9fa48("3663", "3664", "3665"), ttl || 600),
                // 10 minutos para itens
                prefix: stryMutAct_9fa48("3666") ? "" : (stryCov_9fa48("3666"), 'item')
            }));
        }
    }
    /**
     * Wrapper para queries de estabelecimentos
     */
    static async withEstabelecimentoCache(sql, params, queryFn, ttl) {
        if (stryMutAct_9fa48("3667")) {
            { }
        }
        else {
            stryCov_9fa48("3667");
            return this.withCache(sql, params, queryFn, stryMutAct_9fa48("3668") ? {} : (stryCov_9fa48("3668"), {
                ttl: stryMutAct_9fa48("3671") ? ttl && 900 : stryMutAct_9fa48("3670") ? false : stryMutAct_9fa48("3669") ? true : (stryCov_9fa48("3669", "3670", "3671"), ttl || 900),
                // 15 minutos para estabelecimentos
                prefix: stryMutAct_9fa48("3672") ? "" : (stryCov_9fa48("3672"), 'estabelecimento')
            }));
        }
    }
    /**
     * Wrapper para queries de health check (TTL curto)
     */
    static async withHealthCache(sql, params, queryFn) {
        if (stryMutAct_9fa48("3673")) {
            { }
        }
        else {
            stryCov_9fa48("3673");
            return this.withCache(sql, params, queryFn, stryMutAct_9fa48("3674") ? {} : (stryCov_9fa48("3674"), {
                ttl: 30,
                // 30 segundos
                prefix: stryMutAct_9fa48("3675") ? "" : (stryCov_9fa48("3675"), 'health')
            }));
        }
    }
}
exports.QueryCacheService = QueryCacheService;
QueryCacheService.DEFAULT_TTL = 300; // 5 minutos
QueryCacheService.DEFAULT_PREFIX = stryMutAct_9fa48("3600") ? "" : (stryCov_9fa48("3600"), 'query');
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWFuby9wcm9qZXRvcy9kYXRhc3VsL2xvcjAxMzgvLnN0cnlrZXItdG1wL3NhbmRib3gtRUZGMmJSL3NyYy9zaGFyZWQvdXRpbHMvY2FjaGUvUXVlcnlDYWNoZVNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsY0FBYztBQUNkLDhDQUE4QztBQUM5QyxTQUFTLFlBQVk7SUFDbkIsSUFBSSxDQUFDLEdBQUcsT0FBTyxVQUFVLEtBQUssUUFBUSxJQUFJLFVBQVUsSUFBSSxVQUFVLENBQUMsSUFBSSxLQUFLLElBQUksSUFBSSxVQUFVLElBQUksSUFBSSxRQUFRLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQztJQUNoSSxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsV0FBVyxJQUFJLENBQUMsQ0FBQyxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUMvQyxJQUFJLEVBQUUsQ0FBQyxZQUFZLEtBQUssU0FBUyxJQUFJLENBQUMsQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMseUJBQXlCLEVBQUUsQ0FBQztRQUMzRyxFQUFFLENBQUMsWUFBWSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixDQUFDO0lBQzVELENBQUM7SUFDRCxTQUFTLFVBQVU7UUFDakIsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDO0lBQ0QsWUFBWSxHQUFHLFVBQVUsQ0FBQztJQUMxQixPQUFPLFVBQVUsRUFBRSxDQUFDO0FBQ3RCLENBQUM7QUFDRCxZQUFZLEVBQUUsQ0FBQztBQUNmLFNBQVMsYUFBYTtJQUNwQixJQUFJLEVBQUUsR0FBRyxZQUFZLEVBQUUsQ0FBQztJQUN4QixJQUFJLEdBQUcsR0FBRyxFQUFFLENBQUMsY0FBYyxJQUFJLENBQUMsRUFBRSxDQUFDLGNBQWMsR0FBRztRQUNsRCxNQUFNLEVBQUUsRUFBRTtRQUNWLE9BQU8sRUFBRSxFQUFFO0tBQ1osQ0FBQyxD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QUUsT0FBTyxFQUFFLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUNsRyxHQUFHLEVBQUUsRUFBRTtnQkFDUCxjQUFjO2dCQUNkLE1BQU0sRUFBRSxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsRUFBRSxRQUFRLENBQUM7YUFDMUUsQ0FBQyxDQUFDLENBQUM7UUFDTixDQUFDO0lBQ0gsQ0FBQzs7QUFwUEgsOENBcVBDO0FBcFB5Qiw2QkFBVyxHQUFHLEdBQUcsQ0FBQyxDQUFDLFlBQVk7QUFDL0IsZ0NBQWMsR0FBRyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9tYW5vL3Byb2pldG9zL2RhdGFzdWwvbG9yMDEzOC8uc3RyeWtlci10bXAvc2FuZGJveC1FRkYyYlIvc3JjL3NoYXJlZC91dGlscy9jYWNoZS9RdWVyeUNhY2hlU2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAdHMtbm9jaGVja1xuLy8gc3JjL3NoYXJlZC91dGlscy9jYWNoZS9RdWVyeUNhY2hlU2VydmljZS50c1xuZnVuY3Rpb24gc3RyeU5TXzlmYTQ4KCkge1xuICB2YXIgZyA9IHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JyAmJiBnbG9iYWxUaGlzICYmIGdsb2JhbFRoaXMuTWF0aCA9PT0gTWF0aCAmJiBnbG9iYWxUaGlzIHx8IG5ldyBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XG4gIHZhciBucyA9IGcuX19zdHJ5a2VyX18gfHwgKGcuX19zdHJ5a2VyX18gPSB7fSk7XG4gIGlmIChucy5hY3RpdmVNdXRhbnQgPT09IHVuZGVmaW5lZCAmJiBnLnByb2Nlc3MgJiYgZy5wcm9jZXNzLmVudiAmJiBnLnByb2Nlc3MuZW52Ll9fU1RSWUtFUl9BQ1RJVkVfTVVUQU5UX18pIHtcbiAgICBucy5hY3RpdmVNdXRhbnQgPSBnLnByb2Nlc3MuZW52Ll9fU1RSWUtFUl9BQ1RJVkVfTVVUQU5UX187XG4gIH1cbiAgZnVuY3Rpb24gcmV0cmlldmVOUygpIHtcbiAgICByZXR1cm4gbnM7XG4gIH1cbiAgc3RyeU5TXzlmYTQ4ID0gcmV0cmlldmVOUztcbiAgcmV0dXJuIHJldHJpZXZlTlMoKTtcbn1cbnN0cnlOU185ZmE0OCgpO1xuZnVuY3Rpb24gc3RyeUNvdl85ZmE0OCgpIHtcbiAgdmFyIG5zID0gc3RyeU5TXzlmYTQ4KCk7XG4gIHZhciBjb3YgPSBucy5tdXRhbnRDb3ZlcmFnZSB8fCAobnMubXV0YW50Q292ZXJhZ2UgPSB7XG4gICAgc3RhdGljOiB7fSxcbiAgICBwZXJUZXN0OiB7fVxuICB9KTtcbiAgZnVuY3Rpb24gY292ZXIoKSB7XG4gICAgdmFyIGMgPSBjb3Yuc3RhdGljO1xuICAgIGlmIChucy5jdXJyZW50VGVzdElkKSB7XG4gICAgICBjID0gY292LnBlclRlc3RbbnMuY3VycmVudFRlc3RJZF0gPSBjb3YucGVyVGVzdFtucy5jdXJyZW50VGVzdElkXSB8fCB7fTtcbiAgICB9XG4gICAgdmFyIGEgPSBhcmd1bWVudHM7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjW2FbaV1dID0gKGNbYVtpXV0gfHwgMCkgKyAxO1xuICAgIH1cbiAgfVxuICBzdHJ5Q292XzlmYTQ4ID0gY292ZXI7XG4gIGNvdmVyLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBzdHJ5TXV0QWN0XzlmYTQ4KGlkKSB7XG4gIHZhciBucyA9IHN0cnlOU185ZmE0OCgpO1xuICBmdW5jdGlvbiBpc0FjdGl2ZShpZCkge1xuICAgIGlmIChucy5hY3RpdmVNdXRhbnQgPT09IGlkKSB7XG4gICAgICBpZiAobnMuaGl0Q291bnQgIT09IHZvaWQgMCAmJiArK25zLmhpdENvdW50ID4gbnMuaGl0TGltaXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTdHJ5a2VyOiBIaXQgY291bnQgbGltaXQgcmVhY2hlZCAoJyArIG5zLmhpdENvdW50ICsgJyknKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgc3RyeU11dEFjdF85ZmE0OCA9IGlzQWN0aXZlO1xuICByZXR1cm4gaXNBY3RpdmUoaWQpO1xufVxuaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuaW1wb3J0IHsgQ2FjaGVNYW5hZ2VyIH0gZnJvbSAnLi4vY2FjaGVNYW5hZ2VyJztcbmltcG9ydCB7IGxvZyB9IGZyb20gJy4uL2xvZ2dlcic7XG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJ5Q2FjaGVPcHRpb25zIHtcbiAgdHRsPzogbnVtYmVyOyAvLyBUVEwgZXNwZWPDrWZpY28gZW0gc2VndW5kb3NcbiAgcHJlZml4Pzogc3RyaW5nOyAvLyBQcmVmaXhvIGRhIGNoYXZlIGRlIGNhY2hlXG4gIHNraXBDYWNoZT86IGJvb2xlYW47IC8vIFB1bGFyIGNhY2hlIHBhcmEgZXN0YSBxdWVyeVxuICBpbnZhbGlkYXRlUGF0dGVybj86IHN0cmluZzsgLy8gUGF0dGVybiBwYXJhIGludmFsaWRhclxufVxuXG4vKipcbiAqIFNlcnZpw6dvIGRlIGNhY2hlIHBhcmEgcXVlcmllcyBkZSBiYW5jbyBkZSBkYWRvc1xuICogR2VyYSBrZXlzIGF1dG9tw6F0aWNhcyBiYXNlYWRhcyBlbSBoYXNoKFNRTCArIHBhcmFtcylcbiAqL1xuZXhwb3J0IGNsYXNzIFF1ZXJ5Q2FjaGVTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgREVGQVVMVF9UVEwgPSAzMDA7IC8vIDUgbWludXRvc1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBERUZBVUxUX1BSRUZJWCA9IHN0cnlNdXRBY3RfOWZhNDgoXCIzNjAwXCIpID8gXCJcIiA6IChzdHJ5Q292XzlmYTQ4KFwiMzYwMFwiKSwgJ3F1ZXJ5Jyk7XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGEgcXVlcnkgY29tIGNhY2hlXG4gICAqIFxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhDYWNoZShcbiAgICogICAnU0VMRUNUICogRlJPTSBpdGVtIFdIRVJFIGNvZGlnbyA9IEBwMScsXG4gICAqICAgW3sgbmFtZTogJ3AxJywgdmFsdWU6ICc3NTMwMTEwJyB9XSxcbiAgICogICBhc3luYyAoKSA9PiBEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zKHNxbCwgcGFyYW1zKSxcbiAgICogICB7IHR0bDogNjAwLCBwcmVmaXg6ICdpdGVtJyB9XG4gICAqICk7XG4gICAqIGBgYFxuICAgKi9cbiAgc3RhdGljIGFzeW5jIHdpdGhDYWNoZTxUPihzcWw6IHN0cmluZywgcGFyYW1zOiBhbnlbXSA9IHN0cnlNdXRBY3RfOWZhNDgoXCIzNjAxXCIpID8gW1wiU3RyeWtlciB3YXMgaGVyZVwiXSA6IChzdHJ5Q292XzlmYTQ4KFwiMzYwMVwiKSwgW10pLCBxdWVyeUZuOiAoKSA9PiBQcm9taXNlPFQ+LCBvcHRpb25zOiBRdWVyeUNhY2hlT3B0aW9ucyA9IHt9KTogUHJvbWlzZTxUPiB7XG4gICAgaWYgKHN0cnlNdXRBY3RfOWZhNDgoXCIzNjAyXCIpKSB7XG4gICAgICB7fVxuICAgIH0gZWxzZSB7XG4gICAgICBzdHJ5Q292XzlmYTQ4KFwiMzYwMlwiKTtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdHRsID0gdGhpcy5ERUZBVUxUX1RUTCxcbiAgICAgICAgcHJlZml4ID0gdGhpcy5ERUZBVUxUX1BSRUZJWCxcbiAgICAgICAgc2tpcENhY2hlID0gc3RyeU11dEFjdF85ZmE0OChcIjM2MDNcIikgPyB0cnVlIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjAzXCIpLCBmYWxzZSlcbiAgICAgIH0gPSBvcHRpb25zO1xuXG4gICAgICAvLyBTZSBza2lwIGV4cGzDrWNpdG8sIGV4ZWN1dGEgZGlyZXRvXG4gICAgICBpZiAoc3RyeU11dEFjdF85ZmE0OChcIjM2MDVcIikgPyBmYWxzZSA6IHN0cnlNdXRBY3RfOWZhNDgoXCIzNjA0XCIpID8gdHJ1ZSA6IChzdHJ5Q292XzlmYTQ4KFwiMzYwNFwiLCBcIjM2MDVcIiksIHNraXBDYWNoZSkpIHtcbiAgICAgICAgaWYgKHN0cnlNdXRBY3RfOWZhNDgoXCIzNjA2XCIpKSB7XG4gICAgICAgICAge31cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdHJ5Q292XzlmYTQ4KFwiMzYwNlwiKTtcbiAgICAgICAgICBsb2cuZGVidWcoc3RyeU11dEFjdF85ZmE0OChcIjM2MDdcIikgPyBcIlwiIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjA3XCIpLCAnUXVlcnkgY2FjaGU6IFNLSVAnKSwgc3RyeU11dEFjdF85ZmE0OChcIjM2MDhcIikgPyB7fSA6IChzdHJ5Q292XzlmYTQ4KFwiMzYwOFwiKSwge1xuICAgICAgICAgICAgcHJlZml4XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIHJldHVybiBxdWVyeUZuKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gR2VyYXIgY2hhdmUgZGUgY2FjaGVcbiAgICAgIGNvbnN0IGNhY2hlS2V5ID0gdGhpcy5nZW5lcmF0ZUNhY2hlS2V5KHNxbCwgcGFyYW1zLCBwcmVmaXgpO1xuXG4gICAgICAvLyBUZW50YXIgYnVzY2FyIGRvIGNhY2hlXG4gICAgICBjb25zdCBjYWNoZWQgPSBhd2FpdCBDYWNoZU1hbmFnZXIuZ2V0PFQ+KGNhY2hlS2V5KTtcbiAgICAgIGlmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYxMVwiKSA/IGNhY2hlZCA9PT0gdW5kZWZpbmVkIDogc3RyeU11dEFjdF85ZmE0OChcIjM2MTBcIikgPyBmYWxzZSA6IHN0cnlNdXRBY3RfOWZhNDgoXCIzNjA5XCIpID8gdHJ1ZSA6IChzdHJ5Q292XzlmYTQ4KFwiMzYwOVwiLCBcIjM2MTBcIiwgXCIzNjExXCIpLCBjYWNoZWQgIT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgaWYgKHN0cnlNdXRBY3RfOWZhNDgoXCIzNjEyXCIpKSB7XG4gICAgICAgICAge31cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdHJ5Q292XzlmYTQ4KFwiMzYxMlwiKTtcbiAgICAgICAgICBsb2cuZGVidWcoc3RyeU11dEFjdF85ZmE0OChcIjM2MTNcIikgPyBcIlwiIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjEzXCIpLCAnUXVlcnkgY2FjaGU6IEhJVCcpLCBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYxNFwiKSA/IHt9IDogKHN0cnlDb3ZfOWZhNDgoXCIzNjE0XCIpLCB7XG4gICAgICAgICAgICBrZXk6IGNhY2hlS2V5LFxuICAgICAgICAgICAgcHJlZml4XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIHJldHVybiBjYWNoZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTUlTUzogZXhlY3V0YXIgcXVlcnlcbiAgICAgIGxvZy5kZWJ1ZyhzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYxNVwiKSA/IFwiXCIgOiAoc3RyeUNvdl85ZmE0OChcIjM2MTVcIiksICdRdWVyeSBjYWNoZTogTUlTUycpLCBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYxNlwiKSA/IHt9IDogKHN0cnlDb3ZfOWZhNDgoXCIzNjE2XCIpLCB7XG4gICAgICAgIGtleTogY2FjaGVLZXksXG4gICAgICAgIHByZWZpeFxuICAgICAgfSkpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnlGbigpO1xuXG4gICAgICAvLyBBcm1hemVuYXIgbm8gY2FjaGVcbiAgICAgIGF3YWl0IENhY2hlTWFuYWdlci5zZXQoY2FjaGVLZXksIHJlc3VsdCwgdHRsKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlcmEgY2hhdmUgZGUgY2FjaGUgZGV0ZXJtaW7DrXN0aWNhXG4gICAqIEhhc2ggTUQ1IGRlOiBwcmVmaXg6c3FsOnBhcmFtc19qc29uXG4gICAqIFxuICAgKiDinIUgQ09SUklHSURPOiBTZXJpYWxpemEgcGFyYW1zIGNvcnJldGFtZW50ZSAoYXJyYXkgb3Ugb2JqZXRvKVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZ2VuZXJhdGVDYWNoZUtleShzcWw6IHN0cmluZywgcGFyYW1zOiBhbnlbXSwgcHJlZml4OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGlmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYxN1wiKSkge1xuICAgICAge31cbiAgICB9IGVsc2Uge1xuICAgICAgc3RyeUNvdl85ZmE0OChcIjM2MTdcIik7XG4gICAgICAvLyBOb3JtYWxpemFyIFNRTCAocmVtb3ZlciBlc3Bhw6dvcyBleHRyYXMpXG4gICAgICBjb25zdCBub3JtYWxpemVkU3FsID0gc3RyeU11dEFjdF85ZmE0OChcIjM2MThcIikgPyBzcWwucmVwbGFjZSgvXFxzKy9nLCAnICcpIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjE4XCIpLCBzcWwucmVwbGFjZShzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYyMFwiKSA/IC9cXFMrL2cgOiBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYxOVwiKSA/IC9cXHMvZyA6IChzdHJ5Q292XzlmYTQ4KFwiMzYxOVwiLCBcIjM2MjBcIiksIC9cXHMrL2cpLCBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYyMVwiKSA/IFwiXCIgOiAoc3RyeUNvdl85ZmE0OChcIjM2MjFcIiksICcgJykpLnRyaW0oKSk7XG5cbiAgICAgIC8vIOKchSBDT1JSRcOHw4NPOiBTZXJpYWxpemFyIHBhcmFtcyBkZSBmb3JtYSBkZXRlcm1pbsOtc3RpY2FcbiAgICAgIC8vIFNlIGZvciBhcnJheSwgbWFwZWlhIHBhcmEgZXh0cmFpciB2YWxvcmVzIHJlbGV2YW50ZXNcbiAgICAgIGxldCBwYXJhbXNTdHI6IHN0cmluZztcbiAgICAgIGlmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYyM1wiKSA/IGZhbHNlIDogc3RyeU11dEFjdF85ZmE0OChcIjM2MjJcIikgPyB0cnVlIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjIyXCIsIFwiMzYyM1wiKSwgQXJyYXkuaXNBcnJheShwYXJhbXMpKSkge1xuICAgICAgICBpZiAoc3RyeU11dEFjdF85ZmE0OChcIjM2MjRcIikpIHtcbiAgICAgICAgICB7fVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHN0cnlDb3ZfOWZhNDgoXCIzNjI0XCIpO1xuICAgICAgICAgIC8vIFBhcmEgYXJyYXkgZGUgUXVlcnlQYXJhbWV0ZXI6IFt7bmFtZSwgdHlwZSwgdmFsdWV9LCAuLi5dXG4gICAgICAgICAgY29uc3Qgc29ydGVkUGFyYW1zID0gc3RyeU11dEFjdF85ZmE0OChcIjM2MjVcIikgPyBwYXJhbXMubWFwKHAgPT4ge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBwID09PSAnb2JqZWN0JyAmJiBwICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgIC8vIEV4dHJhaSBhcGVuYXMgbmFtZSBlIHZhbHVlLCBvcmRlbmEgYXMgY2hhdmVzXG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogcC5uYW1lLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBwLnZhbHVlXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcDtcbiAgICAgICAgICB9KSA6IChzdHJ5Q292XzlmYTQ4KFwiMzYyNVwiKSwgcGFyYW1zLm1hcChwID0+IHtcbiAgICAgICAgICAgIGlmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYyNlwiKSkge1xuICAgICAgICAgICAgICB7fVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc3RyeUNvdl85ZmE0OChcIjM2MjZcIik7XG4gICAgICAgICAgICAgIGlmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYyOVwiKSA/IHR5cGVvZiBwID09PSAnb2JqZWN0JyB8fCBwICE9PSBudWxsIDogc3RyeU11dEFjdF85ZmE0OChcIjM2MjhcIikgPyBmYWxzZSA6IHN0cnlNdXRBY3RfOWZhNDgoXCIzNjI3XCIpID8gdHJ1ZSA6IChzdHJ5Q292XzlmYTQ4KFwiMzYyN1wiLCBcIjM2MjhcIiwgXCIzNjI5XCIpLCAoc3RyeU11dEFjdF85ZmE0OChcIjM2MzFcIikgPyB0eXBlb2YgcCAhPT0gJ29iamVjdCcgOiBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYzMFwiKSA/IHRydWUgOiAoc3RyeUNvdl85ZmE0OChcIjM2MzBcIiwgXCIzNjMxXCIpLCB0eXBlb2YgcCA9PT0gKHN0cnlNdXRBY3RfOWZhNDgoXCIzNjMyXCIpID8gXCJcIiA6IChzdHJ5Q292XzlmYTQ4KFwiMzYzMlwiKSwgJ29iamVjdCcpKSkpICYmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYzNFwiKSA/IHAgPT09IG51bGwgOiBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYzM1wiKSA/IHRydWUgOiAoc3RyeUNvdl85ZmE0OChcIjM2MzNcIiwgXCIzNjM0XCIpLCBwICE9PSBudWxsKSkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0cnlNdXRBY3RfOWZhNDgoXCIzNjM1XCIpKSB7XG4gICAgICAgICAgICAgICAgICB7fVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBzdHJ5Q292XzlmYTQ4KFwiMzYzNVwiKTtcbiAgICAgICAgICAgICAgICAgIC8vIEV4dHJhaSBhcGVuYXMgbmFtZSBlIHZhbHVlLCBvcmRlbmEgYXMgY2hhdmVzXG4gICAgICAgICAgICAgICAgICByZXR1cm4gc3RyeU11dEFjdF85ZmE0OChcIjM2MzZcIikgPyB7fSA6IChzdHJ5Q292XzlmYTQ4KFwiMzYzNlwiKSwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBwLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBwLnZhbHVlXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgaWYgKHN0cnlNdXRBY3RfOWZhNDgoXCIzNjM3XCIpKSB7XG4gICAgICAgICAgICAgIHt9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzdHJ5Q292XzlmYTQ4KFwiMzYzN1wiKTtcbiAgICAgICAgICAgICAgLy8gT3JkZW5hIHBvciBuYW1lIHNlIGV4aXN0aXJcbiAgICAgICAgICAgICAgY29uc3QgbmFtZUEgPSBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzY0MFwiKSA/IGE/Lm5hbWUgJiYgJycgOiBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzYzOVwiKSA/IGZhbHNlIDogc3RyeU11dEFjdF85ZmE0OChcIjM2MzhcIikgPyB0cnVlIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjM4XCIsIFwiMzYzOVwiLCBcIjM2NDBcIiksIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMzY0MVwiKSA/IGEubmFtZSA6IChzdHJ5Q292XzlmYTQ4KFwiMzY0MVwiKSwgYT8ubmFtZSkpIHx8IChzdHJ5TXV0QWN0XzlmYTQ4KFwiMzY0MlwiKSA/IFwiU3RyeWtlciB3YXMgaGVyZSFcIiA6IChzdHJ5Q292XzlmYTQ4KFwiMzY0MlwiKSwgJycpKSk7XG4gICAgICAgICAgICAgIGNvbnN0IG5hbWVCID0gc3RyeU11dEFjdF85ZmE0OChcIjM2NDVcIikgPyBiPy5uYW1lICYmICcnIDogc3RyeU11dEFjdF85ZmE0OChcIjM2NDRcIikgPyBmYWxzZSA6IHN0cnlNdXRBY3RfOWZhNDgoXCIzNjQzXCIpID8gdHJ1ZSA6IChzdHJ5Q292XzlmYTQ4KFwiMzY0M1wiLCBcIjM2NDRcIiwgXCIzNjQ1XCIpLCAoc3RyeU11dEFjdF85ZmE0OChcIjM2NDZcIikgPyBiLm5hbWUgOiAoc3RyeUNvdl85ZmE0OChcIjM2NDZcIiksIGI/Lm5hbWUpKSB8fCAoc3RyeU11dEFjdF85ZmE0OChcIjM2NDdcIikgPyBcIlN0cnlrZXIgd2FzIGhlcmUhXCIgOiAoc3RyeUNvdl85ZmE0OChcIjM2NDdcIiksICcnKSkpO1xuICAgICAgICAgICAgICByZXR1cm4gbmFtZUEubG9jYWxlQ29tcGFyZShuYW1lQik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIHBhcmFtc1N0ciA9IEpTT04uc3RyaW5naWZ5KHNvcnRlZFBhcmFtcyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChzdHJ5TXV0QWN0XzlmYTQ4KFwiMzY0OFwiKSkge1xuICAgICAgICAgIHt9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc3RyeUNvdl85ZmE0OChcIjM2NDhcIik7XG4gICAgICAgICAgLy8gUGFyYSBvYmpldG8gc2ltcGxlc1xuICAgICAgICAgIHBhcmFtc1N0ciA9IEpTT04uc3RyaW5naWZ5KHBhcmFtcywgc3RyeU11dEFjdF85ZmE0OChcIjM2NDlcIikgPyBPYmplY3Qua2V5cyhwYXJhbXMpIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjQ5XCIpLCBPYmplY3Qua2V5cyhwYXJhbXMpLnNvcnQoKSkpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEdlcmFyIGhhc2hcbiAgICAgIGNvbnN0IGhhc2ggPSBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzY1MFwiKSA/IGNyeXB0by5jcmVhdGVIYXNoKCdtZDUnKS51cGRhdGUoYCR7bm9ybWFsaXplZFNxbH06JHtwYXJhbXNTdHJ9YCkuZGlnZXN0KCdoZXgnKSA6IChzdHJ5Q292XzlmYTQ4KFwiMzY1MFwiKSwgY3J5cHRvLmNyZWF0ZUhhc2goc3RyeU11dEFjdF85ZmE0OChcIjM2NTFcIikgPyBcIlwiIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjUxXCIpLCAnbWQ1JykpLnVwZGF0ZShzdHJ5TXV0QWN0XzlmYTQ4KFwiMzY1MlwiKSA/IGBgIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjUyXCIpLCBgJHtub3JtYWxpemVkU3FsfToke3BhcmFtc1N0cn1gKSkuZGlnZXN0KHN0cnlNdXRBY3RfOWZhNDgoXCIzNjUzXCIpID8gXCJcIiA6IChzdHJ5Q292XzlmYTQ4KFwiMzY1M1wiKSwgJ2hleCcpKS5zdWJzdHJpbmcoMCwgMTYpKTsgLy8gMTYgY2hhcnMgw6kgc3VmaWNpZW50ZVxuXG4gICAgICByZXR1cm4gc3RyeU11dEFjdF85ZmE0OChcIjM2NTRcIikgPyBgYCA6IChzdHJ5Q292XzlmYTQ4KFwiMzY1NFwiKSwgYCR7cHJlZml4fToke2hhc2h9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEludmFsaWRhIGNhY2hlIHBvciBwYXR0ZXJuXG4gICAqIFxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIC8vIEludmFsaWRhciB0b2RvcyBvcyBjYWNoZXMgZGUgaXRlbVxuICAgKiBhd2FpdCBRdWVyeUNhY2hlU2VydmljZS5pbnZhbGlkYXRlKCdpdGVtOionKTtcbiAgICogXG4gICAqIC8vIEludmFsaWRhciBjYWNoZSBlc3BlY8OtZmljb1xuICAgKiBhd2FpdCBRdWVyeUNhY2hlU2VydmljZS5pbnZhbGlkYXRlKCdpdGVtOmFiYzEyM2RlZjQ1NicpO1xuICAgKiBgYGBcbiAgICovXG4gIHN0YXRpYyBhc3luYyBpbnZhbGlkYXRlKHBhdHRlcm46IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgaWYgKHN0cnlNdXRBY3RfOWZhNDgoXCIzNjU1XCIpKSB7XG4gICAgICB7fVxuICAgIH0gZWxzZSB7XG4gICAgICBzdHJ5Q292XzlmYTQ4KFwiMzY1NVwiKTtcbiAgICAgIGxvZy5pbmZvKHN0cnlNdXRBY3RfOWZhNDgoXCIzNjU2XCIpID8gXCJcIiA6IChzdHJ5Q292XzlmYTQ4KFwiMzY1NlwiKSwgJ1F1ZXJ5IGNhY2hlOiBJTlZBTElEQVRFJyksIHN0cnlNdXRBY3RfOWZhNDgoXCIzNjU3XCIpID8ge30gOiAoc3RyeUNvdl85ZmE0OChcIjM2NTdcIiksIHtcbiAgICAgICAgcGF0dGVyblxuICAgICAgfSkpO1xuICAgICAgcmV0dXJuIENhY2hlTWFuYWdlci5kZWxldGUocGF0dGVybik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEludmFsaWRhIG3Dumx0aXBsb3MgcGF0dGVybnNcbiAgICovXG4gIHN0YXRpYyBhc3luYyBpbnZhbGlkYXRlTXVsdGlwbGUocGF0dGVybnM6IHN0cmluZ1tdKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBpZiAoc3RyeU11dEFjdF85ZmE0OChcIjM2NThcIikpIHtcbiAgICAgIHt9XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0cnlDb3ZfOWZhNDgoXCIzNjU4XCIpO1xuICAgICAgbGV0IHRvdGFsID0gMDtcbiAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBwYXR0ZXJucykge1xuICAgICAgICBpZiAoc3RyeU11dEFjdF85ZmE0OChcIjM2NTlcIikpIHtcbiAgICAgICAgICB7fVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHN0cnlDb3ZfOWZhNDgoXCIzNjU5XCIpO1xuICAgICAgICAgIHN0cnlNdXRBY3RfOWZhNDgoXCIzNjYwXCIpID8gdG90YWwgLT0gYXdhaXQgdGhpcy5pbnZhbGlkYXRlKHBhdHRlcm4pIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjYwXCIpLCB0b3RhbCArPSBhd2FpdCB0aGlzLmludmFsaWRhdGUocGF0dGVybikpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdG90YWw7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFdyYXBwZXIgcGFyYSBxdWVyaWVzIGRlIGl0ZW5zXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgd2l0aEl0ZW1DYWNoZTxUPihzcWw6IHN0cmluZywgcGFyYW1zOiBhbnlbXSwgcXVlcnlGbjogKCkgPT4gUHJvbWlzZTxUPiwgdHRsPzogbnVtYmVyKTogUHJvbWlzZTxUPiB7XG4gICAgaWYgKHN0cnlNdXRBY3RfOWZhNDgoXCIzNjYxXCIpKSB7XG4gICAgICB7fVxuICAgIH0gZWxzZSB7XG4gICAgICBzdHJ5Q292XzlmYTQ4KFwiMzY2MVwiKTtcbiAgICAgIHJldHVybiB0aGlzLndpdGhDYWNoZShzcWwsIHBhcmFtcywgcXVlcnlGbiwgc3RyeU11dEFjdF85ZmE0OChcIjM2NjJcIikgPyB7fSA6IChzdHJ5Q292XzlmYTQ4KFwiMzY2MlwiKSwge1xuICAgICAgICB0dGw6IHN0cnlNdXRBY3RfOWZhNDgoXCIzNjY1XCIpID8gdHRsICYmIDYwMCA6IHN0cnlNdXRBY3RfOWZhNDgoXCIzNjY0XCIpID8gZmFsc2UgOiBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzY2M1wiKSA/IHRydWUgOiAoc3RyeUNvdl85ZmE0OChcIjM2NjNcIiwgXCIzNjY0XCIsIFwiMzY2NVwiKSwgdHRsIHx8IDYwMCksXG4gICAgICAgIC8vIDEwIG1pbnV0b3MgcGFyYSBpdGVuc1xuICAgICAgICBwcmVmaXg6IHN0cnlNdXRBY3RfOWZhNDgoXCIzNjY2XCIpID8gXCJcIiA6IChzdHJ5Q292XzlmYTQ4KFwiMzY2NlwiKSwgJ2l0ZW0nKVxuICAgICAgfSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBXcmFwcGVyIHBhcmEgcXVlcmllcyBkZSBlc3RhYmVsZWNpbWVudG9zXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgd2l0aEVzdGFiZWxlY2ltZW50b0NhY2hlPFQ+KHNxbDogc3RyaW5nLCBwYXJhbXM6IGFueVtdLCBxdWVyeUZuOiAoKSA9PiBQcm9taXNlPFQ+LCB0dGw/OiBudW1iZXIpOiBQcm9taXNlPFQ+IHtcbiAgICBpZiAoc3RyeU11dEFjdF85ZmE0OChcIjM2NjdcIikpIHtcbiAgICAgIHt9XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0cnlDb3ZfOWZhNDgoXCIzNjY3XCIpO1xuICAgICAgcmV0dXJuIHRoaXMud2l0aENhY2hlKHNxbCwgcGFyYW1zLCBxdWVyeUZuLCBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzY2OFwiKSA/IHt9IDogKHN0cnlDb3ZfOWZhNDgoXCIzNjY4XCIpLCB7XG4gICAgICAgIHR0bDogc3RyeU11dEFjdF85ZmE0OChcIjM2NzFcIikgPyB0dGwgJiYgOTAwIDogc3RyeU11dEFjdF85ZmE0OChcIjM2NzBcIikgPyBmYWxzZSA6IHN0cnlNdXRBY3RfOWZhNDgoXCIzNjY5XCIpID8gdHJ1ZSA6IChzdHJ5Q292XzlmYTQ4KFwiMzY2OVwiLCBcIjM2NzBcIiwgXCIzNjcxXCIpLCB0dGwgfHwgOTAwKSxcbiAgICAgICAgLy8gMTUgbWludXRvcyBwYXJhIGVzdGFiZWxlY2ltZW50b3NcbiAgICAgICAgcHJlZml4OiBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzY3MlwiKSA/IFwiXCIgOiAoc3RyeUNvdl85ZmE0OChcIjM2NzJcIiksICdlc3RhYmVsZWNpbWVudG8nKVxuICAgICAgfSkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBXcmFwcGVyIHBhcmEgcXVlcmllcyBkZSBoZWFsdGggY2hlY2sgKFRUTCBjdXJ0bylcbiAgICovXG4gIHN0YXRpYyBhc3luYyB3aXRoSGVhbHRoQ2FjaGU8VD4oc3FsOiBzdHJpbmcsIHBhcmFtczogYW55W10sIHF1ZXJ5Rm46ICgpID0+IFByb21pc2U8VD4pOiBQcm9taXNlPFQ+IHtcbiAgICBpZiAoc3RyeU11dEFjdF85ZmE0OChcIjM2NzNcIikpIHtcbiAgICAgIHt9XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0cnlDb3ZfOWZhNDgoXCIzNjczXCIpO1xuICAgICAgcmV0dXJuIHRoaXMud2l0aENhY2hlKHNxbCwgcGFyYW1zLCBxdWVyeUZuLCBzdHJ5TXV0QWN0XzlmYTQ4KFwiMzY3NFwiKSA/IHt9IDogKHN0cnlDb3ZfOWZhNDgoXCIzNjc0XCIpLCB7XG4gICAgICAgIHR0bDogMzAsXG4gICAgICAgIC8vIDMwIHNlZ3VuZG9zXG4gICAgICAgIHByZWZpeDogc3RyeU11dEFjdF85ZmE0OChcIjM2NzVcIikgPyBcIlwiIDogKHN0cnlDb3ZfOWZhNDgoXCIzNjc1XCIpLCAnaGVhbHRoJylcbiAgICAgIH0pKTtcbiAgICB9XG4gIH1cbn0iXSwidmVyc2lvbiI6M30=