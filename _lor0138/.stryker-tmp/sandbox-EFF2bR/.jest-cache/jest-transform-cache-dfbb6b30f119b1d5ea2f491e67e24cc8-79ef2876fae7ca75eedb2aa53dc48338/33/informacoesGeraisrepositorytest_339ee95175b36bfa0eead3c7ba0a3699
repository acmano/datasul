1958c99a6f260b22fa0824b099e891e7
"use strict";
// @ts-nocheck
// tests/unit/repositories/informacoesGerais.repository.test.ts
Object.defineProperty(exports, "__esModule", { value: true });
// Mock do DatabaseManager
jest.mock('@infrastructure/database/DatabaseManager');
// Mock do QueryCacheService
jest.mock('@shared/utils/cache/QueryCacheService');
const informacoesGerais_repository_1 = require("@api/lor0138/item/dadosCadastrais/informacoesGerais/repository/informacoesGerais.repository");
const DatabaseManager_1 = require("@infrastructure/database/DatabaseManager");
const QueryCacheService_1 = require("@shared/utils/cache/QueryCacheService");
const item_factory_1 = require("../../factories/item.factory");
describe('Repository - ItemInformacoesGeraisRepository', () => {
    beforeEach(() => {
        jest.clearAllMocks();
    });
    // ========================================
    // getItemMaster
    // ========================================
    describe('getItemMaster', () => {
        it('deve retornar dados do item quando encontrado', async () => {
            const mockResult = [(0, item_factory_1.createItemMasterQueryResult)()];
            // Mock do cache retornando o resultado da query
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue(mockResult);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            expect(result).toEqual(mockResult[0]);
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledTimes(1);
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledWith(expect.stringContaining('OPENQUERY'), expect.arrayContaining([
                expect.objectContaining({
                    name: 'paramItemCodigo',
                    value: '7530110'
                })
            ]));
        });
        it('deve retornar null quando item não encontrado', async () => {
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('INEXISTENTE');
            expect(result).toBeNull();
        });
        it('deve usar queries parametrizadas (proteção SQL Injection)', async () => {
            const maliciousCode = "'; DROP TABLE item;--";
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster(maliciousCode);
            // Verifica que usa parâmetros, não concatenação de string
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledWith(expect.any(String), expect.arrayContaining([
                expect.objectContaining({
                    name: 'paramItemCodigo',
                    value: maliciousCode
                })
            ]));
        });
        it('deve usar cache L1/L2', async () => {
            const mockResult = [(0, item_factory_1.createItemMasterQueryResult)()];
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue(mockResult);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            expect(QueryCacheService_1.QueryCacheService.withItemCache).toHaveBeenCalledTimes(1);
            expect(QueryCacheService_1.QueryCacheService.withItemCache).toHaveBeenCalledWith(expect.stringContaining('OPENQUERY'), expect.any(Array), expect.any(Function));
        });
        it('deve propagar erros do banco de dados', async () => {
            const dbError = new Error('Conexão perdida');
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockRejectedValue(dbError);
            await expect(informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110')).rejects.toThrow('Conexão perdida');
        });
        it('deve construir query OPENQUERY correta para Progress', async () => {
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            const [query] = DatabaseManager_1.DatabaseManager.queryEmpWithParams.mock.calls[0];
            // Valida estrutura da query
            expect(query).toContain('DECLARE @itemCodigo varchar(16)');
            expect(query).toContain('OPENQUERY(PRD_EMS2EMP');
            expect(query).toContain('pub.item');
            expect(query).toContain('it-codigo');
            expect(query).toContain('desc-item');
            expect(query).toContain('EXEC sp_executesql');
        });
    });
    // ========================================
    // getItemEstabelecimentos
    // ========================================
    describe('getItemEstabelecimentos', () => {
        it('deve retornar estabelecimentos do item', async () => {
            const mockResult = [
                (0, item_factory_1.createItemEstabQueryResult)(),
                (0, item_factory_1.createItemEstabQueryResult)({ estabCodigo: '02.01', estabNome: 'Fábrica' })
            ];
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue(mockResult);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            expect(result).toEqual(mockResult);
            expect(result).toHaveLength(2);
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledTimes(1);
        });
        it('deve retornar array vazio quando não há estabelecimentos', async () => {
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            expect(result).toEqual([]);
        });
        it('deve usar cache específico de estabelecimentos', async () => {
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            expect(QueryCacheService_1.QueryCacheService.withEstabelecimentoCache).toHaveBeenCalledTimes(1);
        });
        it('deve fazer JOIN com dois Linked Servers (EMP + MULT)', async () => {
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            const [query] = DatabaseManager_1.DatabaseManager.queryEmpWithParams.mock.calls[0];
            // Valida JOIN entre PRD_EMS2EMP e PRD_EMS2MULT
            expect(query).toContain('OPENQUERY(PRD_EMS2EMP');
            expect(query).toContain('OPENQUERY(PRD_EMS2MULT');
            expect(query).toContain('item-uni-estab');
            expect(query).toContain('estabelec');
            expect(query).toContain('LEFT JOIN');
        });
        it('deve usar parâmetros em ambas as queries OPENQUERY', async () => {
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledWith(expect.any(String), expect.arrayContaining([
                expect.objectContaining({ name: 'paramItemCodigo' })
            ]));
        });
        it('deve retornar campos corretos do resultado', async () => {
            const mockResult = [(0, item_factory_1.createItemEstabQueryResult)()];
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue(mockResult);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            expect(result[0]).toHaveProperty('itemCodigo');
            expect(result[0]).toHaveProperty('estabCodigo');
            expect(result[0]).toHaveProperty('estabNome');
            expect(result[0]).toHaveProperty('codObsoleto');
        });
    });
    // ========================================
    // invalidateCache
    // ========================================
    describe('invalidateCache', () => {
        it('deve invalidar cache de item e estabelecimento', async () => {
            QueryCacheService_1.QueryCacheService.invalidateMultiple.mockResolvedValue(undefined);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.invalidateCache('7530110');
            expect(QueryCacheService_1.QueryCacheService.invalidateMultiple).toHaveBeenCalledTimes(1);
            expect(QueryCacheService_1.QueryCacheService.invalidateMultiple).toHaveBeenCalledWith([
                'item:*',
                'estabelecimento:*'
            ]);
        });
        it('deve logar invalidação de cache', async () => {
            const consoleLogSpy = jest.spyOn(console, 'log').mockImplementation();
            QueryCacheService_1.QueryCacheService.invalidateMultiple.mockResolvedValue(undefined);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.invalidateCache('7530110');
            expect(consoleLogSpy).toHaveBeenCalledWith('Cache invalidado para item:', '7530110');
            consoleLogSpy.mockRestore();
        });
    });
    // ========================================
    // CENÁRIOS DE ERRO
    // ========================================
    describe('Tratamento de Erros', () => {
        it('deve tratar timeout do banco de dados', async () => {
            const timeoutError = new Error('Timeout: Request failed to complete');
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockRejectedValue(timeoutError);
            await expect(informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110')).rejects.toThrow('Timeout');
        });
        it('deve tratar erro de conexão perdida', async () => {
            const connectionError = new Error('ECONNREFUSED');
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockRejectedValue(connectionError);
            await expect(informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110')).rejects.toThrow('ECONNREFUSED');
        });
        it('deve tratar erro de sintaxe SQL', async () => {
            const sqlError = new Error('Incorrect syntax near');
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockRejectedValue(sqlError);
            await expect(informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110')).rejects.toThrow('Incorrect syntax');
        });
    });
    // ========================================
    // INTEGRAÇÃO COM CACHE
    // ========================================
    describe('Integração com Cache', () => {
        it('deve retornar dados do cache em cache hit', async () => {
            const cachedData = [(0, item_factory_1.createItemMasterQueryResult)()];
            // Mock cache retornando dados diretamente (cache hit)
            QueryCacheService_1.QueryCacheService.withItemCache.mockResolvedValue(cachedData);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            expect(result).toEqual(cachedData[0]);
            // Não deve chamar o banco em cache hit
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).not.toHaveBeenCalled();
        });
        it('deve buscar do banco em cache miss', async () => {
            const dbData = [(0, item_factory_1.createItemMasterQueryResult)()];
            // Mock cache executando a função (cache miss)
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue(dbData);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            expect(result).toEqual(dbData[0]);
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledTimes(1);
        });
        it('deve usar TTL diferente para item e estabelecimento', async () => {
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            // Verifica que usa caches diferentes
            expect(QueryCacheService_1.QueryCacheService.withItemCache).toHaveBeenCalledTimes(1);
            expect(QueryCacheService_1.QueryCacheService.withEstabelecimentoCache).toHaveBeenCalledTimes(1);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWFuby9wcm9qZXRvcy9kYXRhc3VsL2xvcjAxMzgvLnN0cnlrZXItdG1wL3NhbmRib3gtRUZGMmJSL3Rlc3RzL3VuaXQvcmVwb3NpdG9yaWVzL2luZm9ybWFjb2VzR2VyYWlzLnJlcG9zaXRvcnkudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUEsY0FBYztBQUNkLCtEQUErRDs7QUFVL0QsMEJBQTBCO0FBQzFCLElBQUksQ0FBQyxJQUFJLENBQUMsMENBQTBDLENBQUMsQ0FBQztBQUV0RCw0QkFBNEI7QUFDNUIsSUFBSSxDQUFDLElBQUksQ0FBQyx1Q0FBdUMsQ0FBQyxDQUFDO0FBWm5ELDhJQUE4STtBQUM5SSw4RUFBMkU7QUFDM0UsNkVBQTBFO0FBQzFFLCtEQUdzQztBQVF0QyxRQUFRLENBQUMsOENBQThDLEVBQUUsR0FBRyxFQUFFO0lBRTVELFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCwyQ0FBMkM7SUFDM0MsZ0JBQWdCO0lBQ2hCLDJDQUEyQztJQUMzQyxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsRUFBRTtRQUU3QixFQUFFLENBQUMsK0NBQStDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDN0QsTUFBTSxVQUFVLEdBQUcsQ0FBQyxJQUFBLDBDQUEyQixHQUFFLENBQUMsQ0FBQztZQUVuRCxnREFBZ0Q7WUFDL0MscUNBQWlCLENBQUMsYUFBMkIsQ0FBQyxrQkFBa0IsQ0FDL0QsS0FBSyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FDbEMsQ0FBQztZQUVELGlDQUFlLENBQUMsa0JBQWdDLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLENBQUM7WUFFaEYsTUFBTSxNQUFNLEdBQUcsTUFBTSw4REFBK0IsQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFOUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8s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LENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLGlDQUFlLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0RSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxxREFBcUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNsRSxxQ0FBaUIsQ0FBQyxhQUEyQixDQUFDLGtCQUFrQixDQUMvRCxLQUFLLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUNsQyxDQUFDO1lBRUQscUNBQWlCLENBQUMsd0JBQXNDLENBQUMsa0JBQWtCLENBQzFFLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQ2xDLENBQUM7WUFFRCxpQ0FBZSxDQUFDLGtCQUFnQyxDQUFDLGlCQUFpQixDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBRXhFLE1BQU0sOERBQStCLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQy9ELE1BQU0sOERBQStCLENBQUMsdUJBQXVCLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFekUscUNBQXFDO1lBQ3JDLE1BQU0sQ0FBQyxxQ0FBaUIsQ0FBQyxhQUFhLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNqRSxNQUFNLENBQUMscUNBQWlCLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM5RSxDQUFDLENBQUMsQ0FBQztJQUVMLENBQUMsQ0FBQyxDQUFDO0FBRUwsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvbWFuby9wcm9qZXRvcy9kYXRhc3VsL2xvcjAxMzgvLnN0cnlrZXItdG1wL3NhbmRib3gtRUZGMmJSL3Rlc3RzL3VuaXQvcmVwb3NpdG9yaWVzL2luZm9ybWFjb2VzR2VyYWlzLnJlcG9zaXRvcnkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAdHMtbm9jaGVja1xuLy8gdGVzdHMvdW5pdC9yZXBvc2l0b3JpZXMvaW5mb3JtYWNvZXNHZXJhaXMucmVwb3NpdG9yeS50ZXN0LnRzXG5cbmltcG9ydCB7IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkgfSBmcm9tICdAYXBpL2xvcjAxMzgvaXRlbS9kYWRvc0NhZGFzdHJhaXMvaW5mb3JtYWNvZXNHZXJhaXMvcmVwb3NpdG9yeS9pbmZvcm1hY29lc0dlcmFpcy5yZXBvc2l0b3J5JztcbmltcG9ydCB7IERhdGFiYXNlTWFuYWdlciB9IGZyb20gJ0BpbmZyYXN0cnVjdHVyZS9kYXRhYmFzZS9EYXRhYmFzZU1hbmFnZXInO1xuaW1wb3J0IHsgUXVlcnlDYWNoZVNlcnZpY2UgfSBmcm9tICdAc2hhcmVkL3V0aWxzL2NhY2hlL1F1ZXJ5Q2FjaGVTZXJ2aWNlJztcbmltcG9ydCB7IFxuICBjcmVhdGVJdGVtTWFzdGVyUXVlcnlSZXN1bHQsIFxuICBjcmVhdGVJdGVtRXN0YWJRdWVyeVJlc3VsdCBcbn0gZnJvbSAnLi4vLi4vZmFjdG9yaWVzL2l0ZW0uZmFjdG9yeSc7XG5cbi8vIE1vY2sgZG8gRGF0YWJhc2VNYW5hZ2VyXG5qZXN0Lm1vY2soJ0BpbmZyYXN0cnVjdHVyZS9kYXRhYmFzZS9EYXRhYmFzZU1hbmFnZXInKTtcblxuLy8gTW9jayBkbyBRdWVyeUNhY2hlU2VydmljZVxuamVzdC5tb2NrKCdAc2hhcmVkL3V0aWxzL2NhY2hlL1F1ZXJ5Q2FjaGVTZXJ2aWNlJyk7XG5cbmRlc2NyaWJlKCdSZXBvc2l0b3J5IC0gSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeScsICgpID0+IHtcbiAgXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIGdldEl0ZW1NYXN0ZXJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBkZXNjcmliZSgnZ2V0SXRlbU1hc3RlcicsICgpID0+IHtcbiAgICBcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBkYWRvcyBkbyBpdGVtIHF1YW5kbyBlbmNvbnRyYWRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Jlc3VsdCA9IFtjcmVhdGVJdGVtTWFzdGVyUXVlcnlSZXN1bHQoKV07XG4gICAgICBcbiAgICAgIC8vIE1vY2sgZG8gY2FjaGUgcmV0b3JuYW5kbyBvIHJlc3VsdGFkbyBkYSBxdWVyeVxuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVzdWx0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtTWFzdGVyKCc3NTMwMTEwJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Jlc3VsdFswXSk7XG4gICAgICBleHBlY3QoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnT1BFTlFVRVJZJyksXG4gICAgICAgIGV4cGVjdC5hcnJheUNvbnRhaW5pbmcoW1xuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgXG4gICAgICAgICAgICBuYW1lOiAncGFyYW1JdGVtQ29kaWdvJywgXG4gICAgICAgICAgICB2YWx1ZTogJzc1MzAxMTAnIFxuICAgICAgICAgIH0pXG4gICAgICAgIF0pXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgbnVsbCBxdWFuZG8gaXRlbSBuw6NvIGVuY29udHJhZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEl0ZW1DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtTWFzdGVyKCdJTkVYSVNURU5URScpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgdXNhciBxdWVyaWVzIHBhcmFtZXRyaXphZGFzIChwcm90ZcOnw6NvIFNRTCBJbmplY3Rpb24pJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWFsaWNpb3VzQ29kZSA9IFwiJzsgRFJPUCBUQUJMRSBpdGVtOy0tXCI7XG4gICAgICBcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoSXRlbUNhY2hlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICBhc3luYyAocXVlcnksIHBhcmFtcywgZm4pID0+IGZuKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBhd2FpdCBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1NYXN0ZXIobWFsaWNpb3VzQ29kZSk7XG5cbiAgICAgIC8vIFZlcmlmaWNhIHF1ZSB1c2EgcGFyw6JtZXRyb3MsIG7Do28gY29uY2F0ZW5hw6fDo28gZGUgc3RyaW5nXG4gICAgICBleHBlY3QoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5hbnkoU3RyaW5nKSxcbiAgICAgICAgZXhwZWN0LmFycmF5Q29udGFpbmluZyhbXG4gICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBcbiAgICAgICAgICAgIG5hbWU6ICdwYXJhbUl0ZW1Db2RpZ28nLCBcbiAgICAgICAgICAgIHZhbHVlOiBtYWxpY2lvdXNDb2RlIFxuICAgICAgICAgIH0pXG4gICAgICAgIF0pXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgdXNhciBjYWNoZSBMMS9MMicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tSZXN1bHQgPSBbY3JlYXRlSXRlbU1hc3RlclF1ZXJ5UmVzdWx0KCldO1xuICAgICAgXG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEl0ZW1DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZXN1bHQpO1xuXG4gICAgICBhd2FpdCBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1NYXN0ZXIoJzc1MzAxMTAnKTtcblxuICAgICAgZXhwZWN0KFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICAgIGV4cGVjdChRdWVyeUNhY2hlU2VydmljZS53aXRoSXRlbUNhY2hlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ09QRU5RVUVSWScpLFxuICAgICAgICBleHBlY3QuYW55KEFycmF5KSxcbiAgICAgICAgZXhwZWN0LmFueShGdW5jdGlvbilcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBwcm9wYWdhciBlcnJvcyBkbyBiYW5jbyBkZSBkYWRvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRiRXJyb3IgPSBuZXcgRXJyb3IoJ0NvbmV4w6NvIHBlcmRpZGEnKTtcbiAgICAgIFxuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShkYkVycm9yKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1NYXN0ZXIoJzc1MzAxMTAnKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0NvbmV4w6NvIHBlcmRpZGEnKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGNvbnN0cnVpciBxdWVyeSBPUEVOUVVFUlkgY29ycmV0YSBwYXJhIFByb2dyZXNzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbU1hc3RlcignNzUzMDExMCcpO1xuXG4gICAgICBjb25zdCBbcXVlcnldID0gKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrLmNhbGxzWzBdO1xuICAgICAgXG4gICAgICAvLyBWYWxpZGEgZXN0cnV0dXJhIGRhIHF1ZXJ5XG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbignREVDTEFSRSBAaXRlbUNvZGlnbyB2YXJjaGFyKDE2KScpO1xuICAgICAgZXhwZWN0KHF1ZXJ5KS50b0NvbnRhaW4oJ09QRU5RVUVSWShQUkRfRU1TMkVNUCcpO1xuICAgICAgZXhwZWN0KHF1ZXJ5KS50b0NvbnRhaW4oJ3B1Yi5pdGVtJyk7XG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbignaXQtY29kaWdvJyk7XG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbignZGVzYy1pdGVtJyk7XG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbignRVhFQyBzcF9leGVjdXRlc3FsJyk7XG4gICAgfSk7XG5cbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBnZXRJdGVtRXN0YWJlbGVjaW1lbnRvc1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdnZXRJdGVtRXN0YWJlbGVjaW1lbnRvcycsICgpID0+IHtcbiAgICBcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBlc3RhYmVsZWNpbWVudG9zIGRvIGl0ZW0nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUmVzdWx0ID0gW1xuICAgICAgICBjcmVhdGVJdGVtRXN0YWJRdWVyeVJlc3VsdCgpLFxuICAgICAgICBjcmVhdGVJdGVtRXN0YWJRdWVyeVJlc3VsdCh7IGVzdGFiQ29kaWdvOiAnMDIuMDEnLCBlc3RhYk5vbWU6ICdGw6FicmljYScgfSlcbiAgICAgIF07XG4gICAgICBcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoRXN0YWJlbGVjaW1lbnRvQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVzdWx0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtRXN0YWJlbGVjaW1lbnRvcygnNzUzMDExMCcpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tSZXN1bHQpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgZXhwZWN0KERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGFycmF5IHZhemlvIHF1YW5kbyBuw6NvIGjDoSBlc3RhYmVsZWNpbWVudG9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhFc3RhYmVsZWNpbWVudG9DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtRXN0YWJlbGVjaW1lbnRvcygnNzUzMDExMCcpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtdKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHVzYXIgY2FjaGUgZXNwZWPDrWZpY28gZGUgZXN0YWJlbGVjaW1lbnRvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoRXN0YWJlbGVjaW1lbnRvQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbUVzdGFiZWxlY2ltZW50b3MoJzc1MzAxMTAnKTtcblxuICAgICAgZXhwZWN0KFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhFc3RhYmVsZWNpbWVudG9DYWNoZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgZmF6ZXIgSk9JTiBjb20gZG9pcyBMaW5rZWQgU2VydmVycyAoRU1QICsgTVVMVCknLCBhc3luYyAoKSA9PiB7XG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEVzdGFiZWxlY2ltZW50b0NhY2hlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICBhc3luYyAocXVlcnksIHBhcmFtcywgZm4pID0+IGZuKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBhd2FpdCBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1Fc3RhYmVsZWNpbWVudG9zKCc3NTMwMTEwJyk7XG5cbiAgICAgIGNvbnN0IFtxdWVyeV0gPSAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2suY2FsbHNbMF07XG4gICAgICBcbiAgICAgIC8vIFZhbGlkYSBKT0lOIGVudHJlIFBSRF9FTVMyRU1QIGUgUFJEX0VNUzJNVUxUXG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbignT1BFTlFVRVJZKFBSRF9FTVMyRU1QJyk7XG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbignT1BFTlFVRVJZKFBSRF9FTVMyTVVMVCcpO1xuICAgICAgZXhwZWN0KHF1ZXJ5KS50b0NvbnRhaW4oJ2l0ZW0tdW5pLWVzdGFiJyk7XG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbignZXN0YWJlbGVjJyk7XG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbignTEVGVCBKT0lOJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSB1c2FyIHBhcsOibWV0cm9zIGVtIGFtYmFzIGFzIHF1ZXJpZXMgT1BFTlFVRVJZJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhFc3RhYmVsZWNpbWVudG9DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtRXN0YWJlbGVjaW1lbnRvcygnNzUzMDExMCcpO1xuXG4gICAgICBleHBlY3QoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5hbnkoU3RyaW5nKSxcbiAgICAgICAgZXhwZWN0LmFycmF5Q29udGFpbmluZyhbXG4gICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBuYW1lOiAncGFyYW1JdGVtQ29kaWdvJyB9KVxuICAgICAgICBdKVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGNhbXBvcyBjb3JyZXRvcyBkbyByZXN1bHRhZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUmVzdWx0ID0gW2NyZWF0ZUl0ZW1Fc3RhYlF1ZXJ5UmVzdWx0KCldO1xuICAgICAgXG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEVzdGFiZWxlY2ltZW50b0NhY2hlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICBhc3luYyAocXVlcnksIHBhcmFtcywgZm4pID0+IGZuKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jlc3VsdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbUVzdGFiZWxlY2ltZW50b3MoJzc1MzAxMTAnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdFswXSkudG9IYXZlUHJvcGVydHkoJ2l0ZW1Db2RpZ28nKTtcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0pLnRvSGF2ZVByb3BlcnR5KCdlc3RhYkNvZGlnbycpO1xuICAgICAgZXhwZWN0KHJlc3VsdFswXSkudG9IYXZlUHJvcGVydHkoJ2VzdGFiTm9tZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdFswXSkudG9IYXZlUHJvcGVydHkoJ2NvZE9ic29sZXRvJyk7XG4gICAgfSk7XG5cbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBpbnZhbGlkYXRlQ2FjaGVcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBkZXNjcmliZSgnaW52YWxpZGF0ZUNhY2hlJywgKCkgPT4ge1xuICAgIFxuICAgIGl0KCdkZXZlIGludmFsaWRhciBjYWNoZSBkZSBpdGVtIGUgZXN0YWJlbGVjaW1lbnRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLmludmFsaWRhdGVNdWx0aXBsZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgIGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuaW52YWxpZGF0ZUNhY2hlKCc3NTMwMTEwJyk7XG5cbiAgICAgIGV4cGVjdChRdWVyeUNhY2hlU2VydmljZS5pbnZhbGlkYXRlTXVsdGlwbGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICAgIGV4cGVjdChRdWVyeUNhY2hlU2VydmljZS5pbnZhbGlkYXRlTXVsdGlwbGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFtcbiAgICAgICAgJ2l0ZW06KicsXG4gICAgICAgICdlc3RhYmVsZWNpbWVudG86KidcbiAgICAgIF0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgbG9nYXIgaW52YWxpZGHDp8OjbyBkZSBjYWNoZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnNvbGVMb2dTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdsb2cnKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICAgIFxuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLmludmFsaWRhdGVNdWx0aXBsZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgIGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuaW52YWxpZGF0ZUNhY2hlKCc3NTMwMTEwJyk7XG5cbiAgICAgIGV4cGVjdChjb25zb2xlTG9nU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ0NhY2hlIGludmFsaWRhZG8gcGFyYSBpdGVtOicsXG4gICAgICAgICc3NTMwMTEwJ1xuICAgICAgKTtcblxuICAgICAgY29uc29sZUxvZ1NweS5tb2NrUmVzdG9yZSgpO1xuICAgIH0pO1xuXG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gQ0VOw4FSSU9TIERFIEVSUk9cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBkZXNjcmliZSgnVHJhdGFtZW50byBkZSBFcnJvcycsICgpID0+IHtcbiAgICBcbiAgICBpdCgnZGV2ZSB0cmF0YXIgdGltZW91dCBkbyBiYW5jbyBkZSBkYWRvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRpbWVvdXRFcnJvciA9IG5ldyBFcnJvcignVGltZW91dDogUmVxdWVzdCBmYWlsZWQgdG8gY29tcGxldGUnKTtcbiAgICAgIFxuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZSh0aW1lb3V0RXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbU1hc3RlcignNzUzMDExMCcpXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnVGltZW91dCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgdHJhdGFyIGVycm8gZGUgY29uZXjDo28gcGVyZGlkYScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbm5lY3Rpb25FcnJvciA9IG5ldyBFcnJvcignRUNPTk5SRUZVU0VEJyk7XG4gICAgICBcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoRXN0YWJlbGVjaW1lbnRvQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShjb25uZWN0aW9uRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbUVzdGFiZWxlY2ltZW50b3MoJzc1MzAxMTAnKVxuICAgICAgKS5yZWplY3RzLnRvVGhyb3coJ0VDT05OUkVGVVNFRCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgdHJhdGFyIGVycm8gZGUgc2ludGF4ZSBTUUwnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzcWxFcnJvciA9IG5ldyBFcnJvcignSW5jb3JyZWN0IHN5bnRheCBuZWFyJyk7XG4gICAgICBcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoSXRlbUNhY2hlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICBhc3luYyAocXVlcnksIHBhcmFtcywgZm4pID0+IGZuKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1JlamVjdGVkVmFsdWUoc3FsRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbU1hc3RlcignNzUzMDExMCcpXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnSW5jb3JyZWN0IHN5bnRheCcpO1xuICAgIH0pO1xuXG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gSU5URUdSQcOHw4NPIENPTSBDQUNIRVxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdJbnRlZ3Jhw6fDo28gY29tIENhY2hlJywgKCkgPT4ge1xuICAgIFxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGRhZG9zIGRvIGNhY2hlIGVtIGNhY2hlIGhpdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNhY2hlZERhdGEgPSBbY3JlYXRlSXRlbU1hc3RlclF1ZXJ5UmVzdWx0KCldO1xuICAgICAgXG4gICAgICAvLyBNb2NrIGNhY2hlIHJldG9ybmFuZG8gZGFkb3MgZGlyZXRhbWVudGUgKGNhY2hlIGhpdClcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoSXRlbUNhY2hlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoY2FjaGVkRGF0YSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbU1hc3RlcignNzUzMDExMCcpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGNhY2hlZERhdGFbMF0pO1xuICAgICAgLy8gTsOjbyBkZXZlIGNoYW1hciBvIGJhbmNvIGVtIGNhY2hlIGhpdFxuICAgICAgZXhwZWN0KERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBidXNjYXIgZG8gYmFuY28gZW0gY2FjaGUgbWlzcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRiRGF0YSA9IFtjcmVhdGVJdGVtTWFzdGVyUXVlcnlSZXN1bHQoKV07XG4gICAgICBcbiAgICAgIC8vIE1vY2sgY2FjaGUgZXhlY3V0YW5kbyBhIGZ1bsOnw6NvIChjYWNoZSBtaXNzKVxuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShkYkRhdGEpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1NYXN0ZXIoJzc1MzAxMTAnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChkYkRhdGFbMF0pO1xuICAgICAgZXhwZWN0KERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHVzYXIgVFRMIGRpZmVyZW50ZSBwYXJhIGl0ZW0gZSBlc3RhYmVsZWNpbWVudG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEl0ZW1DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEVzdGFiZWxlY2ltZW50b0NhY2hlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICBhc3luYyAocXVlcnksIHBhcmFtcywgZm4pID0+IGZuKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBhd2FpdCBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1NYXN0ZXIoJzc1MzAxMTAnKTtcbiAgICAgIGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbUVzdGFiZWxlY2ltZW50b3MoJzc1MzAxMTAnKTtcblxuICAgICAgLy8gVmVyaWZpY2EgcXVlIHVzYSBjYWNoZXMgZGlmZXJlbnRlc1xuICAgICAgZXhwZWN0KFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICAgIGV4cGVjdChRdWVyeUNhY2hlU2VydmljZS53aXRoRXN0YWJlbGVjaW1lbnRvQ2FjaGUpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICB9KTtcblxufSk7Il0sInZlcnNpb24iOjN9