7278427483e8bb8c556efb01748772c3
"use strict";
// tests/integration/api/informacoesGerais.integration.test.ts
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const supertest_1 = __importDefault(require("supertest"));
const database_helper_1 = require("../../helpers/database.helper");
const app_1 = __importDefault(require("../../../src/app"));
/**
 * TESTES DE INTEGRA√á√ÉO COM BANCO REAL
 *
 * Estes testes conectam no banco de produ√ß√£o (somente leitura)
 * Se o banco n√£o estiver dispon√≠vel, usam MOCK automaticamente
 */
describe('INTEGRA√á√ÉO - API InformacoesGerais (Banco Real)', () => {
    let usingRealDatabase = false;
    let testItemCode;
    // ========================================
    // SETUP
    // ========================================
    beforeAll(async () => {
        await database_helper_1.DatabaseTestHelper.initialize();
        usingRealDatabase = database_helper_1.DatabaseTestHelper.isUsingRealDatabase();
        // Buscar c√≥digo de item real para testes
        testItemCode = await database_helper_1.DatabaseTestHelper.getTestItemCode();
        console.log(`üîó Banco: ${usingRealDatabase ? 'REAL' : 'MOCK'}`);
        console.log(`üì¶ Item de teste: ${testItemCode}`);
    });
    afterAll(async () => {
        await database_helper_1.DatabaseTestHelper.cleanup();
    });
    // ========================================
    // TESTE 1: CONEX√ÉO COM BANCO
    // ========================================
    describe('Conex√£o com Banco de Dados', () => {
        it('deve conectar com banco ou usar mock', async () => {
            const isReady = await database_helper_1.DatabaseTestHelper.waitUntilReady(5000);
            expect(isReady).toBe(true);
        });
        it('deve reportar status correto no health check', async () => {
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/health')
                .expect((res) => {
                expect([200, 503]).toContain(res.status);
            });
            expect(response.body).toHaveProperty('database');
            expect(response.body.database).toHaveProperty('connected');
            if (usingRealDatabase) {
                expect(response.body.database.connected).toBe(true);
                expect(response.body.database.type).toBe('sqlserver');
            }
        });
    });
    // ========================================
    // TESTE 2: BUSCAR ITEM REAL
    // ========================================
    describe('Buscar Informa√ß√µes Gerais (Dados Reais)', () => {
        it('deve buscar item existente com sucesso', async () => {
            const startTime = Date.now();
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${testItemCode}`)
                .expect(200);
            const duration = Date.now() - startTime;
            // Valida√ß√µes b√°sicas
            expect(response.body).toHaveProperty('success', true);
            expect(response.body).toHaveProperty('data');
            // Se banco real, validar dados
            if (usingRealDatabase) {
                expect(response.body.data).toHaveProperty('identificacaoItemCodigo');
                expect(response.body.data.identificacaoItemCodigo).toBe(testItemCode);
                expect(response.body.data).toHaveProperty('identificacaoItemDescricao');
                expect(response.body.data).toHaveProperty('identificacaoItemUnidade');
                // Validar performance (banco real deve responder r√°pido)
                expect(duration).toRespondWithin(5000); // max 5s
            }
        });
        it('deve retornar 404 para item inexistente', async () => {
            const invalidCode = 'INVALID999';
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${invalidCode}`)
                .expect(404);
            expect(response.body).toHaveProperty('error');
            expect(response.body.message).toMatch(/n√£o encontrado/i);
        });
    });
    // ========================================
    // TESTE 3: VALIDA√á√ÉO COM DADOS REAIS
    // ========================================
    describe('Valida√ß√£o de Dados do Banco', () => {
        it('deve retornar estrutura de dados correta', async () => {
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${testItemCode}`)
                .expect(200);
            const { data } = response.body;
            // Estrutura esperada (baseada na resposta real da API)
            expect(data).toHaveProperty('identificacaoItemCodigo');
            expect(data).toHaveProperty('identificacaoItemDescricao');
            expect(data).toHaveProperty('identificacaoItemUnidade');
            expect(data).toHaveProperty('identificacaoItensEstabelecimentos');
            // Item deve ter campos obrigat√≥rios com valores corretos
            expect(data.identificacaoItemCodigo).toBe(testItemCode);
            expect(typeof data.identificacaoItemDescricao).toBe('string');
            expect(typeof data.identificacaoItemUnidade).toBe('string');
            // Estabelecimentos deve ser array
            expect(Array.isArray(data.identificacaoItensEstabelecimentos)).toBe(true);
        });
        it('campos do item devem ter tipos corretos', async () => {
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${testItemCode}`)
                .expect(200);
            const data = response.body.data;
            expect(typeof data.identificacaoItemCodigo).toBe('string');
            expect(typeof data.identificacaoItemDescricao).toBe('string');
            expect(typeof data.identificacaoItemUnidade).toBe('string');
            // Validar array de estabelecimentos
            expect(Array.isArray(data.identificacaoItensEstabelecimentos)).toBe(true);
        });
    });
    // ========================================
    // TESTE 4: PERFORMANCE COM BANCO REAL
    // ========================================
    describe('Performance (Banco Real)', () => {
        it('deve responder em menos de 3 segundos', async function () {
            // Pular se n√£o for banco real
            if (!usingRealDatabase) {
                console.log('‚è≠Ô∏è  Teste de performance pulado - usando mock');
                return;
            }
            const startTime = Date.now();
            await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${testItemCode}`)
                .expect(200);
            const duration = Date.now() - startTime;
            expect(duration).toBeLessThan(3000);
        });
        it('deve manter performance consistente em m√∫ltiplas requisi√ß√µes', async function () {
            if (!usingRealDatabase) {
                console.log('‚è≠Ô∏è  Teste de performance pulado - usando mock');
                return;
            }
            const durations = [];
            const iterations = 5;
            for (let i = 0; i < iterations; i++) {
                const start = Date.now();
                await (0, supertest_1.default)(app_1.default)
                    .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${testItemCode}`)
                    .expect(200);
                durations.push(Date.now() - start);
            }
            const avgDuration = durations.reduce((a, b) => a + b, 0) / durations.length;
            console.log(`üìä M√©dia de ${iterations} requisi√ß√µes: ${avgDuration.toFixed(0)}ms`);
            expect(avgDuration).toBeLessThan(3000);
        });
    });
    // ========================================
    // TESTE 5: EDGE CASES COM BANCO REAL
    // ========================================
    describe('Edge Cases (Banco Real)', () => {
        it('deve buscar item com c√≥digo alfanum√©rico', async () => {
            // Usar c√≥digo conhecido ou pular se n√£o houver
            const codes = database_helper_1.DatabaseTestHelper.getKnownTestCodes();
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${codes.validItem}`)
                .expect((res) => {
                // Aceita 200 (encontrado) ou 404 (n√£o encontrado, mas validou)
                expect([200, 404]).toContain(res.status);
            });
            if (response.status === 200) {
                expect(response.body.success).toBe(true);
            }
        });
        it('deve validar c√≥digo com 16 caracteres (m√°ximo)', async () => {
            const maxCode = '1234567890123456';
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${maxCode}`)
                .expect((res) => {
                expect([200, 404]).toContain(res.status);
            });
            // N√£o deve dar erro de valida√ß√£o (400)
            expect(response.status).not.toBe(400);
        });
        it('deve rejeitar c√≥digo com 17 caracteres', async () => {
            const tooLongCode = '12345678901234567'; // 17 chars
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${tooLongCode}`)
                .expect(400);
            expect(response.body).toHaveProperty('error');
        });
    });
    // ========================================
    // TESTE 6: ESTABELECIMENTOS (se dispon√≠vel)
    // ========================================
    describe('Estabelecimentos do Item', () => {
        it('deve retornar estabelecimentos se existirem', async () => {
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${testItemCode}`)
                .expect(200);
            const { identificacaoItensEstabelecimentos } = response.body.data;
            expect(Array.isArray(identificacaoItensEstabelecimentos)).toBe(true);
            // Se houver estabelecimentos, validar estrutura
            if (identificacaoItensEstabelecimentos && identificacaoItensEstabelecimentos.length > 0) {
                const estab = identificacaoItensEstabelecimentos[0];
                expect(estab).toHaveProperty('estabCodigo');
                expect(typeof estab.estabCodigo).toBe('string');
                expect(estab).toHaveProperty('itemCodigo');
            }
        });
    });
    // ========================================
    // TESTE 7: CORRELATION ID E HEADERS
    // ========================================
    describe('Headers e Correlation ID', () => {
        it('deve incluir Correlation ID na resposta', async () => {
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${testItemCode}`);
            expect(response.headers['x-correlation-id']).toBeDefined();
        });
        it('deve aceitar Correlation ID customizado', async () => {
            const customId = 'integration-test-123';
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${testItemCode}`)
                .set('X-Correlation-ID', customId);
            expect(response.headers['x-correlation-id']).toBe(customId);
        });
    });
    // ========================================
    // TESTE 8: TIMEOUT E RESIL√äNCIA
    // ========================================
    describe('Timeout e Resil√™ncia', () => {
        it('n√£o deve travar em requisi√ß√£o inv√°lida', async () => {
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/INVALID')
                .timeout(5000); // 5s max
            expect(response.status).toBeDefined();
            expect([200, 404, 400]).toContain(response.status);
        });
    });
    // ========================================
    // TESTE 9: COMPARA√á√ÉO MOCK vs REAL
    // ========================================
    describe('Compara√ß√£o Mock vs Real', () => {
        it('deve informar qual fonte de dados est√° sendo usada', () => {
            console.log(`
        üìä RESULTADO DOS TESTES:
        - Fonte de dados: ${usingRealDatabase ? 'BANCO REAL' : 'MOCK'}
        - C√≥digo testado: ${testItemCode}
        - Ambiente: ${process.env.NODE_ENV}
      `);
            expect(usingRealDatabase).toBeDefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWFuby9wcm9qZXRvcy9kYXRhc3VsL2xvcjAxMzgvdGVzdHMvaW50ZWdyYXRpb24vYXBpL2luZm9ybWFjb2VzR2VyYWlzLmludGVncmF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBLDhEQUE4RDs7Ozs7QUFFOUQsMERBQWdDO0FBQ2hDLG1FQUFtRTtBQUNuRSwyREFBbUM7QUFFbkM7Ozs7O0dBS0c7QUFFSCxRQUFRLENBQUMsaURBQWlELEVBQUUsR0FBRyxFQUFFO0lBRS9ELElBQUksaUJBQWlCLEdBQUcsS0FBSyxDQUFDO0lBQzlCLElBQUksWUFBb0IsQ0FBQztJQUV6QiwyQ0FBMkM7SUFDM0MsUUFBUTtJQUNSLDJDQUEyQztJQUMzQyxTQUFTLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDbkIsTUFBTSxvQ0FBa0IsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUN0QyxpQkFBaUIsR0FBRyxvQ0FBa0IsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1FBRTdELHlDQUF5QztRQUN6QyxZQUFZLEdBQUcsTUFBTSxvQ0FBa0IsQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUUxRCxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUNoRSxPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixZQUFZLEVBQUUsQ0FBQyxDQUFDO0lBQ25ELENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ2xCLE1BQU0sb0NBQWtCLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDckMsQ0FBQyxDQUFDLENBQUM7SUFFSCwyQ0FBMkM7SUFDM0MsNkJBQTZCO0lBQzdCLDJDQUEyQztJQUMzQyxRQUFRLENBQUMsNEJBQTRCLEVBQUUsR0FBRyxFQUFFO1FBRTFDLEVBQUUsQ0FBQyxzQ0FBc0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNwRCxNQUFNLE9BQU8sR0FBRyxNQUFNLG9DQUFr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QUEyQztJQUMzQyxRQUFRLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO1FBRXZDLEVBQUUsQ0FBQyxvREFBb0QsRUFBRSxHQUFHLEVBQUU7WUFDNUQsT0FBTyxDQUFDLEdBQUcsQ0FBQzs7NEJBRVUsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsTUFBTTs0QkFDekMsWUFBWTtzQkFDbEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRO09BQ25DLENBQUMsQ0FBQztZQUVILE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzFDLENBQUMsQ0FBQyxDQUFDO0lBRUwsQ0FBQyxDQUFDLENBQUM7QUFFTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9tYW5vL3Byb2pldG9zL2RhdGFzdWwvbG9yMDEzOC90ZXN0cy9pbnRlZ3JhdGlvbi9hcGkvaW5mb3JtYWNvZXNHZXJhaXMuaW50ZWdyYXRpb24udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0ZXN0cy9pbnRlZ3JhdGlvbi9hcGkvaW5mb3JtYWNvZXNHZXJhaXMuaW50ZWdyYXRpb24udGVzdC50c1xuXG5pbXBvcnQgcmVxdWVzdCBmcm9tICdzdXBlcnRlc3QnO1xuaW1wb3J0IHsgRGF0YWJhc2VUZXN0SGVscGVyIH0gZnJvbSAnLi4vLi4vaGVscGVycy9kYXRhYmFzZS5oZWxwZXInO1xuaW1wb3J0IGFwcCBmcm9tICcuLi8uLi8uLi9zcmMvYXBwJztcblxuLyoqXG4gKiBURVNURVMgREUgSU5URUdSQcOHw4NPIENPTSBCQU5DTyBSRUFMXG4gKiBcbiAqIEVzdGVzIHRlc3RlcyBjb25lY3RhbSBubyBiYW5jbyBkZSBwcm9kdcOnw6NvIChzb21lbnRlIGxlaXR1cmEpXG4gKiBTZSBvIGJhbmNvIG7Do28gZXN0aXZlciBkaXNwb27DrXZlbCwgdXNhbSBNT0NLIGF1dG9tYXRpY2FtZW50ZVxuICovXG5cbmRlc2NyaWJlKCdJTlRFR1JBw4fDg08gLSBBUEkgSW5mb3JtYWNvZXNHZXJhaXMgKEJhbmNvIFJlYWwpJywgKCkgPT4ge1xuICBcbiAgbGV0IHVzaW5nUmVhbERhdGFiYXNlID0gZmFsc2U7XG4gIGxldCB0ZXN0SXRlbUNvZGU6IHN0cmluZztcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFNFVFVQXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBEYXRhYmFzZVRlc3RIZWxwZXIuaW5pdGlhbGl6ZSgpO1xuICAgIHVzaW5nUmVhbERhdGFiYXNlID0gRGF0YWJhc2VUZXN0SGVscGVyLmlzVXNpbmdSZWFsRGF0YWJhc2UoKTtcbiAgICBcbiAgICAvLyBCdXNjYXIgY8OzZGlnbyBkZSBpdGVtIHJlYWwgcGFyYSB0ZXN0ZXNcbiAgICB0ZXN0SXRlbUNvZGUgPSBhd2FpdCBEYXRhYmFzZVRlc3RIZWxwZXIuZ2V0VGVzdEl0ZW1Db2RlKCk7XG4gICAgXG4gICAgY29uc29sZS5sb2coYPCflJcgQmFuY286ICR7dXNpbmdSZWFsRGF0YWJhc2UgPyAnUkVBTCcgOiAnTU9DSyd9YCk7XG4gICAgY29uc29sZS5sb2coYPCfk6YgSXRlbSBkZSB0ZXN0ZTogJHt0ZXN0SXRlbUNvZGV9YCk7XG4gIH0pO1xuXG4gIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBEYXRhYmFzZVRlc3RIZWxwZXIuY2xlYW51cCgpO1xuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFRFU1RFIDE6IENPTkVYw4NPIENPTSBCQU5DT1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdDb25leMOjbyBjb20gQmFuY28gZGUgRGFkb3MnLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ2RldmUgY29uZWN0YXIgY29tIGJhbmNvIG91IHVzYXIgbW9jaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGlzUmVhZHkgPSBhd2FpdCBEYXRhYmFzZVRlc3RIZWxwZXIud2FpdFVudGlsUmVhZHkoNTAwMCk7XG4gICAgICBleHBlY3QoaXNSZWFkeSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJlcG9ydGFyIHN0YXR1cyBjb3JyZXRvIG5vIGhlYWx0aCBjaGVjaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9oZWFsdGgnKVxuICAgICAgICAuZXhwZWN0KChyZXMpID0+IHtcbiAgICAgICAgICBleHBlY3QoWzIwMCwgNTAzXSkudG9Db250YWluKHJlcy5zdGF0dXMpO1xuICAgICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdkYXRhYmFzZScpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YWJhc2UpLnRvSGF2ZVByb3BlcnR5KCdjb25uZWN0ZWQnKTtcbiAgICAgIFxuICAgICAgaWYgKHVzaW5nUmVhbERhdGFiYXNlKSB7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGFiYXNlLmNvbm5lY3RlZCkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YWJhc2UudHlwZSkudG9CZSgnc3Fsc2VydmVyJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBURVNURSAyOiBCVVNDQVIgSVRFTSBSRUFMXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ0J1c2NhciBJbmZvcm1hw6fDtWVzIEdlcmFpcyAoRGFkb3MgUmVhaXMpJywgKCkgPT4ge1xuICAgIFxuICAgIGl0KCdkZXZlIGJ1c2NhciBpdGVtIGV4aXN0ZW50ZSBjb20gc3VjZXNzbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8ke3Rlc3RJdGVtQ29kZX1gKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgLy8gVmFsaWRhw6fDtWVzIGLDoXNpY2FzXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3N1Y2Nlc3MnLCB0cnVlKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnZGF0YScpO1xuICAgICAgXG4gICAgICAvLyBTZSBiYW5jbyByZWFsLCB2YWxpZGFyIGRhZG9zXG4gICAgICBpZiAodXNpbmdSZWFsRGF0YWJhc2UpIHtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YSkudG9IYXZlUHJvcGVydHkoJ2lkZW50aWZpY2FjYW9JdGVtQ29kaWdvJyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEuaWRlbnRpZmljYWNhb0l0ZW1Db2RpZ28pLnRvQmUodGVzdEl0ZW1Db2RlKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZGF0YSkudG9IYXZlUHJvcGVydHkoJ2lkZW50aWZpY2FjYW9JdGVtRGVzY3JpY2FvJyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmRhdGEpLnRvSGF2ZVByb3BlcnR5KCdpZGVudGlmaWNhY2FvSXRlbVVuaWRhZGUnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFZhbGlkYXIgcGVyZm9ybWFuY2UgKGJhbmNvIHJlYWwgZGV2ZSByZXNwb25kZXIgcsOhcGlkbylcbiAgICAgICAgZXhwZWN0KGR1cmF0aW9uKS50b1Jlc3BvbmRXaXRoaW4oNTAwMCk7IC8vIG1heCA1c1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgNDA0IHBhcmEgaXRlbSBpbmV4aXN0ZW50ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRDb2RlID0gJ0lOVkFMSUQ5OTknO1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KGAvYXBpL2xvcjAxMzgvaXRlbS9kYWRvc0NhZGFzdHJhaXMvaW5mb3JtYWNvZXNHZXJhaXMvJHtpbnZhbGlkQ29kZX1gKVxuICAgICAgICAuZXhwZWN0KDQwNCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnZXJyb3InKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5Lm1lc3NhZ2UpLnRvTWF0Y2goL27Do28gZW5jb250cmFkby9pKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFRFU1RFIDM6IFZBTElEQcOHw4NPIENPTSBEQURPUyBSRUFJU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdWYWxpZGHDp8OjbyBkZSBEYWRvcyBkbyBCYW5jbycsICgpID0+IHtcbiAgICBcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBlc3RydXR1cmEgZGUgZGFkb3MgY29ycmV0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8ke3Rlc3RJdGVtQ29kZX1gKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gcmVzcG9uc2UuYm9keTtcblxuICAgICAgLy8gRXN0cnV0dXJhIGVzcGVyYWRhIChiYXNlYWRhIG5hIHJlc3Bvc3RhIHJlYWwgZGEgQVBJKVxuICAgICAgZXhwZWN0KGRhdGEpLnRvSGF2ZVByb3BlcnR5KCdpZGVudGlmaWNhY2FvSXRlbUNvZGlnbycpO1xuICAgICAgZXhwZWN0KGRhdGEpLnRvSGF2ZVByb3BlcnR5KCdpZGVudGlmaWNhY2FvSXRlbURlc2NyaWNhbycpO1xuICAgICAgZXhwZWN0KGRhdGEpLnRvSGF2ZVByb3BlcnR5KCdpZGVudGlmaWNhY2FvSXRlbVVuaWRhZGUnKTtcbiAgICAgIGV4cGVjdChkYXRhKS50b0hhdmVQcm9wZXJ0eSgnaWRlbnRpZmljYWNhb0l0ZW5zRXN0YWJlbGVjaW1lbnRvcycpO1xuXG4gICAgICAvLyBJdGVtIGRldmUgdGVyIGNhbXBvcyBvYnJpZ2F0w7NyaW9zIGNvbSB2YWxvcmVzIGNvcnJldG9zXG4gICAgICBleHBlY3QoZGF0YS5pZGVudGlmaWNhY2FvSXRlbUNvZGlnbykudG9CZSh0ZXN0SXRlbUNvZGUpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBkYXRhLmlkZW50aWZpY2FjYW9JdGVtRGVzY3JpY2FvKS50b0JlKCdzdHJpbmcnKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgZGF0YS5pZGVudGlmaWNhY2FvSXRlbVVuaWRhZGUpLnRvQmUoJ3N0cmluZycpO1xuXG4gICAgICAvLyBFc3RhYmVsZWNpbWVudG9zIGRldmUgc2VyIGFycmF5XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShkYXRhLmlkZW50aWZpY2FjYW9JdGVuc0VzdGFiZWxlY2ltZW50b3MpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2NhbXBvcyBkbyBpdGVtIGRldmVtIHRlciB0aXBvcyBjb3JyZXRvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8ke3Rlc3RJdGVtQ29kZX1gKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5ib2R5LmRhdGE7XG5cbiAgICAgIGV4cGVjdCh0eXBlb2YgZGF0YS5pZGVudGlmaWNhY2FvSXRlbUNvZGlnbykudG9CZSgnc3RyaW5nJyk7XG4gICAgICBleHBlY3QodHlwZW9mIGRhdGEuaWRlbnRpZmljYWNhb0l0ZW1EZXNjcmljYW8pLnRvQmUoJ3N0cmluZycpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBkYXRhLmlkZW50aWZpY2FjYW9JdGVtVW5pZGFkZSkudG9CZSgnc3RyaW5nJyk7XG4gICAgICBcbiAgICAgIC8vIFZhbGlkYXIgYXJyYXkgZGUgZXN0YWJlbGVjaW1lbnRvc1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoZGF0YS5pZGVudGlmaWNhY2FvSXRlbnNFc3RhYmVsZWNpbWVudG9zKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFRFU1RFIDQ6IFBFUkZPUk1BTkNFIENPTSBCQU5DTyBSRUFMXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ1BlcmZvcm1hbmNlIChCYW5jbyBSZWFsKScsICgpID0+IHtcbiAgICBcbiAgICBpdCgnZGV2ZSByZXNwb25kZXIgZW0gbWVub3MgZGUgMyBzZWd1bmRvcycsIGFzeW5jIGZ1bmN0aW9uKCkge1xuICAgICAgLy8gUHVsYXIgc2UgbsOjbyBmb3IgYmFuY28gcmVhbFxuICAgICAgaWYgKCF1c2luZ1JlYWxEYXRhYmFzZSkge1xuICAgICAgICBjb25zb2xlLmxvZygn4o+t77iPICBUZXN0ZSBkZSBwZXJmb3JtYW5jZSBwdWxhZG8gLSB1c2FuZG8gbW9jaycpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KGAvYXBpL2xvcjAxMzgvaXRlbS9kYWRvc0NhZGFzdHJhaXMvaW5mb3JtYWNvZXNHZXJhaXMvJHt0ZXN0SXRlbUNvZGV9YClcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbigzMDAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIG1hbnRlciBwZXJmb3JtYW5jZSBjb25zaXN0ZW50ZSBlbSBtw7psdGlwbGFzIHJlcXVpc2nDp8O1ZXMnLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghdXNpbmdSZWFsRGF0YWJhc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+KPre+4jyAgVGVzdGUgZGUgcGVyZm9ybWFuY2UgcHVsYWRvIC0gdXNhbmRvIG1vY2snKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkdXJhdGlvbnM6IG51bWJlcltdID0gW107XG4gICAgICBjb25zdCBpdGVyYXRpb25zID0gNTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyYXRpb25zOyBpKyspIHtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgICAgICBcbiAgICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgICAgLmdldChgL2FwaS9sb3IwMTM4L2l0ZW0vZGFkb3NDYWRhc3RyYWlzL2luZm9ybWFjb2VzR2VyYWlzLyR7dGVzdEl0ZW1Db2RlfWApXG4gICAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICAgIGR1cmF0aW9ucy5wdXNoKERhdGUubm93KCkgLSBzdGFydCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGF2Z0R1cmF0aW9uID0gZHVyYXRpb25zLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApIC8gZHVyYXRpb25zLmxlbmd0aDtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYPCfk4ogTcOpZGlhIGRlICR7aXRlcmF0aW9uc30gcmVxdWlzacOnw7VlczogJHthdmdEdXJhdGlvbi50b0ZpeGVkKDApfW1zYCk7XG4gICAgICBleHBlY3QoYXZnRHVyYXRpb24pLnRvQmVMZXNzVGhhbigzMDAwKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFRFU1RFIDU6IEVER0UgQ0FTRVMgQ09NIEJBTkNPIFJFQUxcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBkZXNjcmliZSgnRWRnZSBDYXNlcyAoQmFuY28gUmVhbCknLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ2RldmUgYnVzY2FyIGl0ZW0gY29tIGPDs2RpZ28gYWxmYW51bcOpcmljbycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFVzYXIgY8OzZGlnbyBjb25oZWNpZG8gb3UgcHVsYXIgc2UgbsOjbyBob3V2ZXJcbiAgICAgIGNvbnN0IGNvZGVzID0gRGF0YWJhc2VUZXN0SGVscGVyLmdldEtub3duVGVzdENvZGVzKCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8ke2NvZGVzLnZhbGlkSXRlbX1gKVxuICAgICAgICAuZXhwZWN0KChyZXMpID0+IHtcbiAgICAgICAgICAvLyBBY2VpdGEgMjAwIChlbmNvbnRyYWRvKSBvdSA0MDQgKG7Do28gZW5jb250cmFkbywgbWFzIHZhbGlkb3UpXG4gICAgICAgICAgZXhwZWN0KFsyMDAsIDQwNF0pLnRvQ29udGFpbihyZXMuc3RhdHVzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgdmFsaWRhciBjw7NkaWdvIGNvbSAxNiBjYXJhY3RlcmVzIChtw6F4aW1vKScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1heENvZGUgPSAnMTIzNDU2Nzg5MDEyMzQ1Nic7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8ke21heENvZGV9YClcbiAgICAgICAgLmV4cGVjdCgocmVzKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KFsyMDAsIDQwNF0pLnRvQ29udGFpbihyZXMuc3RhdHVzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgIC8vIE7Do28gZGV2ZSBkYXIgZXJybyBkZSB2YWxpZGHDp8OjbyAoNDAwKVxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykubm90LnRvQmUoNDAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHJlamVpdGFyIGPDs2RpZ28gY29tIDE3IGNhcmFjdGVyZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0b29Mb25nQ29kZSA9ICcxMjM0NTY3ODkwMTIzNDU2Nyc7IC8vIDE3IGNoYXJzXG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8ke3Rvb0xvbmdDb2RlfWApXG4gICAgICAgIC5leHBlY3QoNDAwKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdlcnJvcicpO1xuICAgIH0pO1xuXG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gVEVTVEUgNjogRVNUQUJFTEVDSU1FTlRPUyAoc2UgZGlzcG9uw612ZWwpXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ0VzdGFiZWxlY2ltZW50b3MgZG8gSXRlbScsICgpID0+IHtcbiAgICBcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBlc3RhYmVsZWNpbWVudG9zIHNlIGV4aXN0aXJlbScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8ke3Rlc3RJdGVtQ29kZX1gKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGNvbnN0IHsgaWRlbnRpZmljYWNhb0l0ZW5zRXN0YWJlbGVjaW1lbnRvcyB9ID0gcmVzcG9uc2UuYm9keS5kYXRhO1xuXG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShpZGVudGlmaWNhY2FvSXRlbnNFc3RhYmVsZWNpbWVudG9zKSkudG9CZSh0cnVlKTtcblxuICAgICAgLy8gU2UgaG91dmVyIGVzdGFiZWxlY2ltZW50b3MsIHZhbGlkYXIgZXN0cnV0dXJhXG4gICAgICBpZiAoaWRlbnRpZmljYWNhb0l0ZW5zRXN0YWJlbGVjaW1lbnRvcyAmJiBpZGVudGlmaWNhY2FvSXRlbnNFc3RhYmVsZWNpbWVudG9zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgZXN0YWIgPSBpZGVudGlmaWNhY2FvSXRlbnNFc3RhYmVsZWNpbWVudG9zWzBdO1xuICAgICAgICBcbiAgICAgICAgZXhwZWN0KGVzdGFiKS50b0hhdmVQcm9wZXJ0eSgnZXN0YWJDb2RpZ28nKTtcbiAgICAgICAgZXhwZWN0KHR5cGVvZiBlc3RhYi5lc3RhYkNvZGlnbykudG9CZSgnc3RyaW5nJyk7XG4gICAgICAgIGV4cGVjdChlc3RhYikudG9IYXZlUHJvcGVydHkoJ2l0ZW1Db2RpZ28nKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFRFU1RFIDc6IENPUlJFTEFUSU9OIElEIEUgSEVBREVSU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdIZWFkZXJzIGUgQ29ycmVsYXRpb24gSUQnLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ2RldmUgaW5jbHVpciBDb3JyZWxhdGlvbiBJRCBuYSByZXNwb3N0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8ke3Rlc3RJdGVtQ29kZX1gKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmhlYWRlcnNbJ3gtY29ycmVsYXRpb24taWQnXSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGFjZWl0YXIgQ29ycmVsYXRpb24gSUQgY3VzdG9taXphZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjdXN0b21JZCA9ICdpbnRlZ3JhdGlvbi10ZXN0LTEyMyc7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8ke3Rlc3RJdGVtQ29kZX1gKVxuICAgICAgICAuc2V0KCdYLUNvcnJlbGF0aW9uLUlEJywgY3VzdG9tSWQpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuaGVhZGVyc1sneC1jb3JyZWxhdGlvbi1pZCddKS50b0JlKGN1c3RvbUlkKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFRFU1RFIDg6IFRJTUVPVVQgRSBSRVNJTMOKTkNJQVxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdUaW1lb3V0IGUgUmVzaWzDqm5jaWEnLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ27Do28gZGV2ZSB0cmF2YXIgZW0gcmVxdWlzacOnw6NvIGludsOhbGlkYScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy9JTlZBTElEJylcbiAgICAgICAgLnRpbWVvdXQoNTAwMCk7IC8vIDVzIG1heFxuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KFsyMDAsIDQwNCwgNDAwXSkudG9Db250YWluKHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgfSk7XG5cbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBURVNURSA5OiBDT01QQVJBw4fDg08gTU9DSyB2cyBSRUFMXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ0NvbXBhcmHDp8OjbyBNb2NrIHZzIFJlYWwnLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ2RldmUgaW5mb3JtYXIgcXVhbCBmb250ZSBkZSBkYWRvcyBlc3TDoSBzZW5kbyB1c2FkYScsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBcbiAgICAgICAg8J+TiiBSRVNVTFRBRE8gRE9TIFRFU1RFUzpcbiAgICAgICAgLSBGb250ZSBkZSBkYWRvczogJHt1c2luZ1JlYWxEYXRhYmFzZSA/ICdCQU5DTyBSRUFMJyA6ICdNT0NLJ31cbiAgICAgICAgLSBDw7NkaWdvIHRlc3RhZG86ICR7dGVzdEl0ZW1Db2RlfVxuICAgICAgICAtIEFtYmllbnRlOiAke3Byb2Nlc3MuZW52Lk5PREVfRU5WfVxuICAgICAgYCk7XG5cbiAgICAgIGV4cGVjdCh1c2luZ1JlYWxEYXRhYmFzZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICB9KTtcblxufSk7Il0sInZlcnNpb24iOjN9