5153bb80ea34aac6a02dfa6a271f5f90
"use strict";
// tests/unit/repositories/informacoesGerais.repository.test.ts
Object.defineProperty(exports, "__esModule", { value: true });
// Mock do DatabaseManager
jest.mock('@infrastructure/database/DatabaseManager');
// Mock do QueryCacheService
jest.mock('@shared/utils/cache/QueryCacheService');
const informacoesGerais_repository_1 = require("@api/lor0138/item/dadosCadastrais/informacoesGerais/repository/informacoesGerais.repository");
const DatabaseManager_1 = require("@infrastructure/database/DatabaseManager");
const QueryCacheService_1 = require("@shared/utils/cache/QueryCacheService");
const item_factory_1 = require("../../factories/item.factory");
describe('Repository - ItemInformacoesGeraisRepository', () => {
    beforeEach(() => {
        jest.clearAllMocks();
    });
    // ========================================
    // getItemMaster
    // ========================================
    describe('getItemMaster', () => {
        it('deve retornar dados do item quando encontrado', async () => {
            const mockResult = [(0, item_factory_1.createItemMasterQueryResult)()];
            // Mock do cache retornando o resultado da query
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue(mockResult);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            expect(result).toEqual(mockResult[0]);
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledTimes(1);
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledWith(expect.stringContaining('OPENQUERY'), expect.arrayContaining([
                expect.objectContaining({
                    name: 'paramItemCodigo',
                    value: '7530110'
                })
            ]));
        });
        it('deve retornar null quando item não encontrado', async () => {
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('INEXISTENTE');
            expect(result).toBeNull();
        });
        it('deve usar queries parametrizadas (proteção SQL Injection)', async () => {
            const maliciousCode = "'; DROP TABLE item;--";
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster(maliciousCode);
            // Verifica que usa parâmetros, não concatenação de string
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledWith(expect.any(String), expect.arrayContaining([
                expect.objectContaining({
                    name: 'paramItemCodigo',
                    value: maliciousCode
                })
            ]));
        });
        it('deve usar cache L1/L2', async () => {
            const mockResult = [(0, item_factory_1.createItemMasterQueryResult)()];
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue(mockResult);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            expect(QueryCacheService_1.QueryCacheService.withItemCache).toHaveBeenCalledTimes(1);
            expect(QueryCacheService_1.QueryCacheService.withItemCache).toHaveBeenCalledWith(expect.stringContaining('OPENQUERY'), expect.any(Array), expect.any(Function));
        });
        it('deve propagar erros do banco de dados', async () => {
            const dbError = new Error('Conexão perdida');
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockRejectedValue(dbError);
            await expect(informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110')).rejects.toThrow('Conexão perdida');
        });
        it('deve construir query OPENQUERY correta para Progress', async () => {
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            const [query] = DatabaseManager_1.DatabaseManager.queryEmpWithParams.mock.calls[0];
            // Valida estrutura da query
            expect(query).toContain('DECLARE @itemCodigo varchar(16)');
            expect(query).toContain('OPENQUERY(PRD_EMS2EMP');
            expect(query).toContain('pub.item');
            expect(query).toContain('it-codigo');
            expect(query).toContain('desc-item');
            expect(query).toContain('EXEC sp_executesql');
        });
    });
    // ========================================
    // getItemEstabelecimentos
    // ========================================
    describe('getItemEstabelecimentos', () => {
        it('deve retornar estabelecimentos do item', async () => {
            const mockResult = [
                (0, item_factory_1.createItemEstabQueryResult)(),
                (0, item_factory_1.createItemEstabQueryResult)({ estabCodigo: '02.01', estabNome: 'Fábrica' })
            ];
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue(mockResult);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            expect(result).toEqual(mockResult);
            expect(result).toHaveLength(2);
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledTimes(1);
        });
        it('deve retornar array vazio quando não há estabelecimentos', async () => {
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            expect(result).toEqual([]);
        });
        it('deve usar cache específico de estabelecimentos', async () => {
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            expect(QueryCacheService_1.QueryCacheService.withEstabelecimentoCache).toHaveBeenCalledTimes(1);
        });
        it('deve fazer JOIN com dois Linked Servers (EMP + MULT)', async () => {
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            const [query] = DatabaseManager_1.DatabaseManager.queryEmpWithParams.mock.calls[0];
            // Valida JOIN entre PRD_EMS2EMP e PRD_EMS2MULT
            expect(query).toContain('OPENQUERY(PRD_EMS2EMP');
            expect(query).toContain('OPENQUERY(PRD_EMS2MULT');
            expect(query).toContain('item-uni-estab');
            expect(query).toContain('estabelec');
            expect(query).toContain('LEFT JOIN');
        });
        it('deve usar parâmetros em ambas as queries OPENQUERY', async () => {
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledWith(expect.any(String), expect.arrayContaining([
                expect.objectContaining({ name: 'paramItemCodigo' })
            ]));
        });
        it('deve retornar campos corretos do resultado', async () => {
            const mockResult = [(0, item_factory_1.createItemEstabQueryResult)()];
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue(mockResult);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            expect(result[0]).toHaveProperty('itemCodigo');
            expect(result[0]).toHaveProperty('estabCodigo');
            expect(result[0]).toHaveProperty('estabNome');
            expect(result[0]).toHaveProperty('codObsoleto');
        });
    });
    // ========================================
    // invalidateCache
    // ========================================
    describe('invalidateCache', () => {
        it('deve invalidar cache de item e estabelecimento', async () => {
            QueryCacheService_1.QueryCacheService.invalidateMultiple.mockResolvedValue(undefined);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.invalidateCache('7530110');
            expect(QueryCacheService_1.QueryCacheService.invalidateMultiple).toHaveBeenCalledTimes(1);
            expect(QueryCacheService_1.QueryCacheService.invalidateMultiple).toHaveBeenCalledWith([
                'item:*',
                'estabelecimento:*'
            ]);
        });
        it('deve logar invalidação de cache', async () => {
            const consoleLogSpy = jest.spyOn(console, 'log').mockImplementation();
            QueryCacheService_1.QueryCacheService.invalidateMultiple.mockResolvedValue(undefined);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.invalidateCache('7530110');
            expect(consoleLogSpy).toHaveBeenCalledWith('Cache invalidado para item:', '7530110');
            consoleLogSpy.mockRestore();
        });
    });
    // ========================================
    // CENÁRIOS DE ERRO
    // ========================================
    describe('Tratamento de Erros', () => {
        it('deve tratar timeout do banco de dados', async () => {
            const timeoutError = new Error('Timeout: Request failed to complete');
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockRejectedValue(timeoutError);
            await expect(informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110')).rejects.toThrow('Timeout');
        });
        it('deve tratar erro de conexão perdida', async () => {
            const connectionError = new Error('ECONNREFUSED');
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockRejectedValue(connectionError);
            await expect(informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110')).rejects.toThrow('ECONNREFUSED');
        });
        it('deve tratar erro de sintaxe SQL', async () => {
            const sqlError = new Error('Incorrect syntax near');
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockRejectedValue(sqlError);
            await expect(informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110')).rejects.toThrow('Incorrect syntax');
        });
    });
    // ========================================
    // INTEGRAÇÃO COM CACHE
    // ========================================
    describe('Integração com Cache', () => {
        it('deve retornar dados do cache em cache hit', async () => {
            const cachedData = [(0, item_factory_1.createItemMasterQueryResult)()];
            // Mock cache retornando dados diretamente (cache hit)
            QueryCacheService_1.QueryCacheService.withItemCache.mockResolvedValue(cachedData);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            expect(result).toEqual(cachedData[0]);
            // Não deve chamar o banco em cache hit
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).not.toHaveBeenCalled();
        });
        it('deve buscar do banco em cache miss', async () => {
            const dbData = [(0, item_factory_1.createItemMasterQueryResult)()];
            // Mock cache executando a função (cache miss)
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue(dbData);
            const result = await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            expect(result).toEqual(dbData[0]);
            expect(DatabaseManager_1.DatabaseManager.queryEmpWithParams).toHaveBeenCalledTimes(1);
        });
        it('deve usar TTL diferente para item e estabelecimento', async () => {
            QueryCacheService_1.QueryCacheService.withItemCache.mockImplementation(async (query, params, fn) => fn());
            QueryCacheService_1.QueryCacheService.withEstabelecimentoCache.mockImplementation(async (query, params, fn) => fn());
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemMaster('7530110');
            await informacoesGerais_repository_1.ItemInformacoesGeraisRepository.getItemEstabelecimentos('7530110');
            // Verifica que usa caches diferentes
            expect(QueryCacheService_1.QueryCacheService.withItemCache).toHaveBeenCalledTimes(1);
            expect(QueryCacheService_1.QueryCacheService.withEstabelecimentoCache).toHaveBeenCalledTimes(1);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWFuby9wcm9qZXRvcy9kYXRhc3VsL2xvcjAxMzgvdGVzdHMvdW5pdC9yZXBvc2l0b3JpZXMvaW5mb3JtYWNvZXNHZXJhaXMucmVwb3NpdG9yeS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQSwrREFBK0Q7O0FBVS9ELDBCQUEwQjtBQUMxQixJQUFJLENBQUMsSUFBSSxDQUFDLDBDQUEwQyxDQUFDLENBQUM7QUFFdEQsNEJBQTRCO0FBQzVCLElBQUksQ0FBQyxJQUFJLENBQUMsdUNBQXVDLENBQUMsQ0FBQztBQVpuRCw4SUFBOEk7QUFDOUksOEVBQTJFO0FBQzNFLDZFQUEwRTtBQUMxRSwrREFHc0M7QUFRdEMsUUFBUSxDQUFDLDhDQUE4QyxFQUFFLEdBQUcsRUFBRTtJQUU1RCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsMkNBQTJDO0lBQzNDLGdCQUFnQjtJQUNoQiwyQ0FBMkM7SUFDM0MsUUFBUSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7UUFFN0IsRUFBRSxDQUFDLCtDQUErQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdELE1BQU0sVUFBVSxHQUFHLENBQUMsSUFBQSwwQ0FBMkIsR0FBRSxDQUFDLENBQUM7WUFFbkQsZ0RBQWdEO1lBQy9DLHFDQUFpQixDQUFDLGFBQTJCLENBQUMsa0JBQWtCLENBQy9ELEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQ2xDLENBQUM7WUFFRCxpQ0FBZSxDQUFDLGtCQUFnQyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBRWhGLE1BQU0sTUFBTSxHQUFHLE1BQU0sOERBQStCLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRTlFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFD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QUMsQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxpQ0FBZSxDQUFDLGtCQUFrQixDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMscURBQXFELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEUscUNBQWlCLENBQUMsYUFBMkIsQ0FBQyxrQkFBa0IsQ0FDL0QsS0FBSyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FDbEMsQ0FBQztZQUVELHFDQUFpQixDQUFDLHdCQUFzQyxDQUFDLGtCQUFrQixDQUMxRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUNsQyxDQUFDO1lBRUQsaUNBQWUsQ0FBQyxrQkFBZ0MsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUV4RSxNQUFNLDhEQUErQixDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUMvRCxNQUFNLDhEQUErQixDQUFDLHVCQUF1QixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRXpFLHFDQUFxQztZQUNyQyxNQUFNLENBQUMscUNBQWlCLENBQUMsYUFBYSxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDakUsTUFBTSxDQUFDLHFDQUFpQixDQUFDLHdCQUF3QixDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUUsQ0FBQyxDQUFDLENBQUM7SUFFTCxDQUFDLENBQUMsQ0FBQztBQUVMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL21hbm8vcHJvamV0b3MvZGF0YXN1bC9sb3IwMTM4L3Rlc3RzL3VuaXQvcmVwb3NpdG9yaWVzL2luZm9ybWFjb2VzR2VyYWlzLnJlcG9zaXRvcnkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0ZXN0cy91bml0L3JlcG9zaXRvcmllcy9pbmZvcm1hY29lc0dlcmFpcy5yZXBvc2l0b3J5LnRlc3QudHNcblxuaW1wb3J0IHsgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeSB9IGZyb20gJ0BhcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy9yZXBvc2l0b3J5L2luZm9ybWFjb2VzR2VyYWlzLnJlcG9zaXRvcnknO1xuaW1wb3J0IHsgRGF0YWJhc2VNYW5hZ2VyIH0gZnJvbSAnQGluZnJhc3RydWN0dXJlL2RhdGFiYXNlL0RhdGFiYXNlTWFuYWdlcic7XG5pbXBvcnQgeyBRdWVyeUNhY2hlU2VydmljZSB9IGZyb20gJ0BzaGFyZWQvdXRpbHMvY2FjaGUvUXVlcnlDYWNoZVNlcnZpY2UnO1xuaW1wb3J0IHsgXG4gIGNyZWF0ZUl0ZW1NYXN0ZXJRdWVyeVJlc3VsdCwgXG4gIGNyZWF0ZUl0ZW1Fc3RhYlF1ZXJ5UmVzdWx0IFxufSBmcm9tICcuLi8uLi9mYWN0b3JpZXMvaXRlbS5mYWN0b3J5JztcblxuLy8gTW9jayBkbyBEYXRhYmFzZU1hbmFnZXJcbmplc3QubW9jaygnQGluZnJhc3RydWN0dXJlL2RhdGFiYXNlL0RhdGFiYXNlTWFuYWdlcicpO1xuXG4vLyBNb2NrIGRvIFF1ZXJ5Q2FjaGVTZXJ2aWNlXG5qZXN0Lm1vY2soJ0BzaGFyZWQvdXRpbHMvY2FjaGUvUXVlcnlDYWNoZVNlcnZpY2UnKTtcblxuZGVzY3JpYmUoJ1JlcG9zaXRvcnkgLSBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5JywgKCkgPT4ge1xuICBcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gZ2V0SXRlbU1hc3RlclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdnZXRJdGVtTWFzdGVyJywgKCkgPT4ge1xuICAgIFxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGRhZG9zIGRvIGl0ZW0gcXVhbmRvIGVuY29udHJhZG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUmVzdWx0ID0gW2NyZWF0ZUl0ZW1NYXN0ZXJRdWVyeVJlc3VsdCgpXTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBkbyBjYWNoZSByZXRvcm5hbmRvIG8gcmVzdWx0YWRvIGRhIHF1ZXJ5XG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEl0ZW1DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZXN1bHQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1NYXN0ZXIoJzc1MzAxMTAnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUmVzdWx0WzBdKTtcbiAgICAgIGV4cGVjdChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICBleHBlY3QoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdPUEVOUVVFUlknKSxcbiAgICAgICAgZXhwZWN0LmFycmF5Q29udGFpbmluZyhbXG4gICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBcbiAgICAgICAgICAgIG5hbWU6ICdwYXJhbUl0ZW1Db2RpZ28nLCBcbiAgICAgICAgICAgIHZhbHVlOiAnNzUzMDExMCcgXG4gICAgICAgICAgfSlcbiAgICAgICAgXSlcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSByZXRvcm5hciBudWxsIHF1YW5kbyBpdGVtIG7Do28gZW5jb250cmFkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoSXRlbUNhY2hlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICBhc3luYyAocXVlcnksIHBhcmFtcywgZm4pID0+IGZuKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1NYXN0ZXIoJ0lORVhJU1RFTlRFJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSB1c2FyIHF1ZXJpZXMgcGFyYW1ldHJpemFkYXMgKHByb3Rlw6fDo28gU1FMIEluamVjdGlvbiknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtYWxpY2lvdXNDb2RlID0gXCInOyBEUk9QIFRBQkxFIGl0ZW07LS1cIjtcbiAgICAgIFxuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbU1hc3RlcihtYWxpY2lvdXNDb2RlKTtcblxuICAgICAgLy8gVmVyaWZpY2EgcXVlIHVzYSBwYXLDom1ldHJvcywgbsOjbyBjb25jYXRlbmHDp8OjbyBkZSBzdHJpbmdcbiAgICAgIGV4cGVjdChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgICBleHBlY3QuYXJyYXlDb250YWluaW5nKFtcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IFxuICAgICAgICAgICAgbmFtZTogJ3BhcmFtSXRlbUNvZGlnbycsIFxuICAgICAgICAgICAgdmFsdWU6IG1hbGljaW91c0NvZGUgXG4gICAgICAgICAgfSlcbiAgICAgICAgXSlcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSB1c2FyIGNhY2hlIEwxL0wyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Jlc3VsdCA9IFtjcmVhdGVJdGVtTWFzdGVyUXVlcnlSZXN1bHQoKV07XG4gICAgICBcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoSXRlbUNhY2hlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICBhc3luYyAocXVlcnksIHBhcmFtcywgZm4pID0+IGZuKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jlc3VsdCk7XG5cbiAgICAgIGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbU1hc3RlcignNzUzMDExMCcpO1xuXG4gICAgICBleHBlY3QoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEl0ZW1DYWNoZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnT1BFTlFVRVJZJyksXG4gICAgICAgIGV4cGVjdC5hbnkoQXJyYXkpLFxuICAgICAgICBleHBlY3QuYW55KEZ1bmN0aW9uKVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHByb3BhZ2FyIGVycm9zIGRvIGJhbmNvIGRlIGRhZG9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGJFcnJvciA9IG5ldyBFcnJvcignQ29uZXjDo28gcGVyZGlkYScpO1xuICAgICAgXG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEl0ZW1DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKGRiRXJyb3IpO1xuXG4gICAgICBhd2FpdCBleHBlY3QoXG4gICAgICAgIEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbU1hc3RlcignNzUzMDExMCcpXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnQ29uZXjDo28gcGVyZGlkYScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgY29uc3RydWlyIHF1ZXJ5IE9QRU5RVUVSWSBjb3JyZXRhIHBhcmEgUHJvZ3Jlc3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEl0ZW1DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtTWFzdGVyKCc3NTMwMTEwJyk7XG5cbiAgICAgIGNvbnN0IFtxdWVyeV0gPSAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2suY2FsbHNbMF07XG4gICAgICBcbiAgICAgIC8vIFZhbGlkYSBlc3RydXR1cmEgZGEgcXVlcnlcbiAgICAgIGV4cGVjdChxdWVyeSkudG9Db250YWluKCdERUNMQVJFIEBpdGVtQ29kaWdvIHZhcmNoYXIoMTYpJyk7XG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbignT1BFTlFVRVJZKFBSRF9FTVMyRU1QJyk7XG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbigncHViLml0ZW0nKTtcbiAgICAgIGV4cGVjdChxdWVyeSkudG9Db250YWluKCdpdC1jb2RpZ28nKTtcbiAgICAgIGV4cGVjdChxdWVyeSkudG9Db250YWluKCdkZXNjLWl0ZW0nKTtcbiAgICAgIGV4cGVjdChxdWVyeSkudG9Db250YWluKCdFWEVDIHNwX2V4ZWN1dGVzcWwnKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIGdldEl0ZW1Fc3RhYmVsZWNpbWVudG9zXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ2dldEl0ZW1Fc3RhYmVsZWNpbWVudG9zJywgKCkgPT4ge1xuICAgIFxuICAgIGl0KCdkZXZlIHJldG9ybmFyIGVzdGFiZWxlY2ltZW50b3MgZG8gaXRlbScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tSZXN1bHQgPSBbXG4gICAgICAgIGNyZWF0ZUl0ZW1Fc3RhYlF1ZXJ5UmVzdWx0KCksXG4gICAgICAgIGNyZWF0ZUl0ZW1Fc3RhYlF1ZXJ5UmVzdWx0KHsgZXN0YWJDb2RpZ286ICcwMi4wMScsIGVzdGFiTm9tZTogJ0bDoWJyaWNhJyB9KVxuICAgICAgXTtcbiAgICAgIFxuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhFc3RhYmVsZWNpbWVudG9DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZXN1bHQpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1Fc3RhYmVsZWNpbWVudG9zKCc3NTMwMTEwJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Jlc3VsdCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBleHBlY3QoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgYXJyYXkgdmF6aW8gcXVhbmRvIG7Do28gaMOhIGVzdGFiZWxlY2ltZW50b3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEVzdGFiZWxlY2ltZW50b0NhY2hlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICBhc3luYyAocXVlcnksIHBhcmFtcywgZm4pID0+IGZuKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1Fc3RhYmVsZWNpbWVudG9zKCc3NTMwMTEwJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoW10pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgdXNhciBjYWNoZSBlc3BlY8OtZmljbyBkZSBlc3RhYmVsZWNpbWVudG9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhFc3RhYmVsZWNpbWVudG9DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtRXN0YWJlbGVjaW1lbnRvcygnNzUzMDExMCcpO1xuXG4gICAgICBleHBlY3QoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEVzdGFiZWxlY2ltZW50b0NhY2hlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBmYXplciBKT0lOIGNvbSBkb2lzIExpbmtlZCBTZXJ2ZXJzIChFTVAgKyBNVUxUKScsIGFzeW5jICgpID0+IHtcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoRXN0YWJlbGVjaW1lbnRvQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbUVzdGFiZWxlY2ltZW50b3MoJzc1MzAxMTAnKTtcblxuICAgICAgY29uc3QgW3F1ZXJ5XSA9IChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9jay5jYWxsc1swXTtcbiAgICAgIFxuICAgICAgLy8gVmFsaWRhIEpPSU4gZW50cmUgUFJEX0VNUzJFTVAgZSBQUkRfRU1TMk1VTFRcbiAgICAgIGV4cGVjdChxdWVyeSkudG9Db250YWluKCdPUEVOUVVFUlkoUFJEX0VNUzJFTVAnKTtcbiAgICAgIGV4cGVjdChxdWVyeSkudG9Db250YWluKCdPUEVOUVVFUlkoUFJEX0VNUzJNVUxUJyk7XG4gICAgICBleHBlY3QocXVlcnkpLnRvQ29udGFpbignaXRlbS11bmktZXN0YWInKTtcbiAgICAgIGV4cGVjdChxdWVyeSkudG9Db250YWluKCdlc3RhYmVsZWMnKTtcbiAgICAgIGV4cGVjdChxdWVyeSkudG9Db250YWluKCdMRUZUIEpPSU4nKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIHVzYXIgcGFyw6JtZXRyb3MgZW0gYW1iYXMgYXMgcXVlcmllcyBPUEVOUVVFUlknLCBhc3luYyAoKSA9PiB7XG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEVzdGFiZWxlY2ltZW50b0NhY2hlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICBhc3luYyAocXVlcnksIHBhcmFtcywgZm4pID0+IGZuKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBhd2FpdCBJdGVtSW5mb3JtYWNvZXNHZXJhaXNSZXBvc2l0b3J5LmdldEl0ZW1Fc3RhYmVsZWNpbWVudG9zKCc3NTMwMTEwJyk7XG5cbiAgICAgIGV4cGVjdChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgICBleHBlY3QuYXJyYXlDb250YWluaW5nKFtcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IG5hbWU6ICdwYXJhbUl0ZW1Db2RpZ28nIH0pXG4gICAgICAgIF0pXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgY2FtcG9zIGNvcnJldG9zIGRvIHJlc3VsdGFkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tSZXN1bHQgPSBbY3JlYXRlSXRlbUVzdGFiUXVlcnlSZXN1bHQoKV07XG4gICAgICBcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoRXN0YWJlbGVjaW1lbnRvQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVzdWx0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtRXN0YWJlbGVjaW1lbnRvcygnNzUzMDExMCcpO1xuXG4gICAgICBleHBlY3QocmVzdWx0WzBdKS50b0hhdmVQcm9wZXJ0eSgnaXRlbUNvZGlnbycpO1xuICAgICAgZXhwZWN0KHJlc3VsdFswXSkudG9IYXZlUHJvcGVydHkoJ2VzdGFiQ29kaWdvJyk7XG4gICAgICBleHBlY3QocmVzdWx0WzBdKS50b0hhdmVQcm9wZXJ0eSgnZXN0YWJOb21lJyk7XG4gICAgICBleHBlY3QocmVzdWx0WzBdKS50b0hhdmVQcm9wZXJ0eSgnY29kT2Jzb2xldG8nKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIGludmFsaWRhdGVDYWNoZVxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdpbnZhbGlkYXRlQ2FjaGUnLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ2RldmUgaW52YWxpZGFyIGNhY2hlIGRlIGl0ZW0gZSBlc3RhYmVsZWNpbWVudG8nLCBhc3luYyAoKSA9PiB7XG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2UuaW52YWxpZGF0ZU11bHRpcGxlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5pbnZhbGlkYXRlQ2FjaGUoJzc1MzAxMTAnKTtcblxuICAgICAgZXhwZWN0KFF1ZXJ5Q2FjaGVTZXJ2aWNlLmludmFsaWRhdGVNdWx0aXBsZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KFF1ZXJ5Q2FjaGVTZXJ2aWNlLmludmFsaWRhdGVNdWx0aXBsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoW1xuICAgICAgICAnaXRlbToqJyxcbiAgICAgICAgJ2VzdGFiZWxlY2ltZW50bzoqJ1xuICAgICAgXSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBsb2dhciBpbnZhbGlkYcOnw6NvIGRlIGNhY2hlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uc29sZUxvZ1NweSA9IGplc3Quc3B5T24oY29uc29sZSwgJ2xvZycpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICAgICAgXG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2UuaW52YWxpZGF0ZU11bHRpcGxlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5pbnZhbGlkYXRlQ2FjaGUoJzc1MzAxMTAnKTtcblxuICAgICAgZXhwZWN0KGNvbnNvbGVMb2dTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnQ2FjaGUgaW52YWxpZGFkbyBwYXJhIGl0ZW06JyxcbiAgICAgICAgJzc1MzAxMTAnXG4gICAgICApO1xuXG4gICAgICBjb25zb2xlTG9nU3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgfSk7XG5cbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBDRU7DgVJJT1MgREUgRVJST1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdUcmF0YW1lbnRvIGRlIEVycm9zJywgKCkgPT4ge1xuICAgIFxuICAgIGl0KCdkZXZlIHRyYXRhciB0aW1lb3V0IGRvIGJhbmNvIGRlIGRhZG9zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdGltZW91dEVycm9yID0gbmV3IEVycm9yKCdUaW1lb3V0OiBSZXF1ZXN0IGZhaWxlZCB0byBjb21wbGV0ZScpO1xuICAgICAgXG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEl0ZW1DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKHRpbWVvdXRFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtTWFzdGVyKCc3NTMwMTEwJylcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdUaW1lb3V0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSB0cmF0YXIgZXJybyBkZSBjb25leMOjbyBwZXJkaWRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29ubmVjdGlvbkVycm9yID0gbmV3IEVycm9yKCdFQ09OTlJFRlVTRUQnKTtcbiAgICAgIFxuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhFc3RhYmVsZWNpbWVudG9DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKGNvbm5lY3Rpb25FcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtRXN0YWJlbGVjaW1lbnRvcygnNzUzMDExMCcpXG4gICAgICApLnJlamVjdHMudG9UaHJvdygnRUNPTk5SRUZVU0VEJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSB0cmF0YXIgZXJybyBkZSBzaW50YXhlIFNRTCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNxbEVycm9yID0gbmV3IEVycm9yKCdJbmNvcnJlY3Qgc3ludGF4IG5lYXInKTtcbiAgICAgIFxuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShzcWxFcnJvcik7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtTWFzdGVyKCc3NTMwMTEwJylcbiAgICAgICkucmVqZWN0cy50b1Rocm93KCdJbmNvcnJlY3Qgc3ludGF4Jyk7XG4gICAgfSk7XG5cbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBJTlRFR1JBw4fDg08gQ09NIENBQ0hFXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ0ludGVncmHDp8OjbyBjb20gQ2FjaGUnLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgZGFkb3MgZG8gY2FjaGUgZW0gY2FjaGUgaGl0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY2FjaGVkRGF0YSA9IFtjcmVhdGVJdGVtTWFzdGVyUXVlcnlSZXN1bHQoKV07XG4gICAgICBcbiAgICAgIC8vIE1vY2sgY2FjaGUgcmV0b3JuYW5kbyBkYWRvcyBkaXJldGFtZW50ZSAoY2FjaGUgaGl0KVxuICAgICAgKFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhJdGVtQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShjYWNoZWREYXRhKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtTWFzdGVyKCc3NTMwMTEwJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoY2FjaGVkRGF0YVswXSk7XG4gICAgICAvLyBOw6NvIGRldmUgY2hhbWFyIG8gYmFuY28gZW0gY2FjaGUgaGl0XG4gICAgICBleHBlY3QoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcykubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGJ1c2NhciBkbyBiYW5jbyBlbSBjYWNoZSBtaXNzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGJEYXRhID0gW2NyZWF0ZUl0ZW1NYXN0ZXJRdWVyeVJlc3VsdCgpXTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBjYWNoZSBleGVjdXRhbmRvIGEgZnVuw6fDo28gKGNhY2hlIG1pc3MpXG4gICAgICAoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEl0ZW1DYWNoZSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgYXN5bmMgKHF1ZXJ5LCBwYXJhbXMsIGZuKSA9PiBmbigpXG4gICAgICApO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKGRiRGF0YSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbU1hc3RlcignNzUzMDExMCcpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGRiRGF0YVswXSk7XG4gICAgICBleHBlY3QoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgdXNhciBUVEwgZGlmZXJlbnRlIHBhcmEgaXRlbSBlIGVzdGFiZWxlY2ltZW50bycsIGFzeW5jICgpID0+IHtcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoSXRlbUNhY2hlIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKFxuICAgICAgICBhc3luYyAocXVlcnksIHBhcmFtcywgZm4pID0+IGZuKClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIChRdWVyeUNhY2hlU2VydmljZS53aXRoRXN0YWJlbGVjaW1lbnRvQ2FjaGUgYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgIGFzeW5jIChxdWVyeSwgcGFyYW1zLCBmbikgPT4gZm4oKVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGF3YWl0IEl0ZW1JbmZvcm1hY29lc0dlcmFpc1JlcG9zaXRvcnkuZ2V0SXRlbU1hc3RlcignNzUzMDExMCcpO1xuICAgICAgYXdhaXQgSXRlbUluZm9ybWFjb2VzR2VyYWlzUmVwb3NpdG9yeS5nZXRJdGVtRXN0YWJlbGVjaW1lbnRvcygnNzUzMDExMCcpO1xuXG4gICAgICAvLyBWZXJpZmljYSBxdWUgdXNhIGNhY2hlcyBkaWZlcmVudGVzXG4gICAgICBleHBlY3QoUXVlcnlDYWNoZVNlcnZpY2Uud2l0aEl0ZW1DYWNoZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KFF1ZXJ5Q2FjaGVTZXJ2aWNlLndpdGhFc3RhYmVsZWNpbWVudG9DYWNoZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuXG4gIH0pO1xuXG59KTsiXSwidmVyc2lvbiI6M30=