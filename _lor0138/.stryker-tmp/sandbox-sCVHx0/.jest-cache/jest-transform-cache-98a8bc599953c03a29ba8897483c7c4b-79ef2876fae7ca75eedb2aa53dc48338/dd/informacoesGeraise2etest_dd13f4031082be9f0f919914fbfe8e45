fc12d33205cd704cb921e95a9ab212a3
"use strict";
// tests/e2e/api/informacoesGerais.e2e.test.ts
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock do DatabaseManager para E2E
jest.mock('@infrastructure/database/DatabaseManager');
const supertest_1 = __importDefault(require("supertest"));
const app_1 = __importDefault(require("../../../src/app")); // Express app
const DatabaseManager_1 = require("@infrastructure/database/DatabaseManager");
const item_factory_1 = require("../../factories/item.factory");
describe('E2E - API InformacoesGerais', () => {
    beforeAll(async () => {
        // Inicializar DatabaseManager se necessário
        DatabaseManager_1.DatabaseManager.initialize.mockResolvedValue(undefined);
        DatabaseManager_1.DatabaseManager.isReady.mockReturnValue(true);
    });
    afterAll(async () => {
        // Cleanup
        await DatabaseManager_1.DatabaseManager.close();
    });
    beforeEach(() => {
        jest.clearAllMocks();
    });
    // ========================================
    // CASOS DE SUCESSO
    // ========================================
    describe('GET /api/lor0138/item/dadosCadastrais/informacoesGerais/:itemCodigo', () => {
        it('deve retornar 200 com dados do item', async () => {
            const mockData = (0, item_factory_1.createInformacoesGerais)();
            // Mock do DatabaseManager retornando dados
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: '7530110',
                    itemDescricao: 'VALVULA DE ESFERA 1/2" BRONZE',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/7530110')
                .expect(200);
            expect(response.body).toHaveProperty('success', true);
            expect(response.body).toHaveProperty('data');
        });
        it('deve retornar headers corretos', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: '7530110',
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/7530110');
            expect(response.headers['content-type']).toMatch(/application\/json/);
            expect(response.headers['x-correlation-id']).toBeDefined();
        });
        it('deve aceitar Correlation ID customizado', async () => {
            const customCorrelationId = 'test-correlation-123';
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: '7530110',
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/7530110')
                .set('X-Correlation-ID', customCorrelationId);
            expect(response.headers['x-correlation-id']).toBe(customCorrelationId);
        });
    });
    // ========================================
    // VALIDAÇÃO DE ENTRADA
    // ========================================
    describe('Validação de Parâmetros', () => {
        it('deve retornar 400 para itemCodigo inválido (muito longo)', async () => {
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/12345678901234567')
                .expect(400);
            expect(response.body).toHaveProperty('error');
            expect(response.body.error).toMatch(/ValidationError/);
        });
        it('deve retornar 400 para itemCodigo vazio', async () => {
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/ ')
                .expect(404); // Express trata ' ' como rota não encontrada
            expect(response.body).toHaveProperty('error');
        });
    });
    // ========================================
    // ITEM NÃO ENCONTRADO
    // ========================================
    describe('Item Não Encontrado', () => {
        it('deve retornar 404 quando item não existe', async () => {
            // Mock retornando vazio
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/INEXISTENTE')
                .expect(404);
            expect(response.body).toHaveProperty('error');
            expect(response.body.message).toMatch(/não encontrado/i);
        });
        it('deve incluir Correlation ID no erro 404', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/INEXISTENTE');
            expect(response.headers['x-correlation-id']).toBeDefined();
        });
    });
    // ========================================
    // ERROS DO SERVIDOR
    // ========================================
    describe('Erros do Servidor', () => {
        it('deve retornar 500 em caso de erro no banco', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockRejectedValue(new Error('Conexão perdida'));
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/7530110')
                .expect(500);
            expect(response.body).toHaveProperty('error');
        });
    });
    // ========================================
    // MIDDLEWARES
    // ========================================
    describe('Middlewares', () => {
        it('deve aplicar CORS headers', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: '7530110',
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/7530110')
                .set('Origin', 'http://localhost:3000');
            expect(response.headers['access-control-allow-origin']).toBeDefined();
        });
        it('deve comprimir resposta (gzip)', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: '7530110',
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/7530110')
                .set('Accept-Encoding', 'gzip');
            // Compression middleware pode adicionar vary header
            expect(response.headers).toBeDefined();
        });
    });
    // ========================================
    // CACHE (se implementado)
    // ========================================
    describe('Cache HTTP', () => {
        it('deve retornar Cache-Control header', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: '7530110',
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/7530110');
            // Se cache middleware estiver ativo
            if (response.headers['cache-control']) {
                expect(response.headers['cache-control']).toBeDefined();
            }
        });
    });
    // ========================================
    // AUTENTICAÇÃO (API Key opcional)
    // ========================================
    describe('API Key (Opcional)', () => {
        it('deve aceitar requisição sem API Key', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: '7530110',
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/7530110')
                .expect(200);
            expect(response.body.success).toBe(true);
        });
        it('deve aceitar API Key válida se fornecida', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: '7530110',
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/7530110')
                .set('X-API-Key', 'free-demo-key-123456')
                .expect(200);
            expect(response.body.success).toBe(true);
        });
    });
    // ========================================
    // PERFORMANCE
    // ========================================
    describe('Performance', () => {
        it('deve responder em menos de 1 segundo', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: '7530110',
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const start = Date.now();
            await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/7530110')
                .expect(200);
            const duration = Date.now() - start;
            expect(duration).toBeLessThan(1000);
        });
    });
    // ========================================
    // EDGE CASES
    // ========================================
    describe('Edge Cases', () => {
        it('deve aceitar código alfanumérico', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: 'ABC123',
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/ABC123')
                .expect(200);
            expect(response.body.success).toBe(true);
        });
        it('deve aceitar código de 1 caractere', async () => {
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: 'A',
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/api/lor0138/item/dadosCadastrais/informacoesGerais/A')
                .expect(200);
            expect(response.body.success).toBe(true);
        });
        it('deve aceitar código de 16 caracteres (máximo)', async () => {
            const codigo16 = '1234567890123456';
            DatabaseManager_1.DatabaseManager.queryEmpWithParams.mockResolvedValue([{
                    itemCodigo: codigo16,
                    itemDescricao: 'Test',
                    itemUnidade: 'UN'
                }]);
            const response = await (0, supertest_1.default)(app_1.default)
                .get(`/api/lor0138/item/dadosCadastrais/informacoesGerais/${codigo16}`)
                .expect(200);
            expect(response.body.success).toBe(true);
        });
    });
    // ========================================
    // ROTAS ESPECIAIS
    // ========================================
    describe('Rotas do Sistema', () => {
        it('GET / - deve retornar informações da API', async () => {
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/')
                .expect(200);
            expect(response.body).toHaveProperty('message');
            expect(response.body).toHaveProperty('version');
            expect(response.body).toHaveProperty('documentation');
        });
        it('GET /health - deve retornar status de saúde', async () => {
            DatabaseManager_1.DatabaseManager.getConnection.mockReturnValue({
                query: jest.fn().mockResolvedValue([{ test: 1 }])
            });
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/health')
                .expect(200);
            expect(response.body).toHaveProperty('status');
            expect(response.body).toHaveProperty('database');
        });
        it('GET /metrics - deve retornar métricas Prometheus', async () => {
            const response = await (0, supertest_1.default)(app_1.default)
                .get('/metrics');
            // Métricas retornam texto, não JSON
            expect(response.text).toBeDefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWFuby9wcm9qZXRvcy9kYXRhc3VsL2xvcjAxMzgvdGVzdHMvZTJlL2FwaS9pbmZvcm1hY29lc0dlcmFpcy5lMmUudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUEsOENBQThDOzs7OztBQU85QyxtQ0FBbUM7QUFDbkMsSUFBSSxDQUFDLElBQUksQ0FBQywwQ0FBMEMsQ0FBQyxDQUFDO0FBTnRELDBEQUFnQztBQUNoQywyREFBbUMsQ0FBQyxjQUFjO0FBQ2xELDhFQUEyRTtBQUMzRSwrREFBdUU7QUFLdkUsUUFBUSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRTtJQUUzQyxTQUFTLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDbkIsNENBQTRDO1FBQzNDLGlDQUFlLENBQUMsVUFBd0IsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN0RSxpQ0FBZSxDQUFDLE9BQXFCLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQy9ELENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ2xCLFVBQVU7UUFDVixNQUFNLGlDQUFlLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDaEMsQ0FBQyxDQUFDLENBQUM7SUFFSCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsMkNBQTJDO0lBQzNDLG1CQUFtQjtJQUNuQiwyQ0FBMkM7SUFDM0MsUUFBUSxDQUFDLHFFQUFxRSxFQUFFLEdBQUcsRUFBRTtRQUVuRixFQUFFLENBQUMscUNBQXFDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbkQsTUFBTSxRQUFRLEdBQUcsSUFBQSxzQ0FBdUIsR0FBRSxDQUFDO1lBRTNDLDJDQUEyQztZQUMxQyxpQ0FBZSxDQUFDLGtCQUFnQyxDQUFDLGlCQUFpQixDQUFDLENBQUM7b0JBQ25FLFVBQVUsRUFBRSxTQUFTO29CQUNyQixhQUFhLEVBQUUsK0JBQStCO29CQUM5QyxXQUFX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QyxrREFBa0QsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNoRSxNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUEsbUJBQU8sRUFBQyxhQUFHLENBQUM7aUJBQ2hDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUVuQixvQ0FBb0M7WUFDcEMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUN0QyxDQUFDLENBQUMsQ0FBQztJQUVMLENBQUMsQ0FBQyxDQUFDO0FBRUwsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvbWFuby9wcm9qZXRvcy9kYXRhc3VsL2xvcjAxMzgvdGVzdHMvZTJlL2FwaS9pbmZvcm1hY29lc0dlcmFpcy5lMmUudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0ZXN0cy9lMmUvYXBpL2luZm9ybWFjb2VzR2VyYWlzLmUyZS50ZXN0LnRzXG5cbmltcG9ydCByZXF1ZXN0IGZyb20gJ3N1cGVydGVzdCc7XG5pbXBvcnQgYXBwIGZyb20gJy4uLy4uLy4uL3NyYy9hcHAnOyAvLyBFeHByZXNzIGFwcFxuaW1wb3J0IHsgRGF0YWJhc2VNYW5hZ2VyIH0gZnJvbSAnQGluZnJhc3RydWN0dXJlL2RhdGFiYXNlL0RhdGFiYXNlTWFuYWdlcic7XG5pbXBvcnQgeyBjcmVhdGVJbmZvcm1hY29lc0dlcmFpcyB9IGZyb20gJy4uLy4uL2ZhY3Rvcmllcy9pdGVtLmZhY3RvcnknO1xuXG4vLyBNb2NrIGRvIERhdGFiYXNlTWFuYWdlciBwYXJhIEUyRVxuamVzdC5tb2NrKCdAaW5mcmFzdHJ1Y3R1cmUvZGF0YWJhc2UvRGF0YWJhc2VNYW5hZ2VyJyk7XG5cbmRlc2NyaWJlKCdFMkUgLSBBUEkgSW5mb3JtYWNvZXNHZXJhaXMnLCAoKSA9PiB7XG4gIFxuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICAgIC8vIEluaWNpYWxpemFyIERhdGFiYXNlTWFuYWdlciBzZSBuZWNlc3PDoXJpb1xuICAgIChEYXRhYmFzZU1hbmFnZXIuaW5pdGlhbGl6ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG4gICAgKERhdGFiYXNlTWFuYWdlci5pc1JlYWR5IGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKHRydWUpO1xuICB9KTtcblxuICBhZnRlckFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ2xlYW51cFxuICAgIGF3YWl0IERhdGFiYXNlTWFuYWdlci5jbG9zZSgpO1xuICB9KTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBDQVNPUyBERSBTVUNFU1NPXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ0dFVCAvYXBpL2xvcjAxMzgvaXRlbS9kYWRvc0NhZGFzdHJhaXMvaW5mb3JtYWNvZXNHZXJhaXMvOml0ZW1Db2RpZ28nLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgMjAwIGNvbSBkYWRvcyBkbyBpdGVtJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0RhdGEgPSBjcmVhdGVJbmZvcm1hY29lc0dlcmFpcygpO1xuICAgICAgXG4gICAgICAvLyBNb2NrIGRvIERhdGFiYXNlTWFuYWdlciByZXRvcm5hbmRvIGRhZG9zXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFt7XG4gICAgICAgIGl0ZW1Db2RpZ286ICc3NTMwMTEwJyxcbiAgICAgICAgaXRlbURlc2NyaWNhbzogJ1ZBTFZVTEEgREUgRVNGRVJBIDEvMlwiIEJST05aRScsXG4gICAgICAgIGl0ZW1VbmlkYWRlOiAnVU4nXG4gICAgICB9XSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy83NTMwMTEwJylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3N1Y2Nlc3MnLCB0cnVlKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnZGF0YScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgaGVhZGVycyBjb3JyZXRvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW3tcbiAgICAgICAgaXRlbUNvZGlnbzogJzc1MzAxMTAnLFxuICAgICAgICBpdGVtRGVzY3JpY2FvOiAnVGVzdCcsXG4gICAgICAgIGl0ZW1VbmlkYWRlOiAnVU4nXG4gICAgICB9XSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy83NTMwMTEwJyk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSkudG9NYXRjaCgvYXBwbGljYXRpb25cXC9qc29uLyk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuaGVhZGVyc1sneC1jb3JyZWxhdGlvbi1pZCddKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgYWNlaXRhciBDb3JyZWxhdGlvbiBJRCBjdXN0b21pemFkbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGN1c3RvbUNvcnJlbGF0aW9uSWQgPSAndGVzdC1jb3JyZWxhdGlvbi0xMjMnO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFt7XG4gICAgICAgIGl0ZW1Db2RpZ286ICc3NTMwMTEwJyxcbiAgICAgICAgaXRlbURlc2NyaWNhbzogJ1Rlc3QnLFxuICAgICAgICBpdGVtVW5pZGFkZTogJ1VOJ1xuICAgICAgfV0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2xvcjAxMzgvaXRlbS9kYWRvc0NhZGFzdHJhaXMvaW5mb3JtYWNvZXNHZXJhaXMvNzUzMDExMCcpXG4gICAgICAgIC5zZXQoJ1gtQ29ycmVsYXRpb24tSUQnLCBjdXN0b21Db3JyZWxhdGlvbklkKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmhlYWRlcnNbJ3gtY29ycmVsYXRpb24taWQnXSkudG9CZShjdXN0b21Db3JyZWxhdGlvbklkKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFZBTElEQcOHw4NPIERFIEVOVFJBREFcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBkZXNjcmliZSgnVmFsaWRhw6fDo28gZGUgUGFyw6JtZXRyb3MnLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgNDAwIHBhcmEgaXRlbUNvZGlnbyBpbnbDoWxpZG8gKG11aXRvIGxvbmdvKScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8xMjM0NTY3ODkwMTIzNDU2NycpXG4gICAgICAgIC5leHBlY3QoNDAwKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdlcnJvcicpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvTWF0Y2goL1ZhbGlkYXRpb25FcnJvci8pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgcmV0b3JuYXIgNDAwIHBhcmEgaXRlbUNvZGlnbyB2YXppbycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8gJylcbiAgICAgICAgLmV4cGVjdCg0MDQpOyAvLyBFeHByZXNzIHRyYXRhICcgJyBjb21vIHJvdGEgbsOjbyBlbmNvbnRyYWRhXG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnZXJyb3InKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIElURU0gTsODTyBFTkNPTlRSQURPXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ0l0ZW0gTsOjbyBFbmNvbnRyYWRvJywgKCkgPT4ge1xuICAgIFxuICAgIGl0KCdkZXZlIHJldG9ybmFyIDQwNCBxdWFuZG8gaXRlbSBuw6NvIGV4aXN0ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgcmV0b3JuYW5kbyB2YXppb1xuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy9JTkVYSVNURU5URScpXG4gICAgICAgIC5leHBlY3QoNDA0KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdlcnJvcicpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkubWVzc2FnZSkudG9NYXRjaCgvbsOjbyBlbmNvbnRyYWRvL2kpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgaW5jbHVpciBDb3JyZWxhdGlvbiBJRCBubyBlcnJvIDQwNCcsIGFzeW5jICgpID0+IHtcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2xvcjAxMzgvaXRlbS9kYWRvc0NhZGFzdHJhaXMvaW5mb3JtYWNvZXNHZXJhaXMvSU5FWElTVEVOVEUnKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmhlYWRlcnNbJ3gtY29ycmVsYXRpb24taWQnXSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIEVSUk9TIERPIFNFUlZJRE9SXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ0Vycm9zIGRvIFNlcnZpZG9yJywgKCkgPT4ge1xuICAgIFxuICAgIGl0KCdkZXZlIHJldG9ybmFyIDUwMCBlbSBjYXNvIGRlIGVycm8gbm8gYmFuY28nLCBhc3luYyAoKSA9PiB7XG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKFxuICAgICAgICBuZXcgRXJyb3IoJ0NvbmV4w6NvIHBlcmRpZGEnKVxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9sb3IwMTM4L2l0ZW0vZGFkb3NDYWRhc3RyYWlzL2luZm9ybWFjb2VzR2VyYWlzLzc1MzAxMTAnKVxuICAgICAgICAuZXhwZWN0KDUwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnZXJyb3InKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIE1JRERMRVdBUkVTXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ01pZGRsZXdhcmVzJywgKCkgPT4ge1xuICAgIFxuICAgIGl0KCdkZXZlIGFwbGljYXIgQ09SUyBoZWFkZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbe1xuICAgICAgICBpdGVtQ29kaWdvOiAnNzUzMDExMCcsXG4gICAgICAgIGl0ZW1EZXNjcmljYW86ICdUZXN0JyxcbiAgICAgICAgaXRlbVVuaWRhZGU6ICdVTidcbiAgICAgIH1dKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9sb3IwMTM4L2l0ZW0vZGFkb3NDYWRhc3RyYWlzL2luZm9ybWFjb2VzR2VyYWlzLzc1MzAxMTAnKVxuICAgICAgICAuc2V0KCdPcmlnaW4nLCAnaHR0cDovL2xvY2FsaG9zdDozMDAwJyk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5oZWFkZXJzWydhY2Nlc3MtY29udHJvbC1hbGxvdy1vcmlnaW4nXSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGNvbXByaW1pciByZXNwb3N0YSAoZ3ppcCknLCBhc3luYyAoKSA9PiB7XG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFt7XG4gICAgICAgIGl0ZW1Db2RpZ286ICc3NTMwMTEwJyxcbiAgICAgICAgaXRlbURlc2NyaWNhbzogJ1Rlc3QnLFxuICAgICAgICBpdGVtVW5pZGFkZTogJ1VOJ1xuICAgICAgfV0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2xvcjAxMzgvaXRlbS9kYWRvc0NhZGFzdHJhaXMvaW5mb3JtYWNvZXNHZXJhaXMvNzUzMDExMCcpXG4gICAgICAgIC5zZXQoJ0FjY2VwdC1FbmNvZGluZycsICdnemlwJyk7XG5cbiAgICAgIC8vIENvbXByZXNzaW9uIG1pZGRsZXdhcmUgcG9kZSBhZGljaW9uYXIgdmFyeSBoZWFkZXJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5oZWFkZXJzKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gQ0FDSEUgKHNlIGltcGxlbWVudGFkbylcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBkZXNjcmliZSgnQ2FjaGUgSFRUUCcsICgpID0+IHtcbiAgICBcbiAgICBpdCgnZGV2ZSByZXRvcm5hciBDYWNoZS1Db250cm9sIGhlYWRlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW3tcbiAgICAgICAgaXRlbUNvZGlnbzogJzc1MzAxMTAnLFxuICAgICAgICBpdGVtRGVzY3JpY2FvOiAnVGVzdCcsXG4gICAgICAgIGl0ZW1VbmlkYWRlOiAnVU4nXG4gICAgICB9XSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy83NTMwMTEwJyk7XG5cbiAgICAgIC8vIFNlIGNhY2hlIG1pZGRsZXdhcmUgZXN0aXZlciBhdGl2b1xuICAgICAgaWYgKHJlc3BvbnNlLmhlYWRlcnNbJ2NhY2hlLWNvbnRyb2wnXSkge1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuaGVhZGVyc1snY2FjaGUtY29udHJvbCddKS50b0JlRGVmaW5lZCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gQVVURU5USUNBw4fDg08gKEFQSSBLZXkgb3BjaW9uYWwpXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ0FQSSBLZXkgKE9wY2lvbmFsKScsICgpID0+IHtcbiAgICBcbiAgICBpdCgnZGV2ZSBhY2VpdGFyIHJlcXVpc2nDp8OjbyBzZW0gQVBJIEtleScsIGFzeW5jICgpID0+IHtcbiAgICAgIChEYXRhYmFzZU1hbmFnZXIucXVlcnlFbXBXaXRoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoW3tcbiAgICAgICAgaXRlbUNvZGlnbzogJzc1MzAxMTAnLFxuICAgICAgICBpdGVtRGVzY3JpY2FvOiAnVGVzdCcsXG4gICAgICAgIGl0ZW1VbmlkYWRlOiAnVU4nXG4gICAgICB9XSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy83NTMwMTEwJylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldmUgYWNlaXRhciBBUEkgS2V5IHbDoWxpZGEgc2UgZm9ybmVjaWRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbe1xuICAgICAgICBpdGVtQ29kaWdvOiAnNzUzMDExMCcsXG4gICAgICAgIGl0ZW1EZXNjcmljYW86ICdUZXN0JyxcbiAgICAgICAgaXRlbVVuaWRhZGU6ICdVTidcbiAgICAgIH1dKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9sb3IwMTM4L2l0ZW0vZGFkb3NDYWRhc3RyYWlzL2luZm9ybWFjb2VzR2VyYWlzLzc1MzAxMTAnKVxuICAgICAgICAuc2V0KCdYLUFQSS1LZXknLCAnZnJlZS1kZW1vLWtleS0xMjM0NTYnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBQRVJGT1JNQU5DRVxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdQZXJmb3JtYW5jZScsICgpID0+IHtcbiAgICBcbiAgICBpdCgnZGV2ZSByZXNwb25kZXIgZW0gbWVub3MgZGUgMSBzZWd1bmRvJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKERhdGFiYXNlTWFuYWdlci5xdWVyeUVtcFdpdGhQYXJhbXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShbe1xuICAgICAgICBpdGVtQ29kaWdvOiAnNzUzMDExMCcsXG4gICAgICAgIGl0ZW1EZXNjcmljYW86ICdUZXN0JyxcbiAgICAgICAgaXRlbVVuaWRhZGU6ICdVTidcbiAgICAgIH1dKTtcblxuICAgICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgICAgXG4gICAgICBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2FwaS9sb3IwMTM4L2l0ZW0vZGFkb3NDYWRhc3RyYWlzL2luZm9ybWFjb2VzR2VyYWlzLzc1MzAxMTAnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0O1xuICAgICAgZXhwZWN0KGR1cmF0aW9uKS50b0JlTGVzc1RoYW4oMTAwMCk7XG4gICAgfSk7XG5cbiAgfSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBFREdFIENBU0VTXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZGVzY3JpYmUoJ0VkZ2UgQ2FzZXMnLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ2RldmUgYWNlaXRhciBjw7NkaWdvIGFsZmFudW3DqXJpY28nLCBhc3luYyAoKSA9PiB7XG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFt7XG4gICAgICAgIGl0ZW1Db2RpZ286ICdBQkMxMjMnLFxuICAgICAgICBpdGVtRGVzY3JpY2FvOiAnVGVzdCcsXG4gICAgICAgIGl0ZW1VbmlkYWRlOiAnVU4nXG4gICAgICB9XSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy9BQkMxMjMnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2ZSBhY2VpdGFyIGPDs2RpZ28gZGUgMSBjYXJhY3RlcmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFt7XG4gICAgICAgIGl0ZW1Db2RpZ286ICdBJyxcbiAgICAgICAgaXRlbURlc2NyaWNhbzogJ1Rlc3QnLFxuICAgICAgICBpdGVtVW5pZGFkZTogJ1VOJ1xuICAgICAgfV0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL2xvcjAxMzgvaXRlbS9kYWRvc0NhZGFzdHJhaXMvaW5mb3JtYWNvZXNHZXJhaXMvQScpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZlIGFjZWl0YXIgY8OzZGlnbyBkZSAxNiBjYXJhY3RlcmVzIChtw6F4aW1vKScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvZGlnbzE2ID0gJzEyMzQ1Njc4OTAxMjM0NTYnO1xuICAgICAgXG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLnF1ZXJ5RW1wV2l0aFBhcmFtcyBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFt7XG4gICAgICAgIGl0ZW1Db2RpZ286IGNvZGlnbzE2LFxuICAgICAgICBpdGVtRGVzY3JpY2FvOiAnVGVzdCcsXG4gICAgICAgIGl0ZW1VbmlkYWRlOiAnVU4nXG4gICAgICB9XSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoYC9hcGkvbG9yMDEzOC9pdGVtL2RhZG9zQ2FkYXN0cmFpcy9pbmZvcm1hY29lc0dlcmFpcy8ke2NvZGlnbzE2fWApXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICB9KTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFJPVEFTIEVTUEVDSUFJU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGRlc2NyaWJlKCdSb3RhcyBkbyBTaXN0ZW1hJywgKCkgPT4ge1xuICAgIFxuICAgIGl0KCdHRVQgLyAtIGRldmUgcmV0b3JuYXIgaW5mb3JtYcOnw7VlcyBkYSBBUEknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvJylcbiAgICAgICAgLmV4cGVjdCgyMDApO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ21lc3NhZ2UnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgndmVyc2lvbicpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdkb2N1bWVudGF0aW9uJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnR0VUIC9oZWFsdGggLSBkZXZlIHJldG9ybmFyIHN0YXR1cyBkZSBzYcO6ZGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoRGF0YWJhc2VNYW5hZ2VyLmdldENvbm5lY3Rpb24gYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBxdWVyeTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFt7IHRlc3Q6IDEgfV0pXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL2hlYWx0aCcpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdzdGF0dXMnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnZGF0YWJhc2UnKTtcbiAgICB9KTtcblxuICAgIGl0KCdHRVQgL21ldHJpY3MgLSBkZXZlIHJldG9ybmFyIG3DqXRyaWNhcyBQcm9tZXRoZXVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcClcbiAgICAgICAgLmdldCgnL21ldHJpY3MnKTtcblxuICAgICAgLy8gTcOpdHJpY2FzIHJldG9ybmFtIHRleHRvLCBuw6NvIEpTT05cbiAgICAgIGV4cGVjdChyZXNwb25zZS50ZXh0KS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gIH0pO1xuXG59KTsiXSwidmVyc2lvbiI6M30=